<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Word to PDF Converter — Exact Layout, Powered by LibreOffice</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg:       #f0f2f5;
    --card:     #ffffff;
    --border:   #e2e6ea;
    --primary:  #2563eb;
    --primary-h:#1d4ed8;
    --success:  #16a34a;
    --danger:   #dc2626;
    --text:     #111827;
    --muted:    #6b7280;
    --radius:   14px;
    --shadow:   0 2px 16px rgba(0,0,0,.08);
    --shadow-lg:0 8px 40px rgba(0,0,0,.13);
  }

  body {
    font-family: 'Inter', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 48px 20px 80px;
  }

  /* ── Header ── */
  .header { text-align: center; margin-bottom: 40px; }
  .header .logo {
    display: inline-flex; align-items: center; gap: 10px;
    font-size: 1.1rem; font-weight: 700; color: var(--primary);
    text-decoration: none; margin-bottom: 20px;
    letter-spacing: -.3px;
  }
  .header .logo i { font-size: 1.4rem; }
  .header h1 {
    font-size: clamp(1.8rem, 4vw, 2.6rem);
    font-weight: 700; letter-spacing: -.6px;
    color: var(--text); margin-bottom: 10px;
  }
  .header p { color: var(--muted); font-size: 1.05rem; max-width: 520px; margin: 0 auto; }

  /* ── Badges ── */
  .badges { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-top: 16px; }
  .badge {
    display: inline-flex; align-items: center; gap: 5px;
    background: #eff6ff; color: #1d4ed8;
    font-size: 12px; font-weight: 600; padding: 4px 12px;
    border-radius: 99px; border: 1px solid #bfdbfe;
  }
  .badge.green { background: #f0fdf4; color: #166534; border-color: #bbf7d0; }
  .badge.orange { background: #fff7ed; color: #9a3412; border-color: #fed7aa; }

  /* ── Card ── */
  .card {
    background: var(--card);
    border-radius: var(--radius);
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--border);
    width: 100%; max-width: 680px;
    overflow: hidden;
  }

  .card-body { padding: 40px; }

  /* ── Upload zone ── */
  .drop-zone {
    border: 2.5px dashed #93c5fd;
    border-radius: 10px;
    padding: 52px 32px;
    text-align: center;
    background: #f8faff;
    cursor: pointer;
    transition: all .2s;
    position: relative;
  }
  .drop-zone:hover, .drop-zone.over {
    border-color: var(--primary);
    background: #eff6ff;
  }
  .drop-zone input[type=file] {
    position: absolute; inset: 0; opacity: 0; cursor: pointer;
  }
  .dz-icon {
    width: 68px; height: 68px;
    background: linear-gradient(135deg, #2563eb, #7c3aed);
    border-radius: 18px; display: flex; align-items: center;
    justify-content: center; margin: 0 auto 18px;
    font-size: 28px; color: white;
    box-shadow: 0 4px 16px rgba(37,99,235,.35);
  }
  .dz-title { font-size: 1.15rem; font-weight: 600; color: var(--text); margin-bottom: 6px; }
  .dz-sub   { font-size: .9rem; color: var(--muted); }
  .dz-btn {
    display: inline-flex; align-items: center; gap: 7px;
    background: var(--primary); color: white;
    padding: 10px 22px; border-radius: 8px;
    font-size: .92rem; font-weight: 600;
    margin-top: 18px; border: none; cursor: pointer;
    transition: background .2s;
  }
  .dz-btn:hover { background: var(--primary-h); }

  /* ── File chip ── */
  .file-chip {
    display: none;
    align-items: center; gap: 14px;
    background: #f0fdf4; border: 1px solid #86efac;
    border-radius: 10px; padding: 14px 18px;
    margin-top: 20px;
  }
  .file-chip.show { display: flex; }
  .chip-icon {
    width: 42px; height: 42px; background: #16a34a;
    border-radius: 10px; display: flex; align-items: center;
    justify-content: center; color: white; font-size: 18px; flex-shrink: 0;
  }
  .chip-meta { flex: 1; min-width: 0; }
  .chip-name { font-weight: 600; font-size: .95rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .chip-size { font-size: .8rem; color: var(--muted); margin-top: 2px; }
  .chip-remove {
    background: none; border: none; color: var(--muted);
    cursor: pointer; font-size: 16px; padding: 4px; flex-shrink: 0;
    border-radius: 6px; transition: color .2s, background .2s;
  }
  .chip-remove:hover { color: var(--danger); background: #fee2e2; }

  /* ── Convert button ── */
  .convert-wrap { margin-top: 24px; }
  .btn-convert {
    width: 100%; padding: 15px;
    background: linear-gradient(135deg, #2563eb, #7c3aed);
    color: white; font-size: 1.05rem; font-weight: 700;
    border: none; border-radius: 10px; cursor: pointer;
    display: flex; align-items: center; justify-content: center; gap: 9px;
    transition: opacity .2s, transform .15s;
    box-shadow: 0 4px 18px rgba(37,99,235,.3);
    letter-spacing: .01em;
  }
  .btn-convert:hover:not(:disabled) { opacity: .93; transform: translateY(-1px); }
  .btn-convert:disabled { opacity: .6; cursor: not-allowed; transform: none; }

  /* ── Progress ── */
  .progress-wrap {
    display: none; margin-top: 28px;
    background: #f9fafb; border: 1px solid var(--border);
    border-radius: 10px; padding: 20px 22px;
  }
  .progress-wrap.show { display: block; }
  .progress-label {
    display: flex; justify-content: space-between;
    font-size: .85rem; font-weight: 500; color: var(--text);
    margin-bottom: 10px;
  }
  .progress-bar {
    height: 8px; background: #e5e7eb;
    border-radius: 99px; overflow: hidden;
  }
  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #2563eb, #7c3aed);
    border-radius: 99px;
    width: 0%;
    transition: width .35s ease;
  }
  .progress-status { font-size: .82rem; color: var(--muted); margin-top: 8px; }

  /* ── Success panel ── */
  .success-panel {
    display: none; margin-top: 28px;
    background: #f0fdf4; border: 1px solid #86efac;
    border-radius: 10px; padding: 24px;
    text-align: center;
  }
  .success-panel.show { display: block; }
  .success-icon {
    width: 60px; height: 60px; background: var(--success);
    border-radius: 50%; display: flex; align-items: center;
    justify-content: center; margin: 0 auto 14px;
    font-size: 26px; color: white;
    animation: pop .4s cubic-bezier(.34,1.56,.64,1);
  }
  @keyframes pop { from{transform:scale(0)} to{transform:scale(1)} }
  .success-title { font-size: 1.15rem; font-weight: 700; color: #14532d; margin-bottom: 4px; }
  .success-sub   { font-size: .9rem; color: #166534; margin-bottom: 20px; }
  .btn-download {
    display: inline-flex; align-items: center; gap: 8px;
    background: var(--success); color: white;
    padding: 12px 28px; border-radius: 9px;
    font-weight: 700; font-size: .97rem;
    border: none; cursor: pointer; transition: opacity .2s;
    box-shadow: 0 4px 14px rgba(22,163,74,.3);
  }
  .btn-download:hover { opacity: .9; }
  .btn-again {
    display: block; margin: 12px auto 0; background: none; border: none;
    color: var(--primary); font-size: .88rem; font-weight: 600;
    cursor: pointer; text-decoration: underline;
  }

  /* ── Error ── */
  .error-box {
    display: none; margin-top: 20px;
    background: #fef2f2; border: 1px solid #fca5a5;
    border-radius: 10px; padding: 14px 18px;
    color: var(--danger); font-size: .9rem; font-weight: 500;
  }
  .error-box.show { display: block; }
  .error-box i { margin-right: 6px; }

  /* ── Info strip ── */
  .info-strip {
    display: flex; gap: 6px; flex-wrap: wrap; margin-top: 22px; justify-content: center;
  }
  .info-item {
    display: flex; align-items: center; gap: 5px;
    font-size: .8rem; color: var(--muted); font-weight: 500;
  }
  .info-item i { color: #9ca3af; font-size: .75rem; }

  /* ── How it works ── */
  .how-card {
    background: var(--card);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    border: 1px solid var(--border);
    width: 100%; max-width: 680px;
    padding: 32px 40px;
    margin-top: 24px;
  }
  .how-title { font-size: 1rem; font-weight: 700; color: var(--text); margin-bottom: 20px; }
  .steps { display: flex; gap: 20px; flex-wrap: wrap; }
  .step { flex: 1; min-width: 140px; display: flex; align-items: flex-start; gap: 12px; }
  .step-num {
    width: 34px; height: 34px; flex-shrink: 0;
    background: linear-gradient(135deg, #2563eb, #7c3aed);
    color: white; border-radius: 9px;
    display: flex; align-items: center; justify-content: center;
    font-weight: 800; font-size: .9rem;
  }
  .step-text h4 { font-size: .88rem; font-weight: 700; margin-bottom: 3px; }
  .step-text p  { font-size: .8rem; color: var(--muted); line-height: 1.5; }

  /* ── Footer ── */
  .footer {
    margin-top: 40px; text-align: center;
    font-size: .8rem; color: #9ca3af;
  }
  .footer a { color: #9ca3af; text-decoration: none; }

  /* ── Responsive ── */
  @media (max-width: 500px) {
    .card-body, .how-card { padding: 28px 22px; }
    .drop-zone { padding: 36px 20px; }
    body { padding: 28px 14px 60px; }
  }

  /* Loading dots animation */
  .dots::after {
    content: '';
    animation: dots 1.4s steps(4, end) infinite;
  }
  @keyframes dots {
    0%  { content: ''; }
    25% { content: '.'; }
    50% { content: '..'; }
    75% { content: '...'; }
  }
</style>
</head>
<body>

<!-- Header -->
<div class="header">
  <a href="#" class="logo"><i class="fas fa-bolt"></i> Free Tools Hub</a>
  <h1>Word to PDF Converter</h1>
  <p>Professional-grade conversion using LibreOffice. Exact fonts, layout, images, and page breaks — every time.</p>
  <div class="badges">
    <span class="badge green"><i class="fas fa-check-circle"></i> LibreOffice Engine</span>
    <span class="badge"><i class="fas fa-shield-alt"></i> No Upload to Cloud</span>
    <span class="badge orange"><i class="fas fa-bolt"></i> Instant Conversion</span>
  </div>
</div>

<!-- Main Card -->
<div class="card">
  <div class="card-body">

    <!-- Drop Zone -->
    <div class="drop-zone" id="dropZone">
      <input type="file" id="fileInput" accept=".docx,.doc">
      <div class="dz-icon"><i class="fas fa-file-word"></i></div>
      <div class="dz-title">Drop your Word document here</div>
      <div class="dz-sub">Supports .DOCX and .DOC files — up to 100 MB</div>
      <button class="dz-btn" type="button" onclick="document.getElementById('fileInput').click()">
        <i class="fas fa-folder-open"></i> Browse File
      </button>
    </div>

    <!-- File chip -->
    <div class="file-chip" id="fileChip">
      <div class="chip-icon"><i class="fas fa-file-word"></i></div>
      <div class="chip-meta">
        <div class="chip-name" id="chipName">—</div>
        <div class="chip-size" id="chipSize">—</div>
      </div>
      <button class="chip-remove" id="chipRemove" title="Remove file"><i class="fas fa-times"></i></button>
    </div>

    <!-- Convert button -->
    <div class="convert-wrap" id="convertWrap" style="display:none">
      <button class="btn-convert" id="convertBtn">
        <i class="fas fa-file-pdf"></i>
        Convert to PDF — Exact Layout
      </button>
    </div>

    <!-- Error -->
    <div class="error-box" id="errorBox"></div>

    <!-- Progress -->
    <div class="progress-wrap" id="progressWrap">
      <div class="progress-label">
        <span id="progressLabel">Converting<span class="dots"></span></span>
        <span id="progressPct">0%</span>
      </div>
      <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
      <div class="progress-status" id="progressStatus">Sending file to LibreOffice engine…</div>
    </div>

    <!-- Success -->
    <div class="success-panel" id="successPanel">
      <div class="success-icon"><i class="fas fa-check"></i></div>
      <div class="success-title">Conversion Complete!</div>
      <div class="success-sub" id="successSub">Your PDF is ready</div>
      <button class="btn-download" id="downloadBtn">
        <i class="fas fa-download"></i> Download PDF
      </button>
      <button class="btn-again" id="btnAgain">Convert another file</button>
    </div>

    <!-- Info strip -->
    <div class="info-strip">
      <div class="info-item"><i class="fas fa-lock"></i> Processed locally on your server</div>
      <div class="info-item"><i class="fas fa-infinity"></i> No file size limit restrictions</div>
      <div class="info-item"><i class="fas fa-language"></i> Urdu, Arabic & all languages</div>
    </div>

  </div><!-- /card-body -->
</div><!-- /card -->

<!-- How it works -->
<div class="how-card">
  <div class="how-title"><i class="fas fa-info-circle" style="color:var(--primary);margin-right:7px"></i>How It Works</div>
  <div class="steps">
    <div class="step">
      <div class="step-num">1</div>
      <div class="step-text"><h4>Upload</h4><p>Select or drop your .DOCX or .DOC file</p></div>
    </div>
    <div class="step">
      <div class="step-num">2</div>
      <div class="step-text"><h4>LibreOffice converts</h4><p>The same engine Microsoft Word is based on — pixel-perfect output</p></div>
    </div>
    <div class="step">
      <div class="step-num">3</div>
      <div class="step-text"><h4>Download</h4><p>Get your PDF instantly with all layout preserved</p></div>
    </div>
  </div>
</div>

<div class="footer">
  &copy; 2026 <a href="#">Free Tools Hub</a> &nbsp;·&nbsp; Powered by LibreOffice
</div>

<script>
const dropZone    = document.getElementById('dropZone');
const fileInput   = document.getElementById('fileInput');
const fileChip    = document.getElementById('fileChip');
const chipName    = document.getElementById('chipName');
const chipSize    = document.getElementById('chipSize');
const chipRemove  = document.getElementById('chipRemove');
const convertWrap = document.getElementById('convertWrap');
const convertBtn  = document.getElementById('convertBtn');
const errorBox    = document.getElementById('errorBox');
const progressWrap= document.getElementById('progressWrap');
const progressFill= document.getElementById('progressFill');
const progressPct = document.getElementById('progressPct');
const progressStatus = document.getElementById('progressStatus');
const progressLabel  = document.getElementById('progressLabel');
const successPanel= document.getElementById('successPanel');
const successSub  = document.getElementById('successSub');
const downloadBtn = document.getElementById('downloadBtn');
const btnAgain    = document.getElementById('btnAgain');

let selectedFile = null;
let pdfBlob = null;

// ── Drag & drop ──────────────────────────────────────────────────────────────
dropZone.addEventListener('dragover',  e => { e.preventDefault(); dropZone.classList.add('over'); });
dropZone.addEventListener('dragleave', () => dropZone.classList.remove('over'));
dropZone.addEventListener('drop', e => {
  e.preventDefault(); dropZone.classList.remove('over');
  const f = e.dataTransfer.files[0];
  if (f) selectFile(f);
});
fileInput.addEventListener('change', e => { if (e.target.files[0]) selectFile(e.target.files[0]); });

function fmtSize(b) {
  if (b < 1024) return b + ' B';
  if (b < 1048576) return (b/1024).toFixed(1) + ' KB';
  return (b/1048576).toFixed(2) + ' MB';
}

function selectFile(f) {
  const ext = f.name.split('.').pop().toLowerCase();
  if (!['docx','doc'].includes(ext)) {
    showError('<i class="fas fa-exclamation-triangle"></i> Only .docx and .doc files are supported.');
    return;
  }
  selectedFile = f;
  chipName.textContent = f.name;
  chipSize.textContent = fmtSize(f.size);
  fileChip.classList.add('show');
  convertWrap.style.display = 'block';
  hideError();
  resetResults();
}

chipRemove.addEventListener('click', reset);

// ── Convert ──────────────────────────────────────────────────────────────────
convertBtn.addEventListener('click', async () => {
  if (!selectedFile) return;
  startProgress();

  const formData = new FormData();
  formData.append('file', selectedFile, selectedFile.name);

  try {
    setProgress(15, 'Uploading file…');
    await sleep(300);

    const xhr = new XMLHttpRequest();
    xhr.open('POST', '/convert', true);
    xhr.responseType = 'blob';

    // Upload progress
    xhr.upload.onprogress = e => {
      if (e.lengthComputable) {
        const pct = Math.round(e.loaded / e.total * 40);
        setProgress(pct, 'Uploading' + (pct < 40 ? '…' : ' complete'));
      }
    };

    xhr.onload = async () => {
      if (xhr.status === 200) {
        setProgress(75, 'LibreOffice converting…');
        await sleep(400);
        setProgress(95, 'Finalizing PDF…');
        await sleep(300);

        pdfBlob = xhr.response;
        const outName = selectedFile.name.replace(/\.(docx|doc)$/i, '') + '.pdf';
        const url = URL.createObjectURL(pdfBlob);

        setProgress(100, 'Done!');
        await sleep(250);

        showSuccess(outName, pdfBlob.size);
        downloadBtn.onclick = () => {
          const a = document.createElement('a');
          a.href = url; a.download = outName; a.click();
        };

      } else {
        // Try to read error
        const reader = new FileReader();
        reader.onload = () => {
          try {
            const j = JSON.parse(reader.result);
            showError('<i class="fas fa-times-circle"></i> ' + (j.error || 'Conversion failed'));
          } catch {
            showError('<i class="fas fa-times-circle"></i> Conversion failed (status ' + xhr.status + ')');
          }
          resetProgress();
        };
        reader.readAsText(xhr.response);
      }
    };

    xhr.onerror = () => {
      showError('<i class="fas fa-wifi" style="color:var(--danger)"></i> Cannot reach the conversion server. Make sure <code>server.py</code> is running.');
      resetProgress();
    };

    xhr.send(formData);

  } catch (err) {
    showError('<i class="fas fa-times-circle"></i> ' + err.message);
    resetProgress();
  }
});

// ── UI helpers ────────────────────────────────────────────────────────────────
function startProgress() {
  convertBtn.disabled = true;
  convertWrap.style.display = 'block';
  progressWrap.classList.add('show');
  successPanel.classList.remove('show');
  hideError();
  setProgress(5, 'Preparing…');
}

function setProgress(pct, msg) {
  progressFill.style.width = pct + '%';
  progressPct.textContent  = pct + '%';
  progressStatus.textContent = msg;
  if (pct >= 100) {
    progressLabel.innerHTML = 'Converting — Done!';
  }
}

function resetProgress() {
  convertBtn.disabled = false;
  progressWrap.classList.remove('show');
  progressFill.style.width = '0%';
  progressPct.textContent  = '0%';
  progressLabel.innerHTML  = 'Converting<span class="dots"></span>';
}

function showSuccess(name, size) {
  progressWrap.classList.remove('show');
  successPanel.classList.add('show');
  successSub.textContent = name + '  (' + fmtSize(size) + ')';
}

function showError(msg) {
  errorBox.innerHTML = msg;
  errorBox.classList.add('show');
}
function hideError() { errorBox.classList.remove('show'); }

function resetResults() {
  successPanel.classList.remove('show');
  progressWrap.classList.remove('show');
  hideError();
  convertBtn.disabled = false;
}

function reset() {
  selectedFile = null; pdfBlob = null;
  fileInput.value = '';
  fileChip.classList.remove('show');
  convertWrap.style.display = 'none';
  resetResults();
}

btnAgain.addEventListener('click', reset);
function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }
</script>
</body>
</html>
