<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5GGQGP06F0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-5GGQGP06F0');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word to PDF Converter - Free Tools Hub</title>
    <meta name="description" content="Convert Word documents to PDF. Free DOCX to PDF converter. Numbering and layout preserved.">
    <meta name="keywords" content="Word to PDF, DOCX to PDF, DOC to PDF, free PDF converter">
    <meta name="author" content="freetoolsapp">
    <link rel="canonical" href="https://freetoolshub.online/tools/utility/word-to-pdf-converter.html">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        * { font-family: 'Inter', sans-serif; box-sizing: border-box; }
        body { background: #fff; color: #333; }

        .btn-red {
            background:#e2574c; color:#fff; border:none; border-radius:6px;
            padding:12px 28px; font-size:15px; font-weight:600; cursor:pointer;
            transition:all .2s; display:inline-flex; align-items:center; gap:8px; text-decoration:none;
        }
        .btn-red:hover { background:#cc3f35; transform:translateY(-1px); box-shadow:0 4px 14px rgba(226,87,76,.35); }
        .btn-red:disabled { opacity:.55; cursor:not-allowed; transform:none; box-shadow:none; }

        .btn-green {
            background:linear-gradient(135deg,#27ae60,#1e8449); color:#fff; border:none;
            border-radius:8px; padding:15px 32px; font-size:16px; font-weight:700;
            cursor:pointer; display:inline-flex; align-items:center; gap:10px;
            transition:all .2s; width:100%; justify-content:center; box-shadow:0 4px 16px rgba(39,174,96,.3);
        }
        .btn-green:hover { transform:translateY(-2px); box-shadow:0 8px 24px rgba(39,174,96,.4); }

        .tool-hero {
            background:linear-gradient(135deg,#f8f3ff 0%,#fff5f4 100%);
            border-bottom:1px solid #ede8f5; padding:52px 20px 56px; text-align:center;
        }

        .upload-zone {
            border:2px dashed #d4b8f0; border-radius:14px; background:#fff;
            padding:52px 30px; cursor:pointer; transition:all .25s; position:relative;
        }
        .upload-zone:hover, .upload-zone.over { border-color:#e2574c; background:#fff8f7; }
        .upload-zone.over { transform:scale(1.01); }
        /* Full-area file input for mobile */
        #fileInput {
            position:absolute; inset:0; opacity:0; cursor:pointer;
            width:100%; height:100%; z-index:5; font-size:16px;
        }

        .file-item {
            background:#fff; border:1.5px solid #e8e8e8; border-radius:10px;
            padding:14px 18px; display:flex; align-items:center; gap:14px;
        }
        .file-thumb {
            width:44px; height:52px; background:linear-gradient(135deg,#e3f2fd,#bbdefb);
            border-radius:6px; display:flex; align-items:center; justify-content:center; flex-shrink:0;
        }

        @keyframes spin { to { transform:rotate(360deg); } }
        .spinner { border:3px solid #f0f0f0; border-top-color:#e2574c; border-radius:50%; animation:spin .8s linear infinite; }
        .prog-track { background:#ede8f5; border-radius:99px; overflow:hidden; }
        @keyframes progShimmer { to { background-position:-200% 0; } }
        .prog-fill {
            height:100%; background:linear-gradient(90deg,#e2574c,#c0392b,#e2574c);
            background-size:200% 100%; animation:progShimmer 1.4s linear infinite;
            border-radius:99px; transition:width .4s ease;
        }

        .result-box { background:#fff; border:1.5px solid #e8e8e8; border-radius:14px; overflow:hidden; }
        .result-header {
            background:#f7f7f7; border-bottom:1px solid #e8e8e8; padding:12px 18px;
            display:flex; align-items:center; justify-content:space-between;
        }

        #docxStage {
            background:#525659; padding:20px;
            min-height:120px; max-height:500px; overflow-y:auto;
        }

        .tool-card { border:1.5px solid #eee; border-radius:12px; transition:all .2s; background:#fff; text-decoration:none; display:block; }
        .tool-card:hover { border-color:#e2574c; box-shadow:0 6px 20px rgba(226,87,76,.14); transform:translateY(-3px); }

        @keyframes pop { 0%{transform:scale(0) rotate(-20deg)} 70%{transform:scale(1.12) rotate(4deg)} 100%{transform:scale(1) rotate(0)} }
        .pop-anim { animation:pop .4s cubic-bezier(.34,1.56,.64,1) forwards; }

        .page-size-btn { cursor:pointer; text-align:center; }
        .page-size-btn:hover { border-color:#e2574c !important; }

        ::-webkit-scrollbar { width:5px; }
        ::-webkit-scrollbar-thumb { background:#ddd; border-radius:3px; }
        ::-webkit-scrollbar-thumb:hover { background:#e2574c; }
    </style>
    <link rel="stylesheet" href="../../header-new.css">
    <!-- PWA -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#5b21b6">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Free Tools Hub">
    <link rel="apple-touch-icon" href="/icon-192.png">
</head>
<body>

<!-- HEADER -->
<div id="site-header"></div>
<script src="../../header.js"></script>

<!-- BREADCRUMB -->
<div class="bg-gray-50 border-b border-gray-100 text-xs py-2">
    <div class="max-w-screen-xl mx-auto px-5 flex items-center gap-2 text-gray-400">
        <a href="../../index.html" class="hover:text-red-500 transition">Home</a>
        <i class="fas fa-chevron-right text-gray-300"></i>
        <a href="../../index.html#tools" class="hover:text-red-500 transition">Tools</a>
        <i class="fas fa-chevron-right text-gray-300"></i>
        <span class="text-gray-600 font-medium">Word to PDF</span>
    </div>
</div>

<!-- HERO -->
<section class="tool-hero">
    <div class="max-w-2xl mx-auto">

        <div class="w-24 h-24 mx-auto mb-6 relative">
            <div class="w-24 h-24 bg-gradient-to-br from-blue-400 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg">
                <i class="fas fa-file-word text-white text-5xl"></i>
            </div>
            <div class="absolute -bottom-1 -right-1 w-9 h-9 bg-red-500 rounded-lg flex items-center justify-center shadow-md">
                <i class="fas fa-file-pdf text-white text-base"></i>
            </div>
        </div>

        <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-3">Convert WORD to PDF</h1>
        <p class="text-gray-500 text-lg mb-10 leading-relaxed">Make DOC and DOCX files easy to read by converting them to PDF.</p>

        <!-- STAGE: UPLOAD -->
        <div id="stageUpload">
            <div id="uploadZone" class="upload-zone mb-4">
                <input type="file" id="fileInput" accept=".docx,.doc,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document">
                <div class="pointer-events-none">
                    <i class="fas fa-cloud-upload-alt text-5xl text-purple-300 mb-4 block"></i>
                    <p class="text-gray-500 text-base mb-5">Upload your file and transform it.</p>
                    <div class="btn-red mx-auto w-max text-sm" style="pointer-events:none">
                        <i class="fas fa-folder-open"></i>Select WORD files
                    </div>
                    <p class="text-gray-400 text-xs mt-5">or drop WORD documents here</p>
                </div>
            </div>
            <div id="errBox" class="hidden bg-red-50 border border-red-200 rounded-lg p-3 text-red-600 text-sm flex items-center gap-2 text-left">
                <i class="fas fa-exclamation-circle flex-shrink-0"></i>
                <span id="errMsg"></span>
            </div>
        </div>

        <!-- STAGE: PROCESSING -->
        <div id="stageProcess" class="hidden">
            <div class="bg-white border border-gray-200 rounded-2xl p-10 shadow-sm">
                <div class="spinner w-14 h-14 mx-auto mb-6"></div>
                <h3 id="procTitle" class="text-lg font-bold text-gray-800 mb-1">Converting your document…</h3>
                <p id="procSub" class="text-gray-400 text-sm mb-6">Please wait a moment</p>
                <div class="prog-track h-2.5 mb-2">
                    <div id="progFill" class="prog-fill" style="width:5%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-400">
                    <span id="progStatus">Reading file…</span>
                    <span id="progPct">5%</span>
                </div>
            </div>
        </div>

        <!-- STAGE: PREVIEW -->
        <div id="stagePreview" class="hidden">
            <div class="file-item mb-5 text-left">
                <div class="file-thumb"><i class="fas fa-file-word text-blue-500 text-2xl"></i></div>
                <div class="flex-1 min-w-0">
                    <div id="fName" class="font-semibold text-gray-800 text-sm truncate"></div>
                    <div id="fSize" class="text-gray-400 text-xs mt-0.5"></div>
                </div>
                <button id="removeBtn" class="w-8 h-8 rounded-full hover:bg-red-50 text-gray-300 hover:text-red-400 transition flex items-center justify-center">
                    <i class="fas fa-times text-sm"></i>
                </button>
            </div>

            <div class="result-box mb-6 text-left">
                <div class="result-header">
                    <span class="text-sm font-semibold text-gray-700 flex items-center gap-2">
                        <i class="fas fa-eye text-purple-400"></i>Preview
                    </span>
                    <span id="prevBadge" class="text-xs font-bold bg-green-100 text-green-700 px-2.5 py-1 rounded-full">✓ Numbering Preserved</span>
                </div>
                <div id="docxStage"></div>
            </div>

            <!-- PAGE SIZE SELECTOR -->
            <div class="bg-gray-50 border border-gray-200 rounded-xl p-4 mb-4 text-left">
                <label class="text-sm font-semibold text-gray-700 flex items-center gap-2 mb-3">
                    <i class="fas fa-file-alt text-red-400"></i>Output Page Size
                    <span id="autoDetectBadge" class="text-xs font-normal bg-blue-100 text-blue-600 px-2 py-0.5 rounded-full ml-1">Auto-detected</span>
                </label>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-2" id="pageSizeBtns">
                    <button onclick="selectPageSize('auto')" id="btn-auto"
                        class="page-size-btn text-xs py-2.5 px-3 rounded-lg border-2 border-red-400 bg-red-50 text-red-600 font-semibold transition">
                        <i class="fas fa-magic block text-base mb-1"></i>Auto Detect
                    </button>
                    <button onclick="selectPageSize('a4')" id="btn-a4"
                        class="page-size-btn text-xs py-2.5 px-3 rounded-lg border-2 border-gray-200 bg-white text-gray-600 font-semibold transition hover:border-red-300">
                        <i class="fas fa-file block text-base mb-1"></i>A4<br><span class="font-normal text-gray-400">210×297mm</span>
                    </button>
                    <button onclick="selectPageSize('letter')" id="btn-letter"
                        class="page-size-btn text-xs py-2.5 px-3 rounded-lg border-2 border-gray-200 bg-white text-gray-600 font-semibold transition hover:border-red-300">
                        <i class="fas fa-file block text-base mb-1"></i>Letter<br><span class="font-normal text-gray-400">216×279mm</span>
                    </button>
                    <button onclick="selectPageSize('legal')" id="btn-legal"
                        class="page-size-btn text-xs py-2.5 px-3 rounded-lg border-2 border-gray-200 bg-white text-gray-600 font-semibold transition hover:border-red-300">
                        <i class="fas fa-file block text-base mb-1"></i>Legal<br><span class="font-normal text-gray-400">216×356mm</span>
                    </button>
                </div>
                <p id="selectedSizeInfo" class="text-xs text-gray-400 mt-2">
                    <i class="fas fa-info-circle mr-1"></i>Using auto-detected size from your document
                </p>
            </div>

            <button id="convertBtn" class="btn-red w-full justify-center text-lg py-4 mb-3">
                <i class="fas fa-file-pdf text-xl"></i>Convert to PDF
            </button>
            <p class="text-gray-400 text-xs text-center mb-4">
                <i class="fas fa-lock mr-1"></i>Processed locally — your file never leaves your device
            </p>

            <div id="convProgress" class="hidden bg-gray-50 border border-gray-200 rounded-xl p-4 text-left">
                <div class="flex items-center gap-3 mb-3">
                    <div class="spinner w-6 h-6 flex-shrink-0" style="border-width:2.5px"></div>
                    <span id="convMsg" class="text-sm text-gray-700 font-medium">Generating PDF…</span>
                </div>
                <div class="prog-track h-2">
                    <div id="convFill" class="prog-fill" style="width:10%"></div>
                </div>
            </div>
        </div>

        <!-- STAGE: SUCCESS -->
        <div id="stageSuccess" class="hidden">
            <div class="bg-white border border-gray-200 rounded-2xl p-10 shadow-sm text-center">
                <div class="w-20 h-20 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-5 pop-anim">
                    <i class="fas fa-check text-white text-3xl"></i>
                </div>
                <h3 class="text-2xl font-extrabold text-gray-900 mb-2">Your PDF is ready!</h3>
                <p id="sucName" class="text-gray-400 text-sm mb-8"></p>
                <button id="dlBtn" class="btn-green mb-4">
                    <i class="fas fa-download text-xl"></i>Download PDF
                </button>
                <button onclick="resetAll()"
                    class="w-full border border-gray-200 text-gray-500 py-3 rounded-xl text-sm font-semibold hover:border-red-300 hover:text-red-500 transition flex items-center justify-center gap-2">
                    <i class="fas fa-redo text-xs"></i>Convert another WORD file
                </button>
            </div>
        </div>

    </div>
</section>

<!-- HOW IT WORKS -->
<section class="py-16 bg-white border-t border-gray-100">
    <div class="max-w-4xl mx-auto px-5">
        <h2 class="text-2xl font-bold text-gray-900 text-center mb-12">How to convert Word to PDF</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="text-center">
                <div class="w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-4 text-2xl font-black text-purple-600">1</div>
                <h3 class="font-bold text-gray-800 mb-2">Select WORD file</h3>
                <p class="text-gray-500 text-sm">Click or drag &amp; drop your .DOCX or .DOC file</p>
            </div>
            <div class="text-center">
                <div class="w-16 h-16 bg-red-100 rounded-2xl flex items-center justify-center mx-auto mb-4 text-2xl font-black text-red-500">2</div>
                <h3 class="font-bold text-gray-800 mb-2">Preview</h3>
                <p class="text-gray-500 text-sm">See your document with numbering and formatting preserved</p>
            </div>
            <div class="text-center">
                <div class="w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4 text-2xl font-black text-green-600">3</div>
                <h3 class="font-bold text-gray-800 mb-2">Download PDF</h3>
                <p class="text-gray-500 text-sm">Click Convert and your PDF downloads instantly</p>
            </div>
        </div>
    </div>
</section>

<!-- FEATURES -->
<section class="py-16 bg-gray-50 border-t border-gray-100">
    <div class="max-w-5xl mx-auto px-5">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5">
            <div class="tool-card p-6 text-center">
                <div class="w-12 h-12 bg-green-50 rounded-xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-shield-alt text-2xl text-green-500"></i>
                </div>
                <h4 class="font-bold text-gray-800 mb-2 text-sm">100% Secure</h4>
                <p class="text-xs text-gray-500">Files processed locally. Never uploaded to any server.</p>
            </div>
            <div class="tool-card p-6 text-center">
                <div class="w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-list-ol text-2xl text-blue-500"></i>
                </div>
                <h4 class="font-bold text-gray-800 mb-2 text-sm">Numbering Preserved</h4>
                <p class="text-xs text-gray-500">Roman numerals, decimals, letters — all maintained correctly.</p>
            </div>
            <div class="tool-card p-6 text-center">
                <div class="w-12 h-12 bg-yellow-50 rounded-xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-bolt text-2xl text-yellow-500"></i>
                </div>
                <h4 class="font-bold text-gray-800 mb-2 text-sm">Lightning Fast</h4>
                <p class="text-xs text-gray-500">Instant conversion directly in your browser.</p>
            </div>
            <div class="tool-card p-6 text-center">
                <div class="w-12 h-12 bg-purple-50 rounded-xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-user-slash text-2xl text-purple-500"></i>
                </div>
                <h4 class="font-bold text-gray-800 mb-2 text-sm">No Signup</h4>
                <p class="text-xs text-gray-500">No account needed. Free to use instantly.</p>
            </div>
        </div>
    </div>
</section>

<!-- RELATED TOOLS -->
<section class="py-16 bg-white border-t border-gray-100">
    <div class="max-w-5xl mx-auto px-5">
        <h2 class="text-2xl font-bold text-gray-900 text-center mb-10"><i class="fas fa-tools text-red-500 mr-2"></i>Related PDF Tools</h2>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <a href="pdf-to-word.html" class="tool-card p-5 text-center">
                <i class="fas fa-file-word text-3xl text-blue-500 mb-3 block"></i>
                <div class="font-semibold text-gray-800 text-sm mb-0.5">PDF to Word</div>
                <div class="text-xs text-gray-400">Convert PDF to editable DOC</div>
                <div class="mt-2"><span class="bg-red-500 text-white text-xs px-2 py-0.5 rounded-full font-bold">HOT</span></div>
            </a>
            <a href="excel-to-pdf.html" class="tool-card p-5 text-center">
                <i class="fas fa-file-excel text-3xl text-green-500 mb-3 block"></i>
                <div class="font-semibold text-gray-800 text-sm mb-0.5">Excel to PDF</div>
                <div class="text-xs text-gray-400">Convert spreadsheets to PDF</div>
            </a>
            <a href="powerpoint-to-pdf.html" class="tool-card p-5 text-center">
                <i class="fas fa-file-powerpoint text-3xl text-orange-500 mb-3 block"></i>
                <div class="font-semibold text-gray-800 text-sm mb-0.5">PPT to PDF</div>
                <div class="text-xs text-gray-400">Convert presentations to PDF</div>
            </a>
            <a href="jpg-to-pdf.html" class="tool-card p-5 text-center">
                <i class="fas fa-image text-3xl text-pink-500 mb-3 block"></i>
                <div class="font-semibold text-gray-800 text-sm mb-0.5">JPG to PDF</div>
                <div class="text-xs text-gray-400">Convert images to PDF</div>
            </a>
        </div>
    </div>
</section>

<!-- FOOTER -->
<footer class="bg-gray-900 text-white py-12 border-t border-gray-800">
    <div class="max-w-6xl mx-auto px-5">
        <div class="grid grid-cols-1 md:grid-cols-5 gap-8 mb-8">
            <div>
                <div class="flex items-center gap-2 mb-3">
                    <div class="w-8 h-8 bg-red-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-tools text-white text-sm"></i>
                    </div>
                    <span class="font-bold text-white text-sm">Free Tools Hub</span>
                </div>
                <p class="text-gray-400 text-xs leading-relaxed">Free online PDF and document tools. Fast, simple, and always free.</p>
            </div>
            <div>
                <h4 class="font-semibold text-xs text-gray-300 mb-4 uppercase tracking-wider">Categories</h4>
                <ul class="space-y-2 text-xs text-gray-500">
                    <li><a href="../../index.html#tools" class="hover:text-white transition">Utility Tools</a></li>
                    <li><a href="../../index.html#tools" class="hover:text-white transition">Student Tools</a></li>
                    <li><a href="../../index.html#tools" class="hover:text-white transition">Design Tools</a></li>
                    <li><a href="../../index.html#tools" class="hover:text-white transition">SEO Tools</a></li>
                    <li><a href="../../index.html#tools" class="hover:text-white transition">Web Dev Tools</a></li>
                </ul>
            </div>
            <div>
                <h4 class="font-semibold text-xs text-gray-300 mb-4 uppercase tracking-wider">Resources</h4>
                <ul class="space-y-2 text-xs text-gray-500">
                    <li><a href="../../blog.html" class="hover:text-white transition">Blog</a></li>
                    <li><a href="../../tutorials.html" class="hover:text-white transition">Tutorials</a></li>
                    <li><a href="../../resources.html" class="hover:text-white transition">Resources</a></li>
                    <li><a href="../../comparisons.html" class="hover:text-white transition">Compare Tools</a></li>
                </ul>
            </div>
            <div>
                <h4 class="font-semibold text-xs text-gray-300 mb-4 uppercase tracking-wider">Company</h4>
                <ul class="space-y-2 text-xs text-gray-500">
                    <li><a href="../../about.html" class="hover:text-white transition">About Us</a></li>
                    <li><a href="../../contact.html" class="hover:text-white transition">Contact</a></li>
                    <li><a href="../../privacy.html" class="hover:text-white transition">Privacy Policy</a></li>
                    <li><a href="../../terms.html" class="hover:text-white transition">Terms of Service</a></li>
                </ul>
            </div>
            <div>
                <h4 class="font-semibold text-xs text-gray-300 mb-4 uppercase tracking-wider">Connect</h4>
                <div class="flex gap-3 mb-3">
                    <a href="#" class="text-gray-500 hover:text-blue-400 transition text-lg"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="text-gray-500 hover:text-blue-600 transition text-lg"><i class="fab fa-facebook"></i></a>
                    <a href="#" class="text-gray-500 hover:text-red-500 transition text-lg"><i class="fab fa-youtube"></i></a>
                    <a href="#" class="text-gray-500 hover:text-pink-400 transition text-lg"><i class="fab fa-instagram"></i></a>
                </div>
                <p class="text-gray-600 text-xs">by freetoolsapp</p>
            </div>
        </div>
        <div class="border-t border-gray-800 pt-6 flex flex-col md:flex-row items-center justify-between gap-3 text-xs text-gray-600">
            <p>&copy; 2025 Free Tools Hub. All rights reserved. Made with <i class="fas fa-heart text-red-500 mx-1"></i>for creators and learners.</p>
            <div class="flex gap-5">
                <a href="../../privacy.html" class="hover:text-gray-300 transition">Privacy</a>
                <a href="../../terms.html" class="hover:text-gray-300 transition">Terms</a>
                <a href="../../contact.html" class="hover:text-gray-300 transition">Contact</a>
            </div>
        </div>
    </div>
</footer>

<button id="btt" class="fixed bottom-6 right-6 w-10 h-10 bg-red-500 hover:bg-red-600 text-white rounded-full shadow-lg z-50 transition items-center justify-center" style="display:none">
    <i class="fas fa-arrow-up text-sm"></i>
</button>

<script>
/* ── Safe mobile menu (header.js loads async) ── */
function initMobileMenu() {
    var btn  = document.getElementById('mobileMenuBtn');
    var menu = document.getElementById('mobileMenu');
    if (!btn || !menu || btn._ready) return;
    btn._ready = true;
    btn.addEventListener('click', function() {
        menu.classList.toggle('hidden');
        var ic = btn.querySelector('i');
        if (ic) { ic.classList.toggle('fa-bars'); ic.classList.toggle('fa-times'); }
    });
    document.addEventListener('click', function(e) {
        if (!btn.contains(e.target) && !menu.contains(e.target)) {
            menu.classList.add('hidden');
            var ic = btn.querySelector('i');
            if (ic) { ic.classList.remove('fa-times'); ic.classList.add('fa-bars'); }
        }
    });
}
initMobileMenu();
setTimeout(initMobileMenu, 300);
setTimeout(initMobileMenu, 1000);
setTimeout(initMobileMenu, 2500);

/* ── Back to top ── */
var $btt = document.getElementById('btt');
window.addEventListener('scroll', function() {
    $btt.style.display = window.scrollY > 400 ? 'flex' : 'none';
}, {passive:true});
$btt.addEventListener('click', function() { window.scrollTo({top:0,behavior:'smooth'}); });

/* ── DOM refs ── */
var stageUpload  = document.getElementById('stageUpload');
var stageProcess = document.getElementById('stageProcess');
var stagePreview = document.getElementById('stagePreview');
var stageSuccess = document.getElementById('stageSuccess');
var uploadZone   = document.getElementById('uploadZone');
var fileInput    = document.getElementById('fileInput');
var errBox       = document.getElementById('errBox');
var errMsg       = document.getElementById('errMsg');
var procTitle    = document.getElementById('procTitle');
var procSub      = document.getElementById('procSub');
var progFill     = document.getElementById('progFill');
var progStatus   = document.getElementById('progStatus');
var progPct      = document.getElementById('progPct');
var fName        = document.getElementById('fName');
var fSize        = document.getElementById('fSize');
var removeBtn    = document.getElementById('removeBtn');
var docxStage    = document.getElementById('docxStage');
var convertBtn   = document.getElementById('convertBtn');
var convProgress = document.getElementById('convProgress');
var convMsg      = document.getElementById('convMsg');
var convFill     = document.getElementById('convFill');
var dlBtn        = document.getElementById('dlBtn');
var sucName      = document.getElementById('sucName');

var selFile            = null;
var parsedHtml         = '';
var pageSize           = { wPx:794, hPx:1123, wMM:210, hMM:297, name:'A4' };
var selectedOutputSize = 'auto';

var PAGE_SIZES = {
    a4:     { wPx:794,  hPx:1123, wMM:210,   hMM:297,   name:'A4' },
    letter: { wPx:816,  hPx:1056, wMM:215.9, hMM:279.4, name:'Letter' },
    legal:  { wPx:816,  hPx:1344, wMM:215.9, hMM:355.6, name:'Legal'  }
};

function selectPageSize(size) {
    selectedOutputSize = size;
    document.querySelectorAll('.page-size-btn').forEach(function(b) {
        b.classList.remove('border-red-400','bg-red-50','text-red-600');
        b.classList.add('border-gray-200','bg-white','text-gray-600');
    });
    var active = document.getElementById('btn-' + size);
    if (active) {
        active.classList.add('border-red-400','bg-red-50','text-red-600');
        active.classList.remove('border-gray-200','bg-white','text-gray-600');
    }
    var info  = document.getElementById('selectedSizeInfo');
    var badge = document.getElementById('autoDetectBadge');
    if (size === 'auto') {
        info.innerHTML = '<i class="fas fa-info-circle mr-1"></i>Using auto-detected size from your document';
        badge.classList.remove('hidden');
    } else {
        var s = PAGE_SIZES[size];
        info.innerHTML = '<i class="fas fa-check-circle mr-1 text-green-500"></i>Output will be <strong>' + s.name + '</strong> (' + s.wMM + '×' + s.hMM + 'mm)';
        badge.classList.add('hidden');
    }
}

function getOutputPageSize() {
    if (selectedOutputSize === 'auto') return pageSize;
    return PAGE_SIZES[selectedOutputSize];
}

var fmt   = function(b) { return b<1024?b+' B':b<1048576?(b/1024).toFixed(1)+' KB':(b/1048576).toFixed(2)+' MB'; };
var sleep = function(ms) { return new Promise(function(r){setTimeout(r,ms);}); };

function show(name) {
    [stageUpload,stageProcess,stagePreview,stageSuccess].forEach(function(s){ s.classList.add('hidden'); });
    document.getElementById('stage'+name).classList.remove('hidden');
}
function setP(pct,st) { progFill.style.width=pct+'%'; progPct.textContent=pct+'%'; if(st) progStatus.textContent=st; }
function showErr(m)   { errMsg.textContent=m; errBox.classList.remove('hidden'); }
function hideErr()    { errBox.classList.add('hidden'); }

/* ── Drag & drop ── */
['dragenter','dragover','dragleave','drop'].forEach(function(ev) {
    uploadZone.addEventListener(ev, function(e){ e.preventDefault(); e.stopPropagation(); });
    document.body.addEventListener(ev, function(e){ e.preventDefault(); e.stopPropagation(); });
});
['dragenter','dragover'].forEach(function(ev) { uploadZone.addEventListener(ev, function(){ uploadZone.classList.add('over'); }); });
['dragleave','drop'].forEach(function(ev)     { uploadZone.addEventListener(ev, function(){ uploadZone.classList.remove('over'); }); });
uploadZone.addEventListener('drop', function(e) {
    var f = e.dataTransfer && e.dataTransfer.files[0];
    if (f) pick(f);
});

/* ── File input (main mobile trigger) ── */
fileInput.addEventListener('change', function(e) {
    var f = e.target.files && e.target.files[0];
    if (f) {
        pick(f);
        try { fileInput.value = ''; } catch(ex){}
    }
});

removeBtn.addEventListener('click', resetAll);

function pick(f) {
    var name = f.name || '';
    var ext  = name.split('.').pop().toLowerCase();
    // Accept by extension OR by MIME type
    var validExt  = ['docx','doc'].includes(ext);
    var validMime = f.type === 'application/msword' ||
                    f.type === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document';
    if (!validExt && !validMime) {
        showErr('Only .docx and .doc files are supported.');
        return;
    }
    if (f.size > 50 * 1024 * 1024) {
        showErr('File too large. Maximum size is 50MB.');
        return;
    }
    hideErr();
    selFile = f;
    doConvert(f);
}

/* ══════════════════════════════════════════════════════
   CUSTOM DOCX PARSER
══════════════════════════════════════════════════════ */

function toRoman(num) {
    if (num <= 0) return '';
    var vals = [1000,900,500,400,100,90,50,40,10,9,5,4,1];
    var syms = ['m','cm','d','cd','c','xc','l','xl','x','ix','v','iv','i'];
    var result = '';
    for (var i=0;i<vals.length;i++) { while(num>=vals[i]){ result+=syms[i]; num-=vals[i]; } }
    return result;
}

function toLetter(num) {
    if (num <= 0) return '';
    return String.fromCharCode(96 + ((num-1) % 26) + 1);
}

function formatNum(num, fmt, lvlText) {
    var numStr = '';
    switch(fmt) {
        case 'lowerRoman':  numStr = toRoman(num); break;
        case 'upperRoman':  numStr = toRoman(num).toUpperCase(); break;
        case 'lowerLetter': numStr = toLetter(num); break;
        case 'upperLetter': numStr = toLetter(num).toUpperCase(); break;
        default:            numStr = String(num);
    }
    if (lvlText && lvlText.includes('%')) return lvlText.replace(/%\d/g, numStr);
    return numStr + '.';
}

async function doConvert(file) {
    show('Process');
    procTitle.textContent = 'Reading your document…';
    procSub.textContent   = 'Please wait a moment';
    setP(5, 'Loading file…');

    try {
        var buf = await file.arrayBuffer();
        var zip = await JSZip.loadAsync(buf);
        setP(15, 'Parsing XML…');

        var docXml    = await zip.file('word/document.xml').async('string');
        var numXml    = zip.file('word/numbering.xml')  ? await zip.file('word/numbering.xml').async('string')  : null;
        var relXml    = zip.file('word/_rels/document.xml.rels') ? await zip.file('word/_rels/document.xml.rels').async('string') : null;

        setP(30, 'Processing numbering…');

        var numMap   = {};
        var counters = {};

        if (numXml) {
            var numParser = new DOMParser();
            var numDoc    = numParser.parseFromString(numXml, 'application/xml');

            var abstractNums = {};
            numDoc.querySelectorAll('abstractNum').forEach(function(an) {
                var id   = an.getAttribute('w:abstractNumId');
                var lvl0 = an.querySelector('lvl[w\\:ilvl="0"]') || an.querySelector('lvl');
                if (lvl0) {
                    var fmt      = (lvl0.querySelector('numFmt') && lvl0.querySelector('numFmt').getAttribute('w:val')) || 'decimal';
                    var start    = parseInt((lvl0.querySelector('start') && lvl0.querySelector('start').getAttribute('w:val')) || '1');
                    var lvlText  = (lvl0.querySelector('lvlText') && lvl0.querySelector('lvlText').getAttribute('w:val')) || '%1.';
                    abstractNums[id] = { fmt:fmt, start:start, lvlText:lvlText };
                }
            });

            numDoc.querySelectorAll('num').forEach(function(n) {
                var numId = n.getAttribute('w:numId');
                var absEl = n.querySelector('abstractNumId');
                var absId = absEl && absEl.getAttribute('w:val');
                if (absId && abstractNums[absId]) {
                    numMap[numId]   = Object.assign({}, abstractNums[absId]);
                    counters[numId] = abstractNums[absId].start - 1;
                }
            });
        }

        setP(45, 'Reading images…');

        var images = {};
        if (relXml) {
            var relParser = new DOMParser();
            var relDoc    = relParser.parseFromString(relXml, 'application/xml');
            var rels      = relDoc.querySelectorAll('Relationship');
            for (var ri = 0; ri < rels.length; ri++) {
                var rel  = rels[ri];
                var type = rel.getAttribute('Type') || '';
                if (type.includes('image')) {
                    var rId     = rel.getAttribute('Id');
                    var target  = rel.getAttribute('Target');
                    var imgPath = target.startsWith('/') ? target.slice(1) : 'word/' + target;
                    var imgFile = zip.file(imgPath) || zip.file(imgPath.replace('word/',''));
                    if (imgFile) {
                        var b64  = await imgFile.async('base64');
                        var ext  = imgPath.split('.').pop().toLowerCase();
                        var mime = ext==='png'?'image/png':ext==='gif'?'image/gif':'image/jpeg';
                        images[rId] = 'data:' + mime + ';base64,' + b64;
                    }
                }
            }
        }

        setP(60, 'Building document…');

        var docParser = new DOMParser();
        var docDoc    = docParser.parseFromString(docXml, 'application/xml');
        var body      = docDoc.querySelector('body');
        var nodes     = Array.from(body.children);
        var html      = '';

        nodes.forEach(function(node) {
            var tag = node.localName;
            if      (tag === 'p')   html += parseParagraph(node, numMap, counters, images);
            else if (tag === 'tbl') html += parseTable(node, numMap, counters, images);
        });

        parsedHtml = html;

        /* Detect page size */
        pageSize = { wPx:794, hPx:1123, wMM:210, hMM:297, name:'A4' };
        var sectPr = docDoc.querySelector('sectPr');
        if (sectPr) {
            var pgSz = sectPr.querySelector('pgSz');
            if (pgSz) {
                var twW  = parseInt(pgSz.getAttribute('w:w') || '11906');
                var twH  = parseInt(pgSz.getAttribute('w:h') || '16838');
                var wPx  = Math.round(twW / 1440 * 96);
                var hPx  = Math.round(twH / 1440 * 96);
                var wMM  = Math.round(twW / 1440 * 25.4 * 10) / 10;
                var hMM  = Math.round(twH / 1440 * 25.4 * 10) / 10;
                var pname = 'Custom';
                if      (Math.abs(wPx-794)<5 && Math.abs(hPx-1123)<5)  pname = 'A4';
                else if (Math.abs(wPx-816)<5 && Math.abs(hPx-1056)<5)  pname = 'Letter';
                else if (Math.abs(wPx-816)<5 && Math.abs(hPx-1344)<5)  pname = 'Legal';
                var orient = pgSz.getAttribute('w:orient') || '';
                if (orient === 'landscape') pname += ' Landscape';
                pageSize = { wPx:wPx, hPx:hPx, wMM:wMM, hMM:hMM, name:pname };
            }
        }
        document.getElementById('prevBadge').textContent = '✓ ' + pageSize.name;

        setP(85, 'Rendering preview…');
        buildPreview(parsedHtml);
        await sleep(200);

        setP(100, 'Done!');
        await sleep(150);

        fName.textContent = file.name;
        fSize.textContent = fmt(file.size);
        show('Preview');
        document.querySelector('.tool-hero').scrollIntoView({behavior:'smooth', block:'start'});

    } catch(err) {
        console.error(err);
        showErr('Could not read this file: ' + err.message);
        show('Upload');
    }
}

function parseParagraph(pNode, numMap, counters, images) {
    var numPr  = pNode.querySelector('numPr');
    var numId  = numPr && numPr.querySelector('numId') ? numPr.querySelector('numId').getAttribute('w:val') : null;

    var pPrEl  = pNode.querySelector('pPr');
    var indEl  = pPrEl && pPrEl.querySelector('ind');
    var leftInd = parseInt((indEl && indEl.getAttribute('w:left')) || '0');

    var innerHtml = '';
    var runs      = pNode.querySelectorAll('r, hyperlink');

    runs.forEach(function(run) {
        if (run.localName === 'hyperlink') {
            var linkText = '';
            run.querySelectorAll('t').forEach(function(t){ linkText += t.textContent; });
            innerHtml += '<a href="#" style="color:#1a56db">' + esc(linkText) + '</a>';
            return;
        }

        var drawing = run.querySelector('drawing');
        if (drawing) {
            var blip = drawing.querySelector('blip');
            var rId  = blip && (blip.getAttribute('r:embed') || blip.getAttributeNS('http://schemas.openxmlformats.org/officeDocument/2006/relationships','embed'));
            if (rId && images[rId]) {
                innerHtml += '<img src="' + images[rId] + '" style="max-width:100%;height:auto;display:block;margin:4px 0">';
            }
            return;
        }

        var rPrEl  = run.querySelector('rPr');
        var bold   = (rPrEl && rPrEl.querySelector('b')) ? 'font-weight:bold;' : '';
        var italic = (rPrEl && rPrEl.querySelector('i')) ? 'font-style:italic;' : '';
        var under  = (rPrEl && rPrEl.querySelector('u')) ? 'text-decoration:underline;' : '';
        var szEl   = rPrEl && rPrEl.querySelector('sz');
        var fontSize = szEl ? 'font-size:' + (parseInt(szEl.getAttribute('w:val'))/2) + 'pt;' : '';

        var txt = '';
        run.querySelectorAll('t').forEach(function(t) {
            txt += (t.getAttribute('xml:space') === 'preserve') ? t.textContent : t.textContent.trim();
        });
        run.querySelectorAll('br').forEach(function() { txt += '\n'; });

        if (txt) {
            var style = bold + italic + under + fontSize;
            txt = esc(txt).replace(/\n/g, '<br>');
            innerHtml += style ? '<span style="' + style + '">' + txt + '</span>' : txt;
        }
    });

    if (!innerHtml.trim()) return '<div style="height:6pt"></div>';

    var prefix = '';
    if (numId && numMap[numId]) {
        if (counters[numId] === undefined) counters[numId] = numMap[numId].start - 1;
        counters[numId]++;
        var formatted = formatNum(counters[numId], numMap[numId].fmt, numMap[numId].lvlText);
        prefix = '<span style="display:inline-block;min-width:28px;margin-right:6px;font-weight:normal">' + formatted + '</span>';
    }

    var isBold = pNode.querySelector('r > rPr > b') !== null;
    var text   = pNode.textContent.trim();
    var pStyle = pPrEl && pPrEl.querySelector('pStyle');
    var styleId = (pStyle && pStyle.getAttribute('w:val')) || '';
    var isHeading = styleId.toLowerCase().includes('heading') || (isBold && text.length < 120 && !numId);

    var paraStyle = 'margin:0 0 4pt 0;padding:0;';
    if (leftInd > 0) paraStyle += 'padding-left:' + Math.round(leftInd/20) + 'pt;';
    if (isHeading && !numId) paraStyle += 'font-weight:bold;';

    return '<div style="' + paraStyle + '">' + prefix + innerHtml + '</div>';
}

function parseTable(tblNode, numMap, counters, images) {
    var html = '<table style="border-collapse:collapse;width:100%;margin:6pt 0;font-size:11pt">';
    tblNode.querySelectorAll('tr').forEach(function(tr) {
        html += '<tr>';
        tr.querySelectorAll('tc').forEach(function(tc) {
            var cellHtml = '';
            tc.querySelectorAll('p').forEach(function(p) {
                cellHtml += parseParagraph(p, numMap, counters, images);
            });
            html += '<td style="border:1px solid #999;padding:4pt 6pt;vertical-align:top">' + cellHtml + '</td>';
        });
        html += '</tr>';
    });
    html += '</table>';
    return html;
}

function esc(str) {
    return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

function buildPreview(html) {
    docxStage.style.cssText = 'background:#525659;padding:20px;min-height:120px;max-height:500px;overflow-y:auto;';
    docxStage.innerHTML = '';
    var wrapper = document.createElement('div');
    wrapper.style.cssText = 'width:397px;margin:0 auto;background:#fff;box-shadow:0 4px 20px rgba(0,0,0,.5);padding:36px 40px;font-family:"Times New Roman",Georgia,serif;font-size:12pt;line-height:1.6;color:#000;min-height:562px;';
    wrapper.innerHTML = html;
    docxStage.appendChild(wrapper);
}

/* ── Convert to PDF ── */
convertBtn.addEventListener('click', async function() {
    if (!selFile || !parsedHtml) return;
    convertBtn.disabled = true;
    convertBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Converting…';
    convProgress.classList.remove('hidden');
    convFill.style.width = '5%';
    convMsg.textContent  = 'Preparing pages…';

    try {
        var jsPDF    = window.jspdf.jsPDF;
        var SCALE    = 2;
        var outSize  = getOutputPageSize();
        var PGW      = outSize.wPx;
        var PGH      = outSize.hPx;
        var PGW_MM   = outSize.wMM;
        var PGH_MM   = outSize.hMM;
        var PAD_TOP  = Math.round(PGH * 0.064);
        var PAD_SIDE = Math.round(PGW * 0.101);

        convMsg.textContent = 'Detected: ' + pageSize.name + ' (' + PGW_MM + '×' + PGH_MM + 'mm)';

        var renderDiv = document.createElement('div');
        renderDiv.style.cssText =
            'position:fixed;top:-9999999px;left:0;' +
            'width:' + PGW + 'px;' +
            'font-family:"Times New Roman",Georgia,serif;' +
            'font-size:12pt;line-height:1.6;color:#000;background:#fff;' +
            'padding:' + PAD_TOP + 'px ' + PAD_SIDE + 'px;' +
            'box-sizing:border-box;';
        renderDiv.innerHTML = parsedHtml;
        document.body.appendChild(renderDiv);
        await sleep(500);

        var totalH   = renderDiv.scrollHeight;
        var numPages = Math.max(1, Math.ceil(totalH / PGH));

        convMsg.textContent  = 'Capturing document (' + numPages + ' pages)…';
        convFill.style.width = '15%';

        var fullCanvas = await html2canvas(renderDiv, {
            scale: SCALE, useCORS: true, allowTaint: true,
            backgroundColor: '#ffffff', logging: false,
            width: PGW, height: totalH,
            scrollX: 0, scrollY: 0,
            windowWidth: PGW, windowHeight: totalH
        });
        renderDiv.remove();
        convFill.style.width = '60%';

        var pdf      = new jsPDF({unit:'mm', format:[PGW_MM, PGH_MM], compress:true});
        var sliceH   = PGH * SCALE;
        var canvasW  = fullCanvas.width;
        var canvasH  = fullCanvas.height;

        for (var i = 0; i < numPages; i++) {
            convFill.style.width = Math.round(60 + (i/numPages)*35) + '%';
            convMsg.textContent  = 'Building page ' + (i+1) + ' of ' + numPages + '…';

            var pageCanvas      = document.createElement('canvas');
            pageCanvas.width    = canvasW;
            pageCanvas.height   = sliceH;
            var ctx             = pageCanvas.getContext('2d');
            ctx.fillStyle       = '#ffffff';
            ctx.fillRect(0, 0, canvasW, sliceH);

            var srcY      = i * sliceH;
            var srcHeight = Math.min(sliceH, canvasH - srcY);
            if (srcHeight > 0) {
                ctx.drawImage(fullCanvas, 0, srcY, canvasW, srcHeight, 0, 0, canvasW, srcHeight);
            }

            var imgData = pageCanvas.toDataURL('image/jpeg', 0.92);
            if (i > 0) pdf.addPage();
            pdf.addImage(imgData, 'JPEG', 0, 0, PGW_MM, PGH_MM, '', 'FAST');
            await sleep(10);
        }

        convFill.style.width = '100%';
        convMsg.textContent  = 'Done!';
        await sleep(300);

        var outName = selFile.name.replace(/\.(docx|doc)$/i,'') + '.pdf';
        var blob    = pdf.output('blob');
        var url     = URL.createObjectURL(blob);

        show('Success');
        sucName.textContent = outName + ' — ' + fmt(blob.size);
        dlBtn.onclick = function() {
            var a = document.createElement('a');
            a.href = url; a.download = outName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        };
        stageSuccess.scrollIntoView({behavior:'smooth', block:'center'});

    } catch(err) {
        console.error(err);
        showErr('Conversion failed: ' + err.message);
        show('Preview');
    }

    convertBtn.disabled = false;
    convertBtn.innerHTML = '<i class="fas fa-file-pdf text-xl"></i> Convert to PDF';
    convProgress.classList.add('hidden');
});

/* ── Reset ── */
function resetAll() {
    selFile = null; parsedHtml = '';
    try { fileInput.value = ''; } catch(ex){}
    selectedOutputSize = 'auto';
    selectPageSize('auto');
    docxStage.innerHTML = '';
    convProgress.classList.add('hidden');
    convertBtn.disabled = false;
    convertBtn.innerHTML = '<i class="fas fa-file-pdf text-xl"></i> Convert to PDF';
    hideErr();
    show('Upload');
    window.scrollTo({top:0,behavior:'smooth'});
}
</script>

<!-- Service Worker -->
<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('/sw.js')
                .then(function() { console.log('SW registered'); })
                .catch(function(err) { console.log('SW error:', err); });
        });
    }
</script>
</body>
</html>
