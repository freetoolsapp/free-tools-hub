<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Word to PDF Converter - Free Tools Hub</title>
<meta name="description" content="Convert Word documents to PDF instantly. Free, no signup, preserves formatting.">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Segoe UI',Arial,sans-serif;background:#f0f4f8;color:#1a202c}

/* HEADER */
header{background:#fff;border-bottom:1px solid #e2e8f0;position:sticky;top:0;z-index:99;box-shadow:0 1px 4px rgba(0,0,0,.06)}
.hdr{max-width:1100px;margin:auto;padding:0 20px;height:62px;display:flex;align-items:center;justify-content:space-between}
.logo{display:flex;align-items:center;gap:10px;text-decoration:none}
.logo-ic{width:38px;height:38px;background:linear-gradient(135deg,#2563eb,#7c3aed);border-radius:9px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:16px}
.logo-txt{font-weight:700;font-size:15px;color:#1a202c}
.logo-sub{font-size:11px;color:#94a3b8}
nav a{padding:6px 12px;border-radius:7px;font-size:13px;font-weight:500;color:#475569;text-decoration:none}
nav a:hover{background:#f1f5f9;color:#2563eb}
nav .nav-cta{background:linear-gradient(135deg,#2563eb,#7c3aed);color:#fff!important;padding:7px 16px}
#mbtn{background:none;border:none;font-size:22px;color:#64748b;cursor:pointer;display:none}
#mmenu{display:none;background:#fff;border-top:1px solid #e2e8f0}
#mmenu a{display:block;padding:11px 20px;font-size:14px;color:#475569;text-decoration:none;border-bottom:1px solid #f1f5f9}
#mmenu a:hover{color:#2563eb;background:#f8fafc}

/* BREADCRUMB */
.bc{background:#fff;border-bottom:1px solid #e2e8f0;padding:9px 0}
.bc-in{max-width:1100px;margin:auto;padding:0 20px;display:flex;align-items:center;gap:5px;font-size:12.5px;color:#94a3b8}
.bc-in a{color:#94a3b8;text-decoration:none}.bc-in a:hover{color:#2563eb}

/* HERO */
.hero{background:linear-gradient(135deg,#0f172a 0%,#1e1b4b 60%,#0f172a 100%);padding:60px 20px;text-align:center;position:relative;overflow:hidden}
.hero::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse 70% 60% at 50% 0%,rgba(99,102,241,.22),transparent 70%)}
.hero-inner{position:relative;max-width:600px;margin:auto}
.hero-badge{display:inline-flex;align-items:center;gap:6px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.13);border-radius:100px;padding:5px 14px;font-size:12px;color:rgba(255,255,255,.7);margin-bottom:18px}
.hero-ic{width:76px;height:76px;background:rgba(99,102,241,.2);border:1px solid rgba(255,255,255,.13);border-radius:22px;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:34px;color:#fff}
.hero h1{font-size:clamp(26px,5vw,46px);font-weight:800;color:#fff;line-height:1.15;margin-bottom:12px}
.hero p{font-size:15px;color:rgba(255,255,255,.6);margin-bottom:20px}
.pills{display:flex;flex-wrap:wrap;justify-content:center;gap:7px}
.pill{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);border-radius:100px;padding:4px 11px;font-size:11.5px;color:rgba(255,255,255,.8)}

/* MAIN */
main{max-width:1100px;margin:0 auto;padding:36px 20px 60px}

/* CARD */
.card{background:#fff;border:1px solid #e2e8f0;border-radius:16px;box-shadow:0 2px 12px rgba(0,0,0,.06);padding:28px;margin-bottom:22px}
.card-title{font-size:17px;font-weight:700;color:#1a202c;margin-bottom:18px;display:flex;align-items:center;gap:9px}
.cticon{width:34px;height:34px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0}

/* DROP ZONE */
.dz{border:2px dashed #cbd5e1;border-radius:12px;padding:50px 20px;text-align:center;cursor:pointer;transition:all .2s;background:#f8fafc}
.dz:hover,.dz.drag{border-color:#2563eb;background:#eff6ff}
.dz-ic{width:68px;height:68px;background:linear-gradient(135deg,#eff6ff,#e0e7ff);border-radius:18px;display:flex;align-items:center;justify-content:center;margin:0 auto 16px;font-size:30px;color:#2563eb}
.dz h3{font-size:16px;font-weight:700;margin-bottom:5px}
.dz p{font-size:13px;color:#94a3b8;margin-bottom:16px}
.dz-note{font-size:11.5px;color:#94a3b8;margin-top:10px}

/* BUTTONS */
.btn{display:inline-flex;align-items:center;gap:7px;padding:10px 20px;border-radius:9px;font-family:inherit;font-size:14px;font-weight:600;cursor:pointer;border:none;transition:all .2s}
.btn-blue{background:linear-gradient(135deg,#2563eb,#7c3aed);color:#fff;box-shadow:0 3px 10px rgba(37,99,235,.3)}
.btn-blue:hover{opacity:.9;transform:translateY(-1px)}
.btn-green{background:linear-gradient(135deg,#10b981,#059669);color:#fff;box-shadow:0 3px 10px rgba(16,185,129,.3);width:100%;justify-content:center;padding:14px;font-size:15px}
.btn-green:hover{opacity:.9;transform:translateY(-1px)}
.btn-gray{background:#f1f5f9;color:#475569;width:100%;justify-content:center;margin-top:10px}
.btn-gray:hover{background:#e2e8f0}

/* FILE INFO */
#fileInfo{display:none;margin-top:14px;background:#eff6ff;border:1px solid #bfdbfe;border-radius:10px;padding:13px 16px;align-items:center;justify-content:space-between}
.fi-left{display:flex;align-items:center;gap:11px}
.fi-name{font-weight:600;font-size:14px;color:#1a202c}
.fi-sub{font-size:12px;color:#64748b;margin-top:2px}
.fi-del{background:none;border:none;cursor:pointer;color:#94a3b8;font-size:19px}
.fi-del:hover{color:#ef4444}

/* PROCESSING */
#processing{display:none}
.proc-in{text-align:center}
.spinner{width:54px;height:54px;border:4px solid #e2e8f0;border-top-color:#2563eb;border-radius:50%;animation:spin .85s linear infinite;margin:0 auto 18px}
@keyframes spin{to{transform:rotate(360deg)}}
.proc-title{font-size:19px;font-weight:700;margin-bottom:5px}
.proc-msg{font-size:13.5px;color:#64748b;margin-bottom:18px}
.prog-bar{background:#e2e8f0;border-radius:100px;height:10px;overflow:hidden}
.prog-fill{height:100%;background:linear-gradient(90deg,#2563eb,#7c3aed);border-radius:100px;transition:width .35s ease;width:0%}
.prog-lbl{font-size:12px;color:#94a3b8;margin-top:7px}

/* RESULTS */
#results{display:none}
.ok-ic{width:70px;height:70px;background:#d1fae5;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 14px;font-size:30px;color:#10b981}
.res-title{font-size:22px;font-weight:800;text-align:center;margin-bottom:5px}
.res-sub{text-align:center;font-size:13.5px;color:#64748b;margin-bottom:22px}
.stats{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:22px}
.stat{background:#f8fafc;border:1px solid #e2e8f0;border-radius:10px;padding:16px;text-align:center}
.stat-ic{font-size:26px;margin-bottom:7px}
.stat-lbl{font-size:11.5px;color:#94a3b8;margin-bottom:3px}
.stat-val{font-size:22px;font-weight:700}

/* PREVIEW TABS */
.prev-hdr{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;flex-wrap:wrap;gap:10px}
.prev-tabs{display:flex;gap:7px}
.ptab{background:#f1f5f9;border:1px solid #e2e8f0;border-radius:7px;padding:6px 13px;font-family:inherit;font-size:12.5px;font-weight:500;cursor:pointer;color:#475569}
.ptab:hover{background:#e2e8f0}
.ptab.on{background:#2563eb;color:#fff;border-color:#2563eb}

/* A4 page view */
.pages-wrap{background:#cbd5e1;border-radius:10px;padding:20px;max-height:660px;overflow-y:auto}
.a4{width:794px;min-height:1123px;background:#fff;margin:0 auto 18px;padding:72px 75px;box-shadow:0 4px 20px rgba(0,0,0,.15);position:relative;font-family:Calibri,'Times New Roman',serif;font-size:12pt;line-height:1.5;color:#000}
.a4:last-child{margin-bottom:0}
.a4 h1{font-size:20pt;font-weight:bold;margin:14pt 0 6pt}
.a4 h2{font-size:16pt;font-weight:bold;margin:12pt 0 5pt}
.a4 h3{font-size:13pt;font-weight:bold;margin:10pt 0 4pt}
.a4 h4,.a4 h5,.a4 h6{font-size:12pt;font-weight:bold;margin:8pt 0 4pt}
.a4 p{margin:0 0 8pt}
.a4 ul,.a4 ol{margin:0 0 8pt 24pt;padding:0}
.a4 li{margin-bottom:4pt}
.a4 table{width:100%;border-collapse:collapse;margin-bottom:10pt}
.a4 td,.a4 th{border:1px solid #ccc;padding:4pt 6pt;font-size:11pt}
.a4 strong,.a4 b{font-weight:bold}
.a4 em,.a4 i{font-style:italic}
.a4 u{text-decoration:underline}
.a4 img{max-width:100%;height:auto}
.pgnum{position:absolute;bottom:22px;right:28px;font-family:'Segoe UI',Arial,sans-serif;font-size:10.5px;color:#94a3b8}

/* Flow view */
#flowView{display:none;max-height:600px;overflow-y:auto;padding:28px 36px;background:#fff;border:1px solid #e2e8f0;border-radius:10px;font-family:Calibri,'Times New Roman',serif;font-size:12pt;line-height:1.5;color:#000}
#flowView h1{font-size:20pt;font-weight:bold;margin:14pt 0 6pt}
#flowView h2{font-size:16pt;font-weight:bold;margin:12pt 0 5pt}
#flowView h3{font-size:13pt;font-weight:bold;margin:10pt 0 4pt}
#flowView p{margin:0 0 8pt}
#flowView ul,#flowView ol{margin:0 0 8pt 24pt;padding:0}
#flowView li{margin-bottom:4pt}
#flowView table{width:100%;border-collapse:collapse;margin-bottom:10pt}
#flowView td,#flowView th{border:1px solid #ccc;padding:4pt 6pt}

/* scale on small screens */
@media(max-width:860px){
  .pages-wrap{padding:10px}
  .a4{transform:scale(.52);transform-origin:top center;margin-bottom:-490px}
  .a4:last-child{margin-bottom:-510px}
}

/* FEATURES */
.feat-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:22px}
.feat{background:#fff;border:1px solid #e2e8f0;border-radius:12px;padding:22px;text-align:center;transition:all .2s}
.feat:hover{transform:translateY(-4px);box-shadow:0 8px 24px rgba(0,0,0,.08)}
.feat-ic{width:54px;height:54px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:22px;margin:0 auto 12px}
.feat h3{font-size:14.5px;font-weight:700;margin-bottom:5px}
.feat p{font-size:12.5px;color:#64748b}

/* STEPS */
.steps{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
.step{text-align:center;padding:18px 10px}
.step-n{width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:19px;font-weight:800;color:#fff;margin:0 auto 11px}
.step h4{font-size:13.5px;font-weight:700;margin-bottom:5px}
.step p{font-size:12px;color:#64748b}

/* FAQ */
.faq+.faq{border-top:1px solid #f1f5f9}
.faq{padding:16px 0}
.faq-q{font-size:14.5px;font-weight:600;margin-bottom:7px;display:flex;align-items:center;gap:8px}
.faq-q i{color:#2563eb;font-size:11px}
.faq-a{font-size:13px;color:#64748b;padding-left:20px}

/* FOOTER */
footer{background:#0f172a;color:rgba(255,255,255,.6);padding:50px 20px 28px}
.ft{max-width:1100px;margin:auto}
.ft-grid{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:36px;margin-bottom:36px}
.ft-brand p{font-size:13px;color:rgba(255,255,255,.4);margin-top:10px}
.ft-col h4{font-size:12px;font-weight:700;color:#fff;margin-bottom:14px;text-transform:uppercase;letter-spacing:.5px}
.ft-col ul{list-style:none}
.ft-col li{margin-bottom:9px}
.ft-col a{font-size:13px;color:rgba(255,255,255,.45);text-decoration:none}
.ft-col a:hover{color:#fff}
.ft-hr{border:none;border-top:1px solid rgba(255,255,255,.07);margin-bottom:20px}
.ft-bot{text-align:center;font-size:12px;color:rgba(255,255,255,.25)}
.socials{display:flex;gap:10px;margin-top:8px}
.socials a{color:rgba(255,255,255,.35);font-size:17px;text-decoration:none}
.socials a:hover{color:#fff}

@media(max-width:768px){
  nav{display:none}#mbtn{display:block}
  .feat-grid{grid-template-columns:1fr}
  .steps{grid-template-columns:1fr 1fr}
  .ft-grid{grid-template-columns:1fr 1fr;gap:20px}
  .stats{grid-template-columns:1fr 1fr}
}
@media(max-width:480px){
  .steps{grid-template-columns:1fr}
  .ft-grid{grid-template-columns:1fr}
}
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="hdr">
    <a href="../../index.html" class="logo">
      <div class="logo-ic"><i class="fas fa-tools"></i></div>
      <div><div class="logo-txt">Free Tools Hub</div><div class="logo-sub">Tools ¬∑ Blogs ¬∑ Resources</div></div>
    </a>
    <nav>
      <a href="../../index.html"><i class="fas fa-home"></i> Home</a>
      <a href="../../index.html#tools"><i class="fas fa-tools"></i> Tools</a>
      <a href="../../blog.html"><i class="fas fa-blog"></i> Blog</a>
      <a href="../../resources.html"><i class="fas fa-book"></i> Resources</a>
      <a href="../../tutorials.html"><i class="fas fa-chalkboard-teacher"></i> Tutorials</a>
      <a href="../../comparisons.html"><i class="fas fa-balance-scale"></i> Compare</a>
      <a href="../../contact.html" class="nav-cta"><i class="fas fa-envelope"></i> Contact</a>
    </nav>
    <button id="mbtn" onclick="document.getElementById('mmenu').style.display=document.getElementById('mmenu').style.display==='block'?'none':'block'"><i class="fas fa-bars"></i></button>
  </div>
  <div id="mmenu">
    <a href="../../index.html"><i class="fas fa-home fa-fw"></i> Home</a>
    <a href="../../index.html#tools"><i class="fas fa-tools fa-fw"></i> Tools</a>
    <a href="../../blog.html"><i class="fas fa-blog fa-fw"></i> Blog</a>
    <a href="../../resources.html"><i class="fas fa-book fa-fw"></i> Resources</a>
    <a href="../../tutorials.html"><i class="fas fa-chalkboard-teacher fa-fw"></i> Tutorials</a>
    <a href="../../comparisons.html"><i class="fas fa-balance-scale fa-fw"></i> Compare</a>
    <a href="../../contact.html"><i class="fas fa-envelope fa-fw"></i> Contact</a>
  </div>
</header>

<!-- BREADCRUMB -->
<div class="bc">
  <div class="bc-in">
    <a href="../../index.html"><i class="fas fa-home"></i></a>
    <i class="fas fa-chevron-right" style="font-size:10px"></i>
    <a href="../../index.html#tools">Tools</a>
    <i class="fas fa-chevron-right" style="font-size:10px"></i>
    <span style="color:#475569;font-weight:500">Word to PDF Converter</span>
  </div>
</div>

<!-- HERO -->
<section class="hero">
  <div class="hero-inner">
    <div class="hero-badge"><i class="fas fa-shield-alt"></i> 100% Free &amp; Secure ‚Äî Runs in Your Browser</div>
    <div class="hero-ic"><i class="fas fa-file-pdf"></i></div>
    <h1>Word to PDF Converter</h1>
    <p>Convert DOCX &amp; DOC files to PDF with page layout, breaks, and numbering fully preserved.</p>
    <div class="pills">
      <span class="pill"><i class="fas fa-check-circle"></i> Free</span>
      <span class="pill"><i class="fas fa-check-circle"></i> No Signup</span>
      <span class="pill"><i class="fas fa-check-circle"></i> Instant</span>
      <span class="pill"><i class="fas fa-check-circle"></i> Page Breaks</span>
      <span class="pill"><i class="fas fa-check-circle"></i> Page Numbers</span>
    </div>
  </div>
</section>

<!-- MAIN -->
<main>

  <!-- UPLOAD CARD -->
  <div class="card" id="uploadCard">
    <div class="card-title">
      <div class="cticon" style="background:#eff6ff;color:#2563eb"><i class="fas fa-cloud-upload-alt"></i></div>
      Upload Your Word Document
    </div>
    <div id="dz" class="dz">
      <div class="dz-ic"><i class="fas fa-file-word"></i></div>
      <h3>Drop your Word document here</h3>
      <p>or click to browse your files</p>
      <button class="btn btn-blue" type="button"><i class="fas fa-folder-open"></i> Choose File</button>
      <p class="dz-note">Supported: .docx, .doc &nbsp;¬∑&nbsp; Max size: 10 MB</p>
    </div>
    <input type="file" id="fileInput" accept=".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document" style="display:none">
    <div id="fileInfo">
      <div class="fi-left">
        <i class="fas fa-file-word" style="font-size:28px;color:#2563eb"></i>
        <div>
          <div class="fi-name" id="fileName">document.docx</div>
          <div class="fi-sub" id="fileSub">Ready to convert</div>
        </div>
      </div>
      <button class="fi-del" onclick="resetAll()" title="Remove"><i class="fas fa-times-circle"></i></button>
    </div>
  </div>

  <!-- PROCESSING CARD -->
  <div class="card" id="processing">
    <div class="proc-in">
      <div class="spinner"></div>
      <div class="proc-title">Converting to PDF‚Ä¶</div>
      <div class="proc-msg" id="procMsg">üìÑ Reading your document‚Ä¶</div>
      <div class="prog-bar"><div class="prog-fill" id="progFill"></div></div>
      <div class="prog-lbl" id="progLbl">0%</div>
    </div>
  </div>

  <!-- RESULTS -->
  <div id="results">
    <div class="card">
      <div class="ok-ic"><i class="fas fa-check-circle"></i></div>
      <div class="res-title">Conversion Complete!</div>
      <div class="res-sub">Your PDF is ready ‚Äî layout, breaks &amp; page numbers preserved</div>
      <div class="stats">
        <div class="stat">
          <div class="stat-ic" style="color:#2563eb"><i class="fas fa-file-alt"></i></div>
          <div class="stat-lbl">Total Pages</div>
          <div class="stat-val" id="pgCount">‚Äî</div>
        </div>
        <div class="stat">
          <div class="stat-ic" style="color:#7c3aed"><i class="fas fa-hdd"></i></div>
          <div class="stat-lbl">File Size</div>
          <div class="stat-val" id="fSize">‚Äî</div>
        </div>
      </div>
      <button class="btn btn-green" onclick="doDownload()"><i class="fas fa-download"></i> Download PDF</button>
      <button class="btn btn-gray" onclick="resetAll()"><i class="fas fa-redo"></i> Convert Another File</button>
    </div>

    <!-- PREVIEW CARD -->
    <div class="card">
      <div class="prev-hdr">
        <div class="card-title" style="margin-bottom:0">
          <div class="cticon" style="background:#eff6ff;color:#2563eb"><i class="fas fa-eye"></i></div>
          Document Preview
        </div>
        <div class="prev-tabs">
          <button class="ptab on" id="tabPage" onclick="showTab('page')"><i class="fas fa-file"></i> Page View</button>
          <button class="ptab" id="tabFlow" onclick="showTab('flow')"><i class="fas fa-align-left"></i> Flow View</button>
        </div>
      </div>
      <div id="pageView" class="pages-wrap"></div>
      <div id="flowView"></div>
    </div>
  </div>

  <!-- FEATURES -->
  <div class="feat-grid">
    <div class="feat">
      <div class="feat-ic" style="background:#eff6ff;color:#2563eb"><i class="fas fa-lock"></i></div>
      <h3>100% Secure</h3>
      <p>All conversion happens in your browser. Files never leave your device.</p>
    </div>
    <div class="feat">
      <div class="feat-ic" style="background:#f5f3ff;color:#7c3aed"><i class="fas fa-bolt"></i></div>
      <h3>Lightning Fast</h3>
      <p>Convert Word to PDF in seconds with our optimized engine.</p>
    </div>
    <div class="feat">
      <div class="feat-ic" style="background:#f0fdf4;color:#10b981"><i class="fas fa-palette"></i></div>
      <h3>Preserves Formatting</h3>
      <p>Fonts, images, tables, page breaks, and numbering ‚Äî all intact.</p>
    </div>
  </div>

  <!-- HOW IT WORKS -->
  <div class="card">
    <div class="card-title">
      <div class="cticon" style="background:#fef9c3;color:#d97706"><i class="fas fa-magic"></i></div>
      How It Works
    </div>
    <div class="steps">
      <div class="step"><div class="step-n" style="background:linear-gradient(135deg,#2563eb,#3b82f6)">1</div><h4>Upload</h4><p>Select your .docx or .doc file</p></div>
      <div class="step"><div class="step-n" style="background:linear-gradient(135deg,#7c3aed,#8b5cf6)">2</div><h4>Convert</h4><p>Page breaks detected automatically</p></div>
      <div class="step"><div class="step-n" style="background:linear-gradient(135deg,#f59e0b,#ef4444)">3</div><h4>Preview</h4><p>Review A4 paginated output</p></div>
      <div class="step"><div class="step-n" style="background:linear-gradient(135deg,#10b981,#059669)">4</div><h4>Download</h4><p>Save PDF with page numbers</p></div>
    </div>
  </div>

  <!-- FAQ -->
  <div class="card">
    <div class="card-title">
      <div class="cticon" style="background:#fef3c7;color:#d97706"><i class="fas fa-question-circle"></i></div>
      Frequently Asked Questions
    </div>
    <div class="faq"><div class="faq-q"><i class="fas fa-chevron-right"></i>Is this converter really free?</div><div class="faq-a">Yes! Completely free, no hidden charges or subscription.</div></div>
    <div class="faq"><div class="faq-q"><i class="fas fa-chevron-right"></i>Are my files safe?</div><div class="faq-a">Absolutely. Everything runs in your browser ‚Äî files are never uploaded to any server.</div></div>
    <div class="faq"><div class="faq-q"><i class="fas fa-chevron-right"></i>What formats are supported?</div><div class="faq-a">Both .docx (Word 2007+) and .doc (Word 97‚Äì2003) formats.</div></div>
    <div class="faq"><div class="faq-q"><i class="fas fa-chevron-right"></i>Is there a file size limit?</div><div class="faq-a">Maximum 10 MB for optimal browser-based performance.</div></div>
    <div class="faq"><div class="faq-q"><i class="fas fa-chevron-right"></i>Are page breaks and numbers preserved?</div><div class="faq-a">Yes. Our engine detects page-break markers and renders each A4 page with a page number at the bottom-right.</div></div>
  </div>

</main>

<!-- FOOTER -->
<footer>
  <div class="ft">
    <div class="ft-grid">
      <div class="ft-brand">
        <a href="../../index.html" class="logo" style="margin-bottom:8px">
          <div class="logo-ic"><i class="fas fa-tools"></i></div>
          <div><div class="logo-txt" style="color:#fff">Free Tools Hub</div><div class="logo-sub">Tools ¬∑ Blogs ¬∑ Resources</div></div>
        </a>
        <p>Your one-stop destination for free online tools, tutorials, and resources.</p>
        <div class="socials">
          <a href="#"><i class="fab fa-twitter"></i></a>
          <a href="#"><i class="fab fa-github"></i></a>
          <a href="#"><i class="fab fa-linkedin"></i></a>
        </div>
      </div>
      <div class="ft-col"><h4>Quick Links</h4><ul>
        <li><a href="../../index.html">Home</a></li>
        <li><a href="../../index.html#tools">All Tools</a></li>
        <li><a href="../../blog.html">Blog</a></li>
        <li><a href="../../contact.html">Contact</a></li>
      </ul></div>
      <div class="ft-col"><h4>Categories</h4><ul>
        <li><a href="../../index.html#tools">Utility Tools</a></li>
        <li><a href="../../resources.html">Resources</a></li>
        <li><a href="../../tutorials.html">Tutorials</a></li>
        <li><a href="../../comparisons.html">Compare</a></li>
      </ul></div>
      <div class="ft-col"><h4>Legal</h4><ul>
        <li><a href="#">Privacy Policy</a></li>
        <li><a href="#">Terms of Service</a></li>
        <li><a href="#">Cookie Policy</a></li>
      </ul></div>
    </div>
    <hr class="ft-hr">
    <div class="ft-bot">&copy; 2024 Free Tools Hub. All rights reserved. Made with <i class="fas fa-heart" style="color:#ef4444"></i> for developers.</div>
  </div>
</footer>

<script>
// ============================================================
//  STATE
// ============================================================
var currentFile = null;
var pdfBlob     = null;
var totalPages  = 0;

// ============================================================
//  SHOW / HIDE  (pure style.display, no CSS class dependency)
// ============================================================
function SN(id){ document.getElementById(id).style.display='none';   }
function SB(id){ document.getElementById(id).style.display='block';  }
function SF(id){ document.getElementById(id).style.display='flex';   }

// Initial state
SN('processing');
SN('results');
SN('fileInfo');   // <-- hides the "Ready to convert" bar until a file is chosen

// ============================================================
//  DROP ZONE  setup
// ============================================================
var dz = document.getElementById('dz');
var fi = document.getElementById('fileInput');

dz.addEventListener('click', function(){ fi.click(); });

dz.addEventListener('dragover',  function(e){ e.preventDefault(); dz.classList.add('drag'); });
dz.addEventListener('dragleave', function(){   dz.classList.remove('drag'); });
dz.addEventListener('drop',      function(e){
    e.preventDefault();
    dz.classList.remove('drag');
    if(e.dataTransfer.files[0]) handleFile(e.dataTransfer.files[0]);
});
fi.addEventListener('change', function(e){
    if(e.target.files[0]) handleFile(e.target.files[0]);
});

// ============================================================
//  RESET
// ============================================================
function resetAll(){
    currentFile = null; pdfBlob = null; totalPages = 0;
    fi.value = '';
    SN('fileInfo');
    SN('processing');
    SN('results');
    SB('uploadCard');
    window.scrollTo({top:0,behavior:'smooth'});
}

// ============================================================
//  PROGRESS helper
// ============================================================
function setP(pct, msg){
    document.getElementById('progFill').style.width = pct+'%';
    document.getElementById('progLbl').textContent  = pct+'%';
    if(msg) document.getElementById('procMsg').textContent = msg;
}

// ============================================================
//  STEP 1 ‚Äî validate & show UI
// ============================================================
function handleFile(file){
    var validTypes = [
        'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
        'application/msword'
    ];
    if(validTypes.indexOf(file.type)===-1 && !/\.(docx|doc)$/i.test(file.name)){
        alert('Please upload a valid Word document (.docx or .doc)');
        return;
    }
    if(file.size > 10*1024*1024){
        alert('File too large. Maximum size is 10 MB.');
        return;
    }

    currentFile = file;

    // Show file info bar
    document.getElementById('fileName').textContent = file.name;
    document.getElementById('fileSub').textContent  = fmtBytes(file.size)+' ‚Äî processing‚Ä¶';
    SF('fileInfo');

    // Show processing spinner, hide results
    SN('results');
    SB('processing');
    setP(5,'üìÑ Reading document‚Ä¶');

    // Yield to browser paint, then start
    setTimeout(function(){ runConversion(file); }, 150);
}

// ============================================================
//  STEP 2 ‚Äî read file & parse with mammoth
// ============================================================
function runConversion(file){
    var reader = new FileReader();

    reader.onerror = function(){
        SN('processing');
        alert('Could not read the file. Please try again.');
    };

    reader.onload = function(e){
        setP(20,'üìÑ Parsing Word document‚Ä¶');

        mammoth.convertToHtml({
            arrayBuffer: e.target.result,
            styleMap:[
                "p[style-name='Heading 1'] => h1:fresh",
                "p[style-name='Heading 2'] => h2:fresh",
                "p[style-name='Heading 3'] => h3:fresh",
                "p[style-name='Heading 4'] => h4:fresh",
                "p[style-name='Title']     => h1:fresh",
                "p[style-name='List Paragraph'] => li:fresh",
                "b => strong","i => em","u => u"
            ]
        }).then(function(result){

            var html = result.value;
            if(!html || html.trim()===''){
                throw new Error('No readable content found in the document.');
            }

            setP(40,'üîç Splitting into pages‚Ä¶');

            var pages = splitPages(html);
            totalPages = pages.length;

            // Build preview
            buildPreview(pages);
            document.getElementById('flowView').innerHTML = html;

            setP(55,'üñ®Ô∏è Rendering PDF‚Ä¶');

            // Small pause so preview renders, then build PDF
            setTimeout(function(){ buildPDF(pages); }, 200);

        }).catch(function(err){
            console.error('mammoth error',err);
            SN('processing');
            alert('Conversion error:\n'+err.message);
        });
    };

    reader.readAsArrayBuffer(file);
}

// ============================================================
//  splitPages ‚Äî HR ‚Üí empty paragraphs ‚Üí char count
// ============================================================
function splitPages(html){
    // 1. Explicit Word page-break ‚Üí mammoth emits <hr>
    var byHr = html.split(/<hr\s*\/?>/gi).map(function(s){return s.trim();}).filter(Boolean);
    if(byHr.length>1) return byHr;

    // 2. 3+ consecutive empty paras ‚Üí treat as page break
    var byEmp = html.split(/(?:<p[^>]*>\s*<\/p>\s*){3,}/gi).map(function(s){return s.trim();}).filter(Boolean);
    if(byEmp.length>1) return byEmp;

    // 3. Character-count bucket ~3500 chars/page
    var LIMIT=3500;
    var tmp=document.createElement('div');
    tmp.innerHTML=html;
    var kids=Array.from(tmp.childNodes);
    var pages=[],buf='',len=0;
    kids.forEach(function(n){
        var h=n.nodeType===1?n.outerHTML:'';
        var c=(n.textContent||'').length;
        if(len+c>LIMIT && len>0){pages.push(buf);buf='';len=0;}
        buf+=h; len+=c;
    });
    if(buf.trim()) pages.push(buf);
    return pages.length?pages:[html];
}

// ============================================================
//  buildPreview ‚Äî A4 pages with page numbers
// ============================================================
function buildPreview(pages){
    var wrap=document.getElementById('pageView');
    wrap.innerHTML='';
    pages.forEach(function(content,i){
        var pg=document.createElement('div');
        pg.className='a4';
        pg.innerHTML=content;
        var num=document.createElement('div');
        num.className='pgnum';
        num.textContent='Page '+(i+1)+' of '+pages.length;
        pg.appendChild(num);
        wrap.appendChild(pg);
    });
    document.getElementById('pgCount').textContent=pages.length;
}

// ============================================================
//  buildPDF ‚Äî renders each page with html2canvas ‚Üí jsPDF
// ============================================================
function buildPDF(pages){
    var jsPDF=window.jspdf.jsPDF;
    var A4W=794,A4H=1123,MARGIN=72,SCALE=2,PW=210,PH=297;

    var pdf=new jsPDF({orientation:'portrait',unit:'mm',format:'a4'});

    // Inject document styles
    var sty=document.createElement('style');
    sty.id='__ps';
    sty.textContent=[
        '#__pg{font-family:Calibri,"Times New Roman",serif;font-size:12pt;line-height:1.5;color:#000;word-break:break-word}',
        '#__pg p{margin:0 0 8pt}',
        '#__pg h1{font-size:20pt;font-weight:bold;margin:14pt 0 6pt}',
        '#__pg h2{font-size:16pt;font-weight:bold;margin:12pt 0 5pt}',
        '#__pg h3{font-size:13pt;font-weight:bold;margin:10pt 0 4pt}',
        '#__pg h4,#__pg h5,#__pg h6{font-size:12pt;font-weight:bold;margin:8pt 0 4pt}',
        '#__pg ul,#__pg ol{margin:0 0 8pt 24pt;padding:0}',
        '#__pg li{margin-bottom:4pt}',
        '#__pg table{width:100%;border-collapse:collapse;margin-bottom:10pt}',
        '#__pg td,#__pg th{border:1px solid #ccc;padding:4pt 6pt;font-size:11pt}',
        '#__pg strong,#__pg b{font-weight:bold}',
        '#__pg em,#__pg i{font-style:italic}',
        '#__pg u{text-decoration:underline}',
        '#__pg img{max-width:100%;height:auto}'
    ].join('');
    document.head.appendChild(sty);

    var idx=0;

    function doPage(){
        if(idx>=pages.length){
            // ---- ALL DONE ----
            document.head.removeChild(sty);
            pdfBlob=pdf.output('blob');
            document.getElementById('pgCount').textContent=pages.length;
            document.getElementById('fSize').textContent=fmtBytes(pdfBlob.size);
            setP(100,'‚úÖ Done!');
            setTimeout(function(){
                SN('processing');
                SB('results');
                document.getElementById('results').scrollIntoView({behavior:'smooth',block:'start'});
            },400);
            return;
        }

        var pct=55+Math.round(((idx+1)/pages.length)*43);
        setP(pct,'üñ®Ô∏è Rendering page '+(idx+1)+' of '+pages.length+'‚Ä¶');

        // Off-screen render div
        var div=document.createElement('div');
        div.id='__pg';
        div.style.cssText=[
            'position:fixed',
            'left:-9999px',
            'top:0',
            'width:'+A4W+'px',
            'min-height:'+A4H+'px',
            'background:#fff',
            'box-sizing:border-box',
            'padding:'+MARGIN+'px'
        ].join(';');
        div.innerHTML=pages[idx];
        document.body.appendChild(div);

        setTimeout(function(){
            html2canvas(div,{
                scale:SCALE,
                useCORS:true,
                allowTaint:true,
                logging:false,
                backgroundColor:'#ffffff',
                width:A4W,
                height:A4H,
                windowWidth:A4W
            }).then(function(canvas){
                if(document.body.contains(div)) document.body.removeChild(div);

                // Crop to exact A4 height
                var out=document.createElement('canvas');
                out.width=canvas.width;
                out.height=A4H*SCALE;
                var ctx=out.getContext('2d');
                ctx.fillStyle='#fff';
                ctx.fillRect(0,0,out.width,out.height);
                ctx.drawImage(canvas,0,0);

                var imgData=out.toDataURL('image/jpeg',0.88);
                if(idx>0) pdf.addPage();
                pdf.addImage(imgData,'JPEG',0,0,PW,PH);

                // Page number stamped as vector text
                pdf.setFont('helvetica','normal');
                pdf.setFontSize(8);
                pdf.setTextColor(140,140,140);
                var lbl='Page '+(idx+1)+' of '+pages.length;
                pdf.text(lbl, PW-12-pdf.getTextWidth(lbl), PH-7);

                idx++;
                setTimeout(doPage,60);

            }).catch(function(err){
                if(document.body.contains(div)) document.body.removeChild(div);
                if(document.head.contains(sty)) document.head.removeChild(sty);
                SN('processing');
                console.error(err);
                alert('PDF render error on page '+(idx+1)+':\n'+err.message);
            });
        },100);
    }

    doPage();
}

// ============================================================
//  DOWNLOAD
// ============================================================
function doDownload(){
    if(!pdfBlob){alert('No PDF ready.');return;}
    var url=URL.createObjectURL(pdfBlob);
    var a=document.createElement('a');
    a.href=url;
    a.download=currentFile.name.replace(/\.(docx|doc)$/i,'')+'.pdf';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    setTimeout(function(){URL.revokeObjectURL(url);},1500);
}

// ============================================================
//  PREVIEW TAB SWITCH
// ============================================================
function showTab(t){
    var pv=document.getElementById('pageView');
    var fv=document.getElementById('flowView');
    var tp=document.getElementById('tabPage');
    var tf=document.getElementById('tabFlow');
    if(t==='page'){
        pv.style.display=''; fv.style.display='none';
        tp.classList.add('on'); tf.classList.remove('on');
    } else {
        pv.style.display='none'; fv.style.display='';
        tf.classList.add('on'); tp.classList.remove('on');
    }
}

// ============================================================
//  UTILS
// ============================================================
function fmtBytes(b){
    if(!b) return '0 B';
    var k=1024,u=['B','KB','MB','GB'];
    var i=Math.floor(Math.log(b)/Math.log(k));
    return (b/Math.pow(k,i)).toFixed(2)+' '+u[i];
}
</script>
</body>
</html>
