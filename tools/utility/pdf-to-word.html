<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/WebPage">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="theme-color" content="#7c3aed">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3CEQJ2D9WY"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-3CEQJ2D9WY');</script>
    <title>PDF to Word Converter — Free Online PDF to DOCX | FreeToolsHub</title>
    <meta name="description" content="Convert PDF to Word (DOCX) instantly — free, no signup, no limits. Supports text, images & scanned PDFs. Paste images directly or drag & drop. Download editable Word file in seconds.">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://freetoolshub.online/tools/utility/pdf-to-word.html">
    <meta property="og:type" content="website">
    <meta property="og:title" content="PDF to Word Converter — Free, Fast & Accurate | FreeToolsHub">
    <meta property="og:description" content="Convert PDF to editable Word documents in seconds. Free online tool — no signup, no watermarks.">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../../style.css">
    <style>
        .tool-container { max-width: 900px; margin: 0 auto; padding: 40px 24px 80px; }
        /* Old preview section hidden — replaced by split panel */
        .preview-section { display: none !important; }
        /* Old text preview panel hidden — replaced by split panel */
        .text-preview-panel { display: none !important; }
        .breadcrumb { background: white; border-bottom: 1px solid var(--gray-200); padding: 12px 0; font-size: 13px; margin-bottom: 32px; }
        .breadcrumb-inner { display: flex; align-items: center; gap: 8px; color: var(--gray-500); flex-wrap: wrap; }
        .breadcrumb a { color: var(--gray-600); transition: var(--transition); }
        .breadcrumb a:hover { color: var(--purple-600); }
        .tool-header { text-align: center; margin-bottom: 48px; }
        .tool-badge { display: inline-flex; align-items: center; gap: 6px; background: linear-gradient(135deg, var(--purple-600), var(--fuchsia-500)); color: white; padding: 6px 14px; border-radius: var(--radius-full); font-size: 13px; font-weight: 600; margin-bottom: 16px; }
        .tool-header h1 { font-size: 2.5rem; color: var(--gray-900); margin-bottom: 12px; line-height: 1.2; }
        .tool-header p { font-size: 1.1rem; color: var(--gray-600); max-width: 600px; margin: 0 auto; }
        .converter-card { background: white; border-radius: var(--radius-xl); padding: 48px; box-shadow: var(--shadow-lg); border: 1px solid var(--gray-200); margin-bottom: 48px; }
        .upload-zone { border: 2px dashed var(--purple-300); border-radius: var(--radius-lg); padding: 48px 32px; text-align: center; background: var(--purple-50); transition: var(--transition); cursor: pointer; position: relative; }
        .upload-zone:hover { border-color: var(--purple-500); background: var(--purple-100); }
        .upload-zone.dragover { border-color: var(--purple-600); background: var(--purple-100); transform: scale(1.02); }
        .upload-zone.paste-active { border-color: #10b981; background: #ecfdf5; transform: scale(1.02); }
        .paste-hint { margin-top: 16px; display: flex; align-items: center; justify-content: center; gap: 8px; color: var(--gray-500); font-size: 13px; background: white; border: 1px dashed var(--gray-300); border-radius: var(--radius-md); padding: 10px 16px; }
        .paste-hint i { color: var(--purple-500); font-size: 16px; }
        .paste-hint kbd { background: var(--gray-100); border: 1px solid var(--gray-300); border-radius: 4px; padding: 1px 6px; font-size: 12px; font-family: monospace; color: var(--gray-700); }
        .paste-success { margin-top: 12px; color: #059669; font-weight: 600; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 6px; }
        .upload-icon { width: 64px; height: 64px; background: linear-gradient(135deg, var(--purple-600), var(--fuchsia-500)); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 28px; color: white; }
        .upload-zone h3 { color: var(--gray-900); margin-bottom: 8px; font-size: 1.3rem; }
        .upload-zone p { color: var(--gray-600); margin-bottom: 20px; }
        .file-input { display: none; }
        .btn-upload { display: inline-flex; align-items: center; gap: 8px; background: var(--purple-600); color: white; padding: 14px 28px; border-radius: var(--radius-md); font-weight: 600; border: none; cursor: pointer; transition: var(--transition); }
        .btn-upload:hover { background: var(--purple-700); transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .file-preview { display: none; background: var(--gray-100); border-radius: var(--radius-md); padding: 20px; margin-top: 24px; }
        .file-preview.active { display: block; }
        .file-info { display: flex; align-items: center; justify-content: space-between; gap: 16px; }
        .file-details { display: flex; align-items: center; gap: 12px; flex: 1; }
        .file-icon { width: 48px; height: 48px; background: var(--purple-600); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; color: white; font-size: 20px; }
        .file-meta h4 { color: var(--gray-900); font-size: 1rem; margin-bottom: 4px; }
        .file-meta p { color: var(--gray-500); font-size: 14px; }
        .btn-remove { background: var(--gray-200); color: var(--gray-700); border: none; padding: 8px 16px; border-radius: var(--radius-md); cursor: pointer; transition: var(--transition); }
        .btn-remove:hover { background: var(--gray-300); }
        .convert-section { display: none; text-align: center; margin-top: 32px; }
        .convert-section.active { display: block; }
        .btn-convert { display: inline-flex; align-items: center; gap: 10px; background: linear-gradient(135deg, var(--purple-600), var(--fuchsia-500)); color: white; padding: 16px 40px; border-radius: var(--radius-md); font-size: 1.1rem; font-weight: 600; border: none; cursor: pointer; transition: var(--transition); }
        .btn-convert:hover { transform: translateY(-3px); box-shadow: var(--shadow-xl); }
        .btn-convert:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .progress-section { display: none; margin-top: 32px; }
        .progress-section.active { display: block; }
        .progress-bar { height: 8px; background: var(--gray-200); border-radius: var(--radius-full); overflow: hidden; margin-bottom: 12px; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--purple-600), var(--fuchsia-500)); width: 0%; transition: width 0.3s ease; }
        .progress-text { text-align: center; color: var(--gray-600); font-size: 14px; }
        .download-section { display: none; text-align: center; margin-top: 32px; }
        .download-section.active { display: block; }
        .success-icon { width: 64px; height: 64px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 32px; color: white; animation: scaleIn 0.4s ease; }
        @keyframes scaleIn { from { transform: scale(0); } to { transform: scale(1); } }
        .download-section h3 { color: var(--gray-900); margin-bottom: 8px; }
        .download-section p { color: var(--gray-600); margin-bottom: 24px; }
        .download-btns { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; }
        .btn-download { display: inline-flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 14px 32px; border-radius: var(--radius-md); font-weight: 600; text-decoration: none; transition: var(--transition); border: none; cursor: pointer; font-size: 1rem; }
        .btn-download:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .btn-convert-another { display: inline-flex; align-items: center; gap: 8px; color: var(--purple-600); padding: 14px 24px; border-radius: var(--radius-md); font-weight: 600; transition: var(--transition); text-decoration: none; border: 2px solid var(--purple-200); background: white; cursor: pointer; font-size: 1rem; }
        .btn-convert-another:hover { background: var(--purple-50); border-color: var(--purple-400); }

        /* ═══════════════════════════════════════════════════
           SPLIT PANEL — Preview (Left) + Text (Right)
        ═══════════════════════════════════════════════════ */
        .split-panel {
            display: none;
            margin-top: 28px;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.09);
            border: 1.5px solid var(--gray-200);
            background: white;
        }
        .split-panel.active {
            display: grid;
            grid-template-columns: 1fr 1fr;
        }
        @media (max-width: 860px) {
            .split-panel.active { grid-template-columns: 1fr; }
            .split-left { border-right: none; border-bottom: 1.5px solid var(--gray-200); }
        }

        /* LEFT — Canvas Preview */
        .split-left {
            background: #f8f7ff;
            border-right: 1.5px solid var(--gray-200);
            display: flex;
            flex-direction: column;
        }
        .split-panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px;
            background: white;
            border-bottom: 1px solid var(--gray-200);
            flex-wrap: wrap;
            gap: 7px;
        }
        .split-panel-header h4 {
            margin: 0;
            font-size: 13px;
            font-weight: 600;
            color: var(--gray-700);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .split-panel-header h4 i { color: var(--purple-500); }
        .split-nav { display: flex; align-items: center; gap: 5px; }
        .split-nav-btn {
            background: var(--purple-600);
            color: white;
            border: none;
            width: 26px;
            height: 26px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            transition: var(--transition);
        }
        .split-nav-btn:hover:not(:disabled) { background: var(--purple-700); }
        .split-nav-btn:disabled { opacity: .35; cursor: not-allowed; }
        .split-page-badge {
            font-size: 11px;
            color: var(--gray-500);
            background: var(--gray-100);
            padding: 3px 9px;
            border-radius: 20px;
            min-width: 58px;
            text-align: center;
        }
        .split-zoom-row { display: flex; gap: 3px; }
        .split-zoom-btn {
            background: var(--gray-100);
            border: 1px solid var(--gray-300);
            color: var(--gray-600);
            width: 26px;
            height: 26px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            transition: var(--transition);
        }
        .split-zoom-btn:hover { background: var(--gray-200); }
        .split-canvas-wrap {
            flex: 1;
            padding: 14px;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            overflow: auto;
            min-height: 320px;
            max-height: 520px;
            background: repeating-linear-gradient(
                45deg,
                #f0edff 0px, #f0edff 1px,
                #f8f7ff 1px, #f8f7ff 18px
            );
        }
        #splitCanvas {
            max-width: 100%;
            height: auto;
            box-shadow: 0 3px 14px rgba(0,0,0,0.14);
            border-radius: 3px;
            background: white;
        }
        .split-footer {
            padding: 10px 14px;
            display: flex;
            gap: 6px;
            border-top: 1px solid var(--gray-200);
            background: white;
        }
        .split-footer-btn {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background: var(--gray-100);
            color: var(--gray-700);
            border: 1px solid var(--gray-300);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }
        .split-footer-btn:hover { background: var(--gray-200); }

        /* RIGHT — Extracted Text */
        .split-right { display: flex; flex-direction: column; min-height: 380px; }
        .split-right-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px;
            background: white;
            border-bottom: 1px solid var(--gray-200);
            flex-wrap: wrap;
            gap: 7px;
        }
        .split-right-header h4 {
            margin: 0;
            font-size: 13px;
            font-weight: 600;
            color: var(--gray-700);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .split-right-header h4 i { color: #10b981; }
        .split-text-actions { display: flex; gap: 5px; flex-wrap: wrap; }
        .split-text-btn {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 5px 10px;
            border-radius: 5px;
            border: 1px solid var(--gray-300);
            background: white;
            color: var(--gray-700);
            font-size: 11.5px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
        }
        .split-text-btn:hover { background: var(--gray-100); }
        .split-text-btn.btn-success { background: #d1fae5; border-color: #10b981; color: #065f46; }
        .split-text-btn.accent { background: var(--purple-600); border-color: var(--purple-600); color: white; }
        .split-text-btn.accent:hover { background: var(--purple-700); }
        .split-search-wrap {
            padding: 8px 12px;
            background: #fafafa;
            border-bottom: 1px solid var(--gray-200);
            display: none;
        }
        .split-search-wrap.active { display: block; }
        .split-search-wrap input {
            width: 100%;
            padding: 6px 10px;
            border: 1px solid var(--gray-300);
            border-radius: 5px;
            font-size: 13px;
            outline: none;
            background: white;
            box-sizing: border-box;
        }
        .split-search-wrap input:focus { border-color: var(--purple-400); box-shadow: 0 0 0 3px rgba(124,58,237,0.1); }
        .split-text-scroll {
            flex: 1;
            overflow-y: auto;
            max-height: 460px;
        }
        .split-text-page {
            padding: 14px 18px;
            border-bottom: 1px solid var(--gray-100);
        }
        .split-text-page:last-child { border-bottom: none; }
        .split-page-lbl {
            font-size: 10px;
            font-weight: 700;
            color: var(--purple-500);
            text-transform: uppercase;
            letter-spacing: .1em;
            margin-bottom: 7px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .split-page-lbl::after { content: ''; flex: 1; height: 1px; background: var(--purple-100); }
        .split-page-txt {
            font-family: 'DM Sans', sans-serif;
            font-size: 13px;
            line-height: 1.75;
            color: var(--gray-800);
            white-space: pre-wrap;
            word-break: break-word;
        }
        .split-page-txt.processing { color: var(--gray-400); font-style: italic; animation: sppulse 1.1s infinite; }
        @keyframes sppulse { 0%,100%{opacity:1} 50%{opacity:.35} }
        .split-empty {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 10px;
            color: var(--gray-400);
            padding: 40px 20px;
            text-align: center;
            min-height: 200px;
        }
        .split-empty i { font-size: 30px; color: var(--gray-300); }
        .split-empty p { margin: 0; font-size: 13px; line-height: 1.6; }
        .split-stats-bar {
            padding: 8px 15px;
            background: var(--gray-50);
            border-top: 1px solid var(--gray-200);
            font-size: 11.5px;
            color: var(--gray-500);
            display: flex;
            gap: 14px;
            flex-wrap: wrap;
        }
        .split-stat strong { color: var(--gray-700); }
        mark { background: #fef08a; padding: 0 2px; border-radius: 2px; }

        /* Feature cards / HowTo / FAQ / Related / SEO article */
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px; margin-bottom: 64px; }
        .feature-card { background: white; padding: 32px; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); text-align: center; transition: var(--transition); }
        .feature-card:hover { box-shadow: var(--shadow-md); transform: translateY(-4px); }
        .feature-icon { width: 56px; height: 56px; background: var(--purple-100); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; font-size: 24px; color: var(--purple-600); }
        .feature-card h3 { color: var(--gray-900); margin-bottom: 8px; font-size: 1.1rem; }
        .feature-card p { color: var(--gray-600); font-size: 15px; line-height: 1.6; }
        .how-it-works { background: var(--gray-100); padding: 64px 24px; margin: 64px -24px; }
        .how-it-works-inner { max-width: 900px; margin: 0 auto; }
        .section-title { text-align: center; font-size: 2rem; color: var(--gray-900); margin-bottom: 48px; }
        .steps-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 32px; }
        .step-card { text-align: center; }
        .step-number { width: 48px; height: 48px; background: linear-gradient(135deg, var(--purple-600), var(--fuchsia-500)); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3rem; font-weight: 700; margin: 0 auto 20px; }
        .step-card h3 { color: var(--gray-900); margin-bottom: 8px; font-size: 1.2rem; }
        .step-card p { color: var(--gray-600); line-height: 1.6; }
        .faq-section { margin-top: 64px; }
        .faq-item { background: white; border-radius: var(--radius-lg); padding: 24px 28px; margin-bottom: 16px; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); }
        .faq-question { display: flex; justify-content: space-between; align-items: center; cursor: pointer; gap: 16px; }
        .faq-question h3 { color: var(--gray-900); font-size: 1.1rem; font-weight: 600; }
        .faq-icon { color: var(--purple-600); font-size: 20px; transition: var(--transition); }
        .faq-item.active .faq-icon { transform: rotate(180deg); }
        .faq-answer { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; }
        .faq-item.active .faq-answer { max-height: 500px; margin-top: 16px; }
        .faq-answer p { color: var(--gray-600); line-height: 1.7; }
        .related-tools { margin-top: 64px; }
        .related-tools h2 { text-align: center; font-size: 2rem; color: var(--gray-900); margin-bottom: 40px; }
        .related-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; }
        .related-tool-card { background: white; border-radius: var(--radius-lg); padding: 28px; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); transition: var(--transition); display: flex; align-items: flex-start; gap: 16px; text-decoration: none; }
        .related-tool-card:hover { box-shadow: var(--shadow-md); transform: translateY(-4px); border-color: var(--purple-300); }
        .related-icon { width: 48px; height: 48px; background: var(--purple-100); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-size: 20px; color: var(--purple-600); flex-shrink: 0; }
        .related-content h3 { color: var(--gray-900); font-size: 1.05rem; margin-bottom: 6px; }
        .related-content p { color: var(--gray-600); font-size: 14px; line-height: 1.5; }
        .tool-badge-hot { display: inline-block; background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px; font-weight: 700; margin-left: 8px; vertical-align: middle; }
        .seo-article { background: white; border-radius: var(--radius-lg); padding: 40px 44px; margin-top: 64px; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); line-height: 1.8; }
        .seo-article h2 { color: var(--gray-900); font-size: 1.6rem; margin: 0 0 16px; }
        .seo-article h3 { color: var(--gray-900); font-size: 1.2rem; margin: 28px 0 10px; }
        .seo-article p { color: var(--gray-600); margin-bottom: 14px; font-size: 15.5px; }
        .seo-article ul { color: var(--gray-600); padding-left: 20px; margin-bottom: 14px; }
        .seo-article ul li { margin-bottom: 6px; font-size: 15.5px; }
        .seo-article strong { color: var(--gray-800); }
        @media (max-width: 768px) {
            .tool-header h1 { font-size: 1.8rem; }
            .converter-card { padding: 32px 24px; }
            .upload-zone { padding: 32px 20px; }
            .section-title { font-size: 1.6rem; }
            .how-it-works { padding: 48px 24px; margin: 48px -24px; }
            .file-info { flex-direction: column; align-items: flex-start; }
            .seo-article { padding: 28px 20px; }
            .split-text-actions { gap: 4px; }
        }
        @media (max-width: 480px) {
            .tool-container { padding: 24px 16px 60px; }
            .btn-download, .btn-convert-another { display: block; width: 100%; margin: 8px 0; }
            .split-panel-header, .split-right-header { gap: 5px; }
        }
    </style>
</head>
<body>

    <header class="site-header" id="siteHeader">
        <div class="container">
            <div class="header-inner">
                <a href="../../index.html" class="site-logo" aria-label="Free Tools Hub Home">
                    <div class="logo-icon"><i class="fas fa-bolt" aria-hidden="true"></i></div>
                    <div class="logo-text">
                        <span class="logo-name">Free Tools Hub</span>
                        <span class="logo-tagline">Tools · Blogs · Resources</span>
                    </div>
                </a>
                <nav class="main-nav" aria-label="Main navigation">
                    <a href="../../index.html"><i class="fas fa-home" aria-hidden="true"></i>Home</a>
                    <a href="../../tools.html" class="active"><i class="fas fa-tools" aria-hidden="true"></i>All Tools</a>
                    <a href="../../blog.html"><i class="fas fa-pen-nib" aria-hidden="true"></i>Blog</a>
                    <a href="../../news.html"><i class="fas fa-newspaper" aria-hidden="true"></i>News</a>
                    <a href="../../resources.html"><i class="fas fa-layer-group" aria-hidden="true"></i>Resources</a>
                    <a href="../../tutorials.html"><i class="fas fa-play-circle" aria-hidden="true"></i>Tutorials</a>
                    <a href="../../contact.html" class="nav-cta"><i class="fas fa-paper-plane" aria-hidden="true"></i>Contact</a>
                </nav>
                <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle navigation" aria-expanded="false">
                    <i class="fas fa-bars" aria-hidden="true"></i>
                </button>
            </div>
        </div>
        <nav class="mobile-nav" id="mobileMenu" aria-label="Mobile navigation">
            <a href="../../index.html"><i class="fas fa-home"></i>Home</a>
            <a href="../../tools.html" class="active"><i class="fas fa-tools"></i>All Tools</a>
            <a href="../../blog.html"><i class="fas fa-pen-nib"></i>Blog</a>
            <a href="../../news.html"><i class="fas fa-newspaper"></i>News</a>
            <a href="../../resources.html"><i class="fas fa-layer-group"></i>Resources</a>
            <a href="../../tutorials.html"><i class="fas fa-play-circle"></i>Tutorials</a>
            <a href="../../contact.html" class="nav-cta"><i class="fas fa-paper-plane"></i>Contact</a>
        </nav>
    </header>

    <div class="breadcrumb">
        <div class="container">
            <div class="breadcrumb-inner">
                <a href="../../index.html"><i class="fas fa-home"></i> Home</a>
                <span>/</span>
                <a href="../../tools.html">All Tools</a>
                <span>/</span>
                <span>PDF to Word Converter</span>
            </div>
        </div>
    </div>

    <main class="tool-container">
        <div class="tool-header">
            <div class="tool-badge"><i class="fas fa-fire"></i> HOT TOOL</div>
            <h1>PDF to Word Converter</h1>
            <p>Convert PDF files and images to editable Word documents instantly. Free, secure, and no signup required.</p>
        </div>

        <div class="converter-card">
            <!-- Upload Zone -->
            <div class="upload-zone" id="uploadZone">
                <div class="upload-icon"><i class="fas fa-file-pdf"></i></div>
                <h3>Drop your PDF or Image here or click to browse</h3>
                <p>Supports PDF files and images (JPG, PNG) up to 50MB</p>
                <button class="btn-upload" id="browseBtn">
                    <i class="fas fa-folder-open"></i> Choose PDF or Image File
                </button>
                <input type="file" id="fileInput" class="file-input" accept=".pdf,image/*">
                <div class="paste-hint" id="pasteHint">
                    <i class="fas fa-paste"></i>
                    <span>Or press <kbd>Ctrl+V</kbd> / <kbd>Cmd+V</kbd> — paste a copied image directly</span>
                </div>
                <div class="paste-success" id="pasteSuccess" style="display:none;">
                    <i class="fas fa-check-circle"></i> Image pasted! Click Convert to proceed.
                </div>
            </div>

            <!-- File info bar -->
            <div class="file-preview" id="filePreview">
                <div class="file-info">
                    <div class="file-details">
                        <div class="file-icon"><i class="fas fa-file-pdf" id="fileIconElement"></i></div>
                        <div class="file-meta">
                            <h4 id="fileName">document.pdf</h4>
                            <p id="fileSize">0 KB</p>
                        </div>
                    </div>
                    <button class="btn-remove" id="removeBtn"><i class="fas fa-times"></i> Remove</button>
                </div>
            </div>

            <!-- ═══════════════════════════════════════════════════
                 SPLIT PANEL — Left: Preview  |  Right: Text
            ═══════════════════════════════════════════════════ -->
            <div class="split-panel" id="splitPanel">

                <!-- LEFT: PDF / Image Preview -->
                <div class="split-left">
                    <div class="split-panel-header">
                        <h4><i class="fas fa-eye"></i> Original Preview</h4>
                        <div class="split-nav">
                            <button class="split-nav-btn" id="spPrevBtn" title="Previous page"><i class="fas fa-chevron-left"></i></button>
                            <span class="split-page-badge" id="spPageBadge">1 / 1</span>
                            <button class="split-nav-btn" id="spNextBtn" title="Next page"><i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div class="split-zoom-row">
                            <button class="split-zoom-btn" id="spZoomIn"    title="Zoom in"><i class="fas fa-plus"></i></button>
                            <button class="split-zoom-btn" id="spZoomOut"   title="Zoom out"><i class="fas fa-minus"></i></button>
                            <button class="split-zoom-btn" id="spZoomReset" title="Reset zoom"><i class="fas fa-compress-arrows-alt"></i></button>
                        </div>
                    </div>
                    <div class="split-canvas-wrap">
                        <canvas id="splitCanvas"></canvas>
                    </div>
                    <div class="split-footer">
                        <button class="split-footer-btn" id="spCopyImgBtn">
                            <i class="fas fa-copy"></i> Copy Page Image
                        </button>
                    </div>
                </div>

                <!-- RIGHT: Extracted Text -->
                <div class="split-right">
                    <div class="split-right-header">
                        <h4>
                            <i class="fas fa-align-left"></i>
                            Extracted Text
                            <span id="spPageCount" style="font-size:11px;font-weight:400;color:var(--gray-400);"></span>
                        </h4>
                        <div class="split-text-actions">
                            <button class="split-text-btn" id="spSearchBtn"><i class="fas fa-search"></i> Find</button>
                            <button class="split-text-btn" id="spCopyAllBtn"><i class="fas fa-copy"></i> Copy All</button>
                            <button class="split-text-btn accent" id="spSelectAllBtn"><i class="fas fa-mouse-pointer"></i> Select All</button>
                        </div>
                    </div>
                    <div class="split-search-wrap" id="spSearchWrap">
                        <input type="text" id="spSearchInput" placeholder="Search in extracted text..." autocomplete="off">
                    </div>
                    <div class="split-text-scroll" id="spTextScroll">
                        <div class="split-empty" id="spEmptyState">
                            <i class="fas fa-file-alt"></i>
                            <p>Extracted text will appear here<br>after you click <strong>Convert to Word</strong></p>
                        </div>
                    </div>
                    <div class="split-stats-bar" id="spStatsBar" style="display:none;">
                        <span class="split-stat"><strong id="spStatPages">0</strong> pages</span>
                        <span class="split-stat"><strong id="spStatWords">0</strong> words</span>
                        <span class="split-stat"><strong id="spStatChars">0</strong> chars</span>
                    </div>
                </div>

            </div>
            <!-- end .split-panel -->

            <!-- Convert button -->
            <div class="convert-section" id="convertSection">
                <button class="btn-convert" id="convertBtn">
                    <i class="fas fa-sync-alt"></i> Convert to Word
                </button>
            </div>

            <!-- Progress -->
            <div class="progress-section" id="progressSection">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-text" id="progressText">Converting... 0%</p>
            </div>

            <!-- Download -->
            <div class="download-section" id="downloadSection">
                <div class="success-icon"><i class="fas fa-check"></i></div>
                <h3>Conversion Complete!</h3>
                <p>Your Word document is ready — download it below</p>
                <div class="download-btns">
                    <button class="btn-download" id="downloadBtn">
                        <i class="fas fa-download"></i> Download Word (.docx)
                    </button>
                    <a href="#" class="btn-convert-another" id="convertAnotherBtn">
                        <i class="fas fa-redo"></i> Convert Another
                    </a>
                </div>
            </div>
        </div>
        <!-- end .converter-card -->

        <section class="features-grid" aria-label="Features">
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-columns"></i></div>
                <h3>Side-by-Side View</h3>
                <p>See your original PDF preview alongside the extracted text in real-time — before you even download.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-bolt"></i></div>
                <h3>Lightning Fast</h3>
                <p>Convert PDF to Word in seconds with our optimized in-browser engine — no waiting for server uploads.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
                <h3>100% Private & Secure</h3>
                <p>Your files never leave your device. All conversion happens locally in your browser — no cloud, no data risk.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-paste"></i></div>
                <h3>Paste Images (Ctrl+V)</h3>
                <p>Copy an image from any PDF reader and paste it directly into this tool with Ctrl+V — instant conversion.</p>
            </div>
        </section>

        <section class="how-it-works" aria-label="How to use">
            <div class="how-it-works-inner">
                <h2 class="section-title">How to Convert PDF to Word — 3 Easy Steps</h2>
                <div class="steps-grid">
                    <div class="step-card">
                        <div class="step-number">1</div>
                        <h3>Upload your PDF</h3>
                        <p>Select or drag & drop your PDF. You can also paste a copied image with <strong>Ctrl+V</strong>. A split preview appears instantly.</p>
                    </div>
                    <div class="step-card">
                        <div class="step-number">2</div>
                        <h3>Click Convert</h3>
                        <p>Press "Convert to Word" — text streams live into the right panel as each page is processed.</p>
                    </div>
                    <div class="step-card">
                        <div class="step-number">3</div>
                        <h3>Download DOCX</h3>
                        <p>Download your editable .docx file. Copy text directly from the preview panel if needed.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="faq-section">
            <h2 class="section-title">Frequently Asked Questions</h2>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <h3>Is this PDF to Word converter really free?</h3>
                    <i class="fas fa-chevron-down faq-icon"></i>
                </div>
                <div class="faq-answer"><p>Yes! 100% free with no hidden costs. Convert unlimited files without any signup or subscription.</p></div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <h3>What file size can I convert?</h3>
                    <i class="fas fa-chevron-down faq-icon"></i>
                </div>
                <div class="faq-answer"><p>You can convert PDF files up to 50MB. Sufficient for most documents including those with images and complex formatting.</p></div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <h3>Are my files secure and private?</h3>
                    <i class="fas fa-chevron-down faq-icon"></i>
                </div>
                <div class="faq-answer"><p>Absolutely! All conversion happens inside your browser. Files are never uploaded to any server — complete privacy.</p></div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <h3>Will the formatting be preserved?</h3>
                    <i class="fas fa-chevron-down faq-icon"></i>
                </div>
                <div class="faq-answer"><p>Our converter maintains the original formatting and layout. Complex multi-column PDFs may need minor touch-ups in Word.</p></div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <h3>Can I convert scanned PDFs?</h3>
                    <i class="fas fa-chevron-down faq-icon"></i>
                </div>
                <div class="faq-answer"><p>Yes! You can also copy a scanned page as an image and paste it (Ctrl+V) for best fidelity.</p></div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <h3>Do I need to install any software?</h3>
                    <i class="fas fa-chevron-down faq-icon"></i>
                </div>
                <div class="faq-answer"><p>No installation required! Works entirely in your browser. Upload, convert, download — done.</p></div>
            </div>
        </section>

        <section class="related-tools">
            <h2>Related PDF Tools</h2>
            <div class="related-grid">
                <a href="word-to-pdf-converter.html" class="related-tool-card">
                    <div class="related-icon"><i class="fas fa-file-pdf"></i></div>
                    <div class="related-content"><h3>Word to PDF <span class="tool-badge-hot">HOT</span></h3><p>Convert Word documents to PDF format instantly</p></div>
                </a>
                <a href="pdf-to-jpg.html" class="related-tool-card">
                    <div class="related-icon"><i class="fas fa-file-image"></i></div>
                    <div class="related-content"><h3>PDF to JPG <span class="tool-badge-hot">HOT</span></h3><p>Convert PDF pages to high-quality JPG images</p></div>
                </a>
                <a href="jpg-to-pdf.html" class="related-tool-card">
                    <div class="related-icon"><i class="fas fa-images"></i></div>
                    <div class="related-content"><h3>JPG to PDF <span class="tool-badge-hot">HOT</span></h3><p>Convert images to PDF documents quickly</p></div>
                </a>
                <a href="rotate-pdf-pages.html" class="related-tool-card">
                    <div class="related-icon"><i class="fas fa-sync-alt"></i></div>
                    <div class="related-content"><h3>Rotate PDF Pages</h3><p>Rotate pages in your PDF documents</p></div>
                </a>
                <a href="reorder-pdf-pages.html" class="related-tool-card">
                    <div class="related-icon"><i class="fas fa-sort"></i></div>
                    <div class="related-content"><h3>Re-arrange PDF Pages</h3><p>Reorder pages in your PDF files easily</p></div>
                </a>
                <a href="pdf-pages-delete.html" class="related-tool-card">
                    <div class="related-icon"><i class="fas fa-trash-alt"></i></div>
                    <div class="related-content"><h3>Delete PDF Pages</h3><p>Remove unwanted pages from your PDFs</p></div>
                </a>
            </div>
        </section>

        <article class="seo-article">
            <h2>PDF to Word Converter — Complete Guide</h2>
            <p>Our <strong>free PDF to Word converter</strong> lets you transform any PDF document into a fully editable <strong>Microsoft Word (.docx) file</strong> — directly in your browser, with no signup, no installation, and no file size tricks. The new <strong>split-panel view</strong> shows your original PDF on the left and the extracted text on the right simultaneously, so you can verify accuracy before downloading.</p>
            <h3>Why Convert PDF to Word?</h3>
            <p>PDF files are great for sharing, but locked for editing. Converting to Word gives you full editing power — update contracts, edit reports, reformat resumes, or repurpose any PDF into a live Word file compatible with Microsoft Word, Google Docs, and LibreOffice.</p>
            <h3>What Makes This Tool Different?</h3>
            <ul>
                <li><strong>Live split-panel preview</strong> — See the original page alongside extracted text in real-time during conversion.</li>
                <li><strong>Page-by-page layout preservation</strong> — Each PDF page becomes a separate Word page with correct page breaks.</li>
                <li><strong>Clipboard paste (Ctrl+V)</strong> — Open any PDF, copy an image, paste it directly into this tool.</li>
                <li><strong>100% browser-based</strong> — Files never leave your device. No server upload, no privacy risk.</li>
                <li><strong>No watermarks</strong> — The converted Word file is clean.</li>
            </ul>
            <h3>Tips for Best Results</h3>
            <ul>
                <li>For <strong>text-heavy PDFs</strong>: conversion preserves line-by-line structure. Check the right panel to verify text quality before downloading.</li>
                <li>For <strong>image-only or scanned PDFs</strong>: use the clipboard paste feature — copy the scan as an image and paste it.</li>
                <li>For <strong>large PDFs</strong> (50+ pages): text streams in live on the right as each page is processed.</li>
                <li>Use the <strong>Find</strong> button in the text panel to search for specific content before downloading.</li>
            </ul>
        </article>
    </main>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <div class="site-logo">
                        <div class="logo-icon"><i class="fas fa-bolt"></i></div>
                        <div class="logo-text"><span class="logo-name">Free Tools Hub</span></div>
                    </div>
                    <p>Your complete hub for free tools, expert blogs, tech news, curated resources, and tutorials.</p>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="../../index.html">Home</a></li>
                        <li><a href="../../tools.html">All Tools</a></li>
                        <li><a href="../../blog.html">Blog</a></li>
                        <li><a href="../../contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="../../privacy.html">Privacy Policy</a></li>
                        <li><a href="../../terms.html">Terms of Service</a></li>
                        <li><a href="../../disclaimer.html">Disclaimer</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 <a href="../../index.html">Free Tools Hub</a>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        // Header scroll
        const header = document.getElementById('siteHeader');
        window.addEventListener('scroll', () => header.classList.toggle('scrolled', window.scrollY > 20), { passive: true });

        // Mobile menu
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenu    = document.getElementById('mobileMenu');
        mobileMenuBtn.addEventListener('click', () => {
            const isOpen = mobileMenu.classList.toggle('open');
            mobileMenuBtn.setAttribute('aria-expanded', isOpen);
            mobileMenuBtn.innerHTML = isOpen ? '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
        });
        mobileMenu.querySelectorAll('a').forEach(l => l.addEventListener('click', () => {
            mobileMenu.classList.remove('open');
            mobileMenuBtn.setAttribute('aria-expanded', 'false');
            mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
        }));

        function toggleFaq(el) {
            const item = el.parentElement;
            const wasActive = item.classList.contains('active');
            document.querySelectorAll('.faq-item').forEach(i => i.classList.remove('active'));
            if (!wasActive) item.classList.add('active');
        }

        // ── DOM refs ──────────────────────────────────────────────────
        const uploadZone      = document.getElementById('uploadZone');
        const fileInput       = document.getElementById('fileInput');
        const browseBtn       = document.getElementById('browseBtn');
        const filePreview     = document.getElementById('filePreview');
        const convertSection  = document.getElementById('convertSection');
        const progressSection = document.getElementById('progressSection');
        const downloadSection = document.getElementById('downloadSection');
        const convertBtn      = document.getElementById('convertBtn');
        const removeBtn       = document.getElementById('removeBtn');
        const downloadBtn     = document.getElementById('downloadBtn');
        const convertAnotherBtn = document.getElementById('convertAnotherBtn');
        const fileNameEl      = document.getElementById('fileName');
        const fileSizeEl      = document.getElementById('fileSize');
        const fileIconEl      = document.getElementById('fileIconElement');
        const progressFill    = document.getElementById('progressFill');
        const progressText    = document.getElementById('progressText');
        const pasteHint       = document.getElementById('pasteHint');
        const pasteSuccess    = document.getElementById('pasteSuccess');

        // ── SPLIT PANEL refs ─────────────────────────────────────────
        const splitPanel     = document.getElementById('splitPanel');
        const splitCanvas    = document.getElementById('splitCanvas');
        const spCtx          = splitCanvas.getContext('2d');
        const spPrevBtn      = document.getElementById('spPrevBtn');
        const spNextBtn      = document.getElementById('spNextBtn');
        const spPageBadge    = document.getElementById('spPageBadge');
        const spZoomIn       = document.getElementById('spZoomIn');
        const spZoomOut      = document.getElementById('spZoomOut');
        const spZoomReset    = document.getElementById('spZoomReset');
        const spCopyImgBtn   = document.getElementById('spCopyImgBtn');
        const spTextScroll   = document.getElementById('spTextScroll');
        const spPageCount    = document.getElementById('spPageCount');
        const spCopyAllBtn   = document.getElementById('spCopyAllBtn');
        const spSelectAllBtn = document.getElementById('spSelectAllBtn');
        const spSearchBtn    = document.getElementById('spSearchBtn');
        const spSearchWrap   = document.getElementById('spSearchWrap');
        const spSearchInput  = document.getElementById('spSearchInput');
        const spStatsBar     = document.getElementById('spStatsBar');
        const spStatPages    = document.getElementById('spStatPages');
        const spStatWords    = document.getElementById('spStatWords');
        const spStatChars    = document.getElementById('spStatChars');

        // ── State ─────────────────────────────────────────────────────
        let selectedFile = null;
        let spPdfDoc = null, spImg = null;
        let spPage = 1, spTotal = 1, spScale = 1.5, spIsImg = false;
        let extractedPages = [];

        // ── Upload / Drag / Paste ─────────────────────────────────────
        browseBtn.addEventListener('click', e => { e.stopPropagation(); fileInput.click(); });
        uploadZone.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', e => { if (e.target.files[0]) pickFile(e.target.files[0]); });
        uploadZone.addEventListener('dragover',  e => { e.preventDefault(); uploadZone.classList.add('dragover'); });
        uploadZone.addEventListener('dragleave', () => uploadZone.classList.remove('dragover'));
        uploadZone.addEventListener('drop', e => {
            e.preventDefault(); uploadZone.classList.remove('dragover');
            if (e.dataTransfer.files[0]) pickFile(e.dataTransfer.files[0]);
        });
        document.addEventListener('paste', async e => {
            if (uploadZone.style.display === 'none') return;
            const imgItem = [...(e.clipboardData || window.clipboardData).items].find(i => i.type.startsWith('image/'));
            if (!imgItem) return;
            e.preventDefault();
            uploadZone.classList.add('paste-active');
            pasteSuccess.style.display = 'flex';
            pasteHint.style.display    = 'none';
            const blob = imgItem.getAsFile();
            const f = new File([blob], 'pasted-image.png', { type: blob.type || 'image/png' });
            setTimeout(async () => { uploadZone.classList.remove('paste-active'); await pickFile(f); }, 350);
        });

        function pickFile(f) {
            if (f.type === 'application/pdf' || f.type.startsWith('image/')) {
                handleFile(f);
            } else {
                alert('Please select a PDF or image file (JPG, PNG)');
            }
        }

        async function handleFile(file) {
            selectedFile = file;
            spIsImg = file.type.startsWith('image/');
            fileNameEl.textContent = file.name;
            fileSizeEl.textContent = fmtSize(file.size);
            fileIconEl.className   = spIsImg ? 'fas fa-file-image' : 'fas fa-file-pdf';
            filePreview.classList.add('active');
            convertSection.classList.add('active');
            uploadZone.style.display = 'none';

            // Show split panel and render preview
            splitPanel.classList.add('active');
            if (spIsImg) await spLoadImage(file);
            else         await spLoadPdf(file);
            spUpdateNav();
        }

        // ── SPLIT PANEL — Preview Logic ───────────────────────────────
        async function spLoadPdf(file) {
            spPdfDoc = await pdfjsLib.getDocument({ data: await file.arrayBuffer() }).promise;
            spTotal  = spPdfDoc.numPages;
            spPage   = 1; spScale = 1.5;
            spPageCount.textContent = `· ${spTotal} pages`;
            await spRenderPdfPage(spPage);
        }

        async function spLoadImage(file) {
            return new Promise((res, rej) => {
                const r = new FileReader();
                r.onload = ev => {
                    const img = new Image();
                    img.onload = () => { spImg = img; spTotal = 1; spPage = 1; spRenderImg(); res(); };
                    img.onerror = rej;
                    img.src = ev.target.result;
                };
                r.onerror = rej;
                r.readAsDataURL(file);
            });
        }

        async function spRenderPdfPage(n) {
            if (!spPdfDoc) return;
            const page = await spPdfDoc.getPage(n);
            const vp = page.getViewport({ scale: spScale });
            splitCanvas.width  = vp.width;
            splitCanvas.height = vp.height;
            await page.render({ canvasContext: spCtx, viewport: vp }).promise;
        }

        function spRenderImg() {
            if (!spImg) return;
            const maxW = 700;
            let w = spImg.width * spScale, h = spImg.height * spScale;
            if (w > maxW) { h *= maxW / w; w = maxW; }
            splitCanvas.width  = w;
            splitCanvas.height = h;
            spCtx.clearRect(0, 0, w, h);
            spCtx.drawImage(spImg, 0, 0, w, h);
        }

        function spUpdateNav() {
            spPageBadge.textContent = `${spPage} / ${spTotal}`;
            spPrevBtn.disabled = spPage <= 1;
            spNextBtn.disabled = spPage >= spTotal;
            const show = !spIsImg && spTotal > 1;
            spPrevBtn.style.display = show ? 'flex' : 'none';
            spNextBtn.style.display = show ? 'flex' : 'none';
        }

        spPrevBtn.addEventListener('click', async () => {
            if (spPage > 1) { spPage--; await spRenderPdfPage(spPage); spUpdateNav(); }
        });
        spNextBtn.addEventListener('click', async () => {
            if (spPage < spTotal) { spPage++; await spRenderPdfPage(spPage); spUpdateNav(); }
        });
        spZoomIn.addEventListener('click',    async () => { spScale = Math.min(3, spScale + .25); spIsImg ? spRenderImg() : await spRenderPdfPage(spPage); });
        spZoomOut.addEventListener('click',   async () => { spScale = Math.max(.4, spScale - .25); spIsImg ? spRenderImg() : await spRenderPdfPage(spPage); });
        spZoomReset.addEventListener('click', async () => { spScale = 1.5; spIsImg ? spRenderImg() : await spRenderPdfPage(spPage); });

        spCopyImgBtn.addEventListener('click', async () => {
            try {
                const blob = await new Promise(r => splitCanvas.toBlob(r, 'image/png'));
                await navigator.clipboard.write([new ClipboardItem({'image/png': blob})]);
                const orig = spCopyImgBtn.innerHTML;
                spCopyImgBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                spCopyImgBtn.style.background = '#d1fae5';
                setTimeout(() => { spCopyImgBtn.innerHTML = orig; spCopyImgBtn.style.background = ''; }, 2000);
            } catch(e) { alert('Copy failed. Use a screenshot tool instead.'); }
        });

        // ── SPLIT PANEL — Text Panel Logic ────────────────────────────

        // Called live during conversion to stream text page-by-page
        function spAddPageText(pageIndex, lines, isProcessing = false) {
            // Hide empty state on first result
            const emptyEl = spTextScroll.querySelector('.split-empty');
            if (emptyEl) emptyEl.remove();

            let block = spTextScroll.querySelector(`[data-sp-page="${pageIndex}"]`);
            if (!block) {
                block = document.createElement('div');
                block.className = 'split-text-page';
                block.dataset.spPage = pageIndex;

                const lbl = document.createElement('div');
                lbl.className = 'split-page-lbl';
                lbl.textContent = `Page ${pageIndex + 1}`;

                const txt = document.createElement('div');
                txt.className = 'split-page-txt';
                txt.dataset.spTxt = '';

                block.appendChild(lbl);
                block.appendChild(txt);
                spTextScroll.appendChild(block);
            }

            const txt = block.querySelector('[data-sp-txt]');
            if (isProcessing) {
                txt.className = 'split-page-txt processing';
                txt.textContent = 'Extracting…';
            } else {
                txt.className = 'split-page-txt';
                if (lines.length) {
                    txt.textContent = lines.join('\n');
                    txt.style.color = '';
                    txt.style.fontStyle = '';
                } else {
                    txt.textContent = '(No extractable text on this page)';
                    txt.style.color = 'var(--gray-400)';
                    txt.style.fontStyle = 'italic';
                }
            }
            // auto-scroll
            spTextScroll.scrollTop = spTextScroll.scrollHeight;
        }

        function spFinalizePanel(pages) {
            extractedPages = pages;
            const textPages = pages.filter(p => p.lines && p.lines.length > 0);
            const allText   = textPages.map(p => p.lines.join(' ')).join(' ');
            const words     = allText.trim() ? allText.trim().split(/\s+/).length : 0;
            const chars     = allText.length;

            spStatPages.textContent = textPages.length;
            spStatWords.textContent = words.toLocaleString();
            spStatChars.textContent = chars.toLocaleString();
            spStatsBar.style.display = 'flex';

            if (textPages.length === 0) {
                spTextScroll.innerHTML = `
                    <div class="split-empty">
                        <i class="fas fa-image"></i>
                        <p>No extractable text found<br>(image-only or scanned PDF)</p>
                    </div>`;
            }
        }

        // Copy All
        spCopyAllBtn.addEventListener('click', async () => {
            const text = extractedPages
                .filter(p => p.lines && p.lines.length)
                .map((p, i) => `--- Page ${i + 1} ---\n${p.lines.join('\n')}`)
                .join('\n\n');
            if (!text.trim()) { alert('No text to copy.'); return; }
            try {
                await navigator.clipboard.writeText(text);
                spFlashBtn(spCopyAllBtn, '<i class="fas fa-check"></i> Copied!');
            } catch(e) { alert('Copy failed. Use Select All then Ctrl+C.'); }
        });

        // Select All
        spSelectAllBtn.addEventListener('click', () => {
            const range = document.createRange();
            range.selectNodeContents(spTextScroll);
            const sel = window.getSelection();
            sel.removeAllRanges();
            sel.addRange(range);
            spFlashBtn(spSelectAllBtn, '<i class="fas fa-check"></i> Selected!');
        });

        // Search/Find
        spSearchBtn.addEventListener('click', () => {
            const open = spSearchWrap.classList.toggle('active');
            spSearchBtn.innerHTML = open ? '<i class="fas fa-times"></i> Close' : '<i class="fas fa-search"></i> Find';
            if (open) { spSearchInput.focus(); spSearchInput.value = ''; }
            else       { spClearHighlights(); }
        });
        spSearchInput.addEventListener('input', () => {
            spClearHighlights();
            const q = spSearchInput.value.trim();
            if (q.length < 2) return;
            const esc = q.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            const re  = new RegExp(`(${esc})`, 'gi');
            let first = null;
            spTextScroll.querySelectorAll('.split-page-txt').forEach(el => {
                const orig = el.textContent;
                if (re.test(orig)) {
                    el.innerHTML = orig.replace(re, '<mark>$1</mark>');
                    if (!first) first = el.querySelector('mark');
                }
            });
            if (first) first.scrollIntoView({ behavior: 'smooth', block: 'center' });
        });
        function spClearHighlights() {
            spTextScroll.querySelectorAll('.split-page-txt').forEach((el, i) => {
                if (el.querySelector('mark')) {
                    const pg = extractedPages[i];
                    el.textContent = (pg && pg.lines.length) ? pg.lines.join('\n') : '(No extractable text on this page)';
                }
            });
        }
        function spFlashBtn(btn, html) {
            const orig = btn.innerHTML, origCls = btn.className;
            btn.innerHTML = html; btn.classList.add('btn-success');
            setTimeout(() => { btn.innerHTML = orig; btn.className = origCls; }, 2000);
        }

        // ── Remove / Reset ────────────────────────────────────────────
        removeBtn.addEventListener('click', resetAll);
        convertAnotherBtn.addEventListener('click', e => { e.preventDefault(); resetAll(); });

        // ── Convert ───────────────────────────────────────────────────
        convertBtn.addEventListener('click', async () => {
            if (!selectedFile) return;
            convertBtn.disabled = true;
            convertSection.style.display = 'none';
            progressSection.classList.add('active');
            try {
                await doConvert(selectedFile);
            } catch(err) {
                console.error('Conversion error:', err);
                alert('Conversion failed: ' + (err.message || err));
                resetAll();
            }
        });

        async function doConvert(file) {
            setProgress(5, 'Starting...');
            let pages = [];

            if (spIsImg) {
                setProgress(20, 'Reading image...');
                const b64 = await fileToBase64(file);
                pages.push({ lines: [], imgB64: b64 });
                // Show "image" state on right panel
                spAddPageText(0, [], false);
            } else {
                setProgress(15, 'Loading PDF...');
                const pdf = await pdfjsLib.getDocument({ data: await file.arrayBuffer() }).promise;

                for (let p = 1; p <= pdf.numPages; p++) {
                    // Show processing state for this page
                    spAddPageText(p - 1, [], true);

                    const page = await pdf.getPage(p);
                    const vp   = page.getViewport({ scale: 1 });
                    const pgH  = vp.height;
                    const tc   = await page.getTextContent({ includeMarkedContent: false });

                    // sort items top→bottom, left→right
                    const items = tc.items
                        .filter(it => it.str)
                        .map(it => ({ str: it.str, x: it.transform[4], y: pgH - it.transform[5] }))
                        .sort((a, b) => a.y - b.y || a.x - b.x);

                    const groups = [];
                    let cur = null;
                    for (const it of items) {
                        if (!cur || Math.abs(it.y - cur.y) > 6) { cur = { y: it.y, parts: [] }; groups.push(cur); }
                        cur.parts.push(it);
                    }
                    const lines = groups
                        .map(g => g.parts.sort((a, b) => a.x - b.x).map(i => i.str).join(' ').trimEnd())
                        .filter(l => l.trim());

                    pages.push({ lines, imgB64: null });

                    // ✅ Stream text into right panel live
                    spAddPageText(p - 1, lines, false);

                    const pct = 15 + Math.round((p / pdf.numPages) * 65);
                    setProgress(pct, `Extracting page ${p} of ${pdf.numPages}...`);
                }
            }

            setProgress(82, 'Building Word document...');
            const blob = await buildDocx(pages);
            setProgress(100, 'Done!');
            await new Promise(r => setTimeout(r, 300));

            // Finalize text panel stats
            spFinalizePanel(pages);

            progressSection.classList.remove('active');
            downloadSection.classList.add('active');

            const outName = file.name.replace(/\.[^/.]+$/, '') + '.docx';
            downloadBtn.onclick = () => saveAs(blob, outName);
        }

        // ── DOCX builder (unchanged) ──────────────────────────────────
        async function buildDocx(pages) {
            let bodyXml = '';
            for (let pi = 0; pi < pages.length; pi++) {
                const page = pages[pi];
                if (pi > 0) bodyXml += `<w:p><w:r><w:br w:type="page"/></w:r></w:p>`;
                if (page.imgB64) bodyXml += `<!-- IMG_${pi} -->`;
                for (const line of page.lines) {
                    const escaped = escXml(line);
                    bodyXml += `<w:p><w:pPr><w:spacing w:line="276" w:lineRule="auto" w:before="0" w:after="0"/></w:pPr><w:r><w:rPr><w:rFonts w:ascii="Calibri" w:hAnsi="Calibri"/><w:sz w:val="24"/><w:szCs w:val="24"/></w:rPr><w:t xml:space="preserve">${escaped}</w:t></w:r></w:p>`;
                }
                if (!page.imgB64 && page.lines.length === 0) {
                    bodyXml += `<w:p><w:pPr><w:spacing w:before="0" w:after="0"/></w:pPr></w:p>`;
                }
            }
            bodyXml += `<w:p><w:pPr><w:spacing w:before="240" w:after="0"/><w:jc w:val="center"/></w:pPr><w:r><w:rPr><w:rFonts w:ascii="Calibri" w:hAnsi="Calibri"/><w:sz w:val="14"/><w:szCs w:val="14"/><w:color w:val="CCCCCC"/><w:i/></w:rPr><w:t>freetoolshub.online</w:t></w:r></w:p>`;

            const imageFiles = [], relationships = [];
            for (let pi = 0; pi < pages.length; pi++) {
                const page = pages[pi];
                if (!page.imgB64) continue;
                const b64   = page.imgB64.split(',')[1];
                const mime  = page.imgB64.split(';')[0].split(':')[1];
                const ext   = mime.includes('png') ? 'png' : 'jpeg';
                const bytes = b64ToBytes(b64);
                const rId   = `rId${pi + 10}`;
                const fname = `image${pi}.${ext}`;
                imageFiles.push({ rId, filename: fname, mime, bytes });
                relationships.push(`<Relationship Id="${rId}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="media/${fname}"/>`);
                const imgW = 5486400, imgH = 7315200;
                const imgXml = `<w:p><w:r><w:rPr/><w:drawing><wp:inline distT="0" distB="0" distL="0" distR="0" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"><wp:extent cx="${imgW}" cy="${imgH}"/><wp:effectExtent l="0" t="0" r="0" b="0"/><wp:docPr id="${pi+1}" name="Image${pi+1}"/><wp:cNvGraphicFramePr><a:graphicFrameLocks xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" noChangeAspect="1"/></wp:cNvGraphicFramePr><a:graphic xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:nvPicPr><pic:cNvPr id="${pi+1}" name="Image${pi+1}"/><pic:cNvPicPr><a:picLocks noChangeAspect="1" noChangeArrowheads="1"/></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="${rId}" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/><a:stretch><a:fillRect/></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0"/><a:ext cx="${imgW}" cy="${imgH}"/></a:xfrm><a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p>`;
                bodyXml = bodyXml.replace(`<!-- IMG_${pi} -->`, imgXml);
            }

            const docXml = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?><w:document xmlns:wpc="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:w14="http://schemas.microsoft.com/office/word/2010/wordml" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" mc:Ignorable="w14" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"><w:body>${bodyXml}<w:sectPr><w:pgSz w:w="12240" w:h="15840"/><w:pgMar w:top="1440" w:right="1440" w:bottom="1440" w:left="1440" w:header="720" w:footer="720" w:gutter="0"/></w:sectPr></w:body></w:document>`;
            const relsXml = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>${relationships.join('')}</Relationships>`;
            const stylesXml = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?><w:styles xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main"><w:docDefaults><w:rPrDefault><w:rPr><w:rFonts w:ascii="Calibri" w:eastAsia="Calibri" w:hAnsi="Calibri" w:cs="Calibri"/><w:sz w:val="24"/><w:szCs w:val="24"/></w:rPr></w:rPrDefault></w:docDefaults><w:style w:type="paragraph" w:default="1" w:styleId="Normal"><w:name w:val="Normal"/><w:pPr><w:spacing w:after="0" w:line="276" w:lineRule="auto"/></w:pPr></w:style></w:styles>`;
            const appXml = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"><Application>FreeToolsHub PDF to Word Converter</Application></Properties>`;
            const contentTypes = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Default Extension="png" ContentType="image/png"/><Default Extension="jpeg" ContentType="image/jpeg"/><Default Extension="jpg" ContentType="image/jpeg"/><Override PartName="/word/document.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/><Override PartName="/word/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/></Types>`;
            const rootRels = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="word/document.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/></Relationships>`;

            const zip = new JSZip();
            zip.file('[Content_Types].xml', contentTypes);
            zip.file('_rels/.rels',         rootRels);
            zip.file('word/document.xml',   docXml);
            zip.file('word/styles.xml',     stylesXml);
            zip.file('word/_rels/document.xml.rels', relsXml);
            zip.file('docProps/app.xml',    appXml);
            for (const img of imageFiles) {
                zip.file(`word/media/${img.filename}`, img.bytes, { binary: true });
            }
            return zip.generateAsync({ type: 'blob', mimeType: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', compression: 'DEFLATE', compressionOptions: { level: 6 } });
        }

        // ── Helpers ───────────────────────────────────────────────────
        function escXml(str) {
            return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&apos;');
        }
        function b64ToBytes(b64) {
            const bin = atob(b64), buf = new Uint8Array(bin.length);
            for (let i = 0; i < bin.length; i++) buf[i] = bin.charCodeAt(i);
            return buf;
        }
        function fileToBase64(file) {
            return new Promise((res, rej) => { const r = new FileReader(); r.onload = e => res(e.target.result); r.onerror = rej; r.readAsDataURL(file); });
        }
        function fmtSize(b) {
            if (!b) return '0 Bytes';
            const k = 1024, s = ['Bytes','KB','MB','GB'];
            const i = Math.floor(Math.log(b) / Math.log(k));
            return Math.round(b / Math.pow(k, i) * 100) / 100 + ' ' + s[i];
        }
        function setProgress(pct, msg) {
            progressFill.style.width = pct + '%';
            progressText.textContent = msg;
        }

        // ── Full Reset ────────────────────────────────────────────────
        function resetAll() {
            selectedFile = null; spPdfDoc = null; spImg = null;
            spIsImg = false; spPage = 1; spTotal = 1; spScale = 1.5;
            extractedPages = [];
            fileInput.value = '';
            filePreview.classList.remove('active');
            convertSection.classList.remove('active');
            progressSection.classList.remove('active');
            downloadSection.classList.remove('active');
            splitPanel.classList.remove('active');
            uploadZone.style.display = 'block';
            uploadZone.classList.remove('paste-active');
            pasteHint.style.display    = 'flex';
            pasteSuccess.style.display = 'none';
            spTextScroll.innerHTML = `
                <div class="split-empty" id="spEmptyState">
                    <i class="fas fa-file-alt"></i>
                    <p>Extracted text will appear here<br>after you click <strong>Convert to Word</strong></p>
                </div>`;
            spStatsBar.style.display = 'none';
            spSearchWrap.classList.remove('active');
            spSearchInput.value = '';
            spCtx.clearRect(0, 0, splitCanvas.width, splitCanvas.height);
            setProgress(0, 'Converting... 0%');
            convertBtn.disabled = false;
        }
    </script>
</body>
</html>
