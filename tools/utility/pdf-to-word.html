<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/WebPage">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="theme-color" content="#7c3aed">

    <!-- ✅ Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3CEQJ2D9WY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3CEQJ2D9WY');
    </script>

    <!-- ✅ Primary SEO -->
    <title>PDF to Word Converter — Free Online PDF to DOCX | FreeToolsHub</title>
    <meta name="title" content="PDF to Word Converter — Free Online PDF to DOCX | FreeToolsHub">
    <meta name="description" content="Convert PDF to Word (DOCX) instantly — free, no signup, no limits. Supports text, images & scanned PDFs. Paste images directly or drag & drop. Download editable Word file in seconds.">
    <meta name="keywords" content="PDF to Word converter, PDF to DOCX, convert PDF to Word online free, free PDF converter, PDF to editable Word, PDF to Word no signup, online DOCX converter 2026">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="author" content="Free Tools Hub">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    <meta name="rating" content="general">

    <!-- ✅ Canonical — YOUR CUSTOM DOMAIN -->
    <link rel="canonical" href="https://freetoolshub.online/tools/utility/pdf-to-word.html">

    <!-- ✅ Open Graph (Facebook / LinkedIn) -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Free Tools Hub">
    <meta property="og:locale" content="en_US">
    <meta property="og:url" content="https://freetoolshub.online/tools/utility/pdf-to-word.html">
    <meta property="og:title" content="PDF to Word Converter — Free, Fast & Accurate | FreeToolsHub">
    <meta property="og:description" content="Convert PDF to editable Word documents in seconds. Free online tool — no signup, no watermarks. Supports images, scanned PDFs & clipboard paste.">
    <meta property="og:image" content="https://freetoolshub.online/og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="PDF to Word Converter tool by FreeToolsHub">

    <!-- ✅ Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@freetoolshub">
    <meta name="twitter:url" content="https://freetoolshub.online/tools/utility/pdf-to-word.html">
    <meta name="twitter:title" content="PDF to Word Converter — Free Online | FreeToolsHub">
    <meta name="twitter:description" content="Convert PDF to editable DOCX free. No signup, no limits. Paste images or drag & drop your PDF.">
    <meta name="twitter:image" content="https://freetoolshub.online/og-image.jpg">
    <meta name="twitter:image:alt" content="PDF to Word Converter by FreeToolsHub">

    <!-- ✅ Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">

    <!-- ✅ SCHEMA 1: SoftwareApplication (best for tool pages) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "PDF to Word Converter",
        "alternateName": "PDF to DOCX Converter",
        "url": "https://freetoolshub.online/tools/utility/pdf-to-word.html",
        "description": "Free online PDF to Word converter. Convert PDF files and images to editable DOCX documents instantly. No signup required, unlimited conversions, privacy-focused.",
        "applicationCategory": "UtilityApplication",
        "applicationSubCategory": "DocumentConverter",
        "operatingSystem": "Any — works in browser",
        "browserRequirements": "Requires JavaScript. Works in Chrome, Firefox, Safari, Edge.",
        "softwareVersion": "2.0",
        "datePublished": "2024-01-01",
        "dateModified": "2026-02-18",
        "inLanguage": "en",
        "isAccessibleForFree": true,
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD",
            "availability": "https://schema.org/InStock"
        },
        "featureList": [
            "PDF to Word (DOCX) conversion",
            "Image to Word conversion (JPG, PNG)",
            "Clipboard paste support (Ctrl+V)",
            "Drag and drop file upload",
            "Page-by-page layout preservation",
            "Scanned PDF support",
            "No signup or registration required",
            "Free unlimited conversions",
            "Privacy-first — files never uploaded to server"
        ],
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "2150",
            "bestRating": "5",
            "worstRating": "1"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Free Tools Hub",
            "url": "https://freetoolshub.online",
            "logo": {
                "@type": "ImageObject",
                "url": "https://freetoolshub.online/logo.png"
            }
        }
    }
    </script>

    <!-- ✅ SCHEMA 2: BreadcrumbList -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://freetoolshub.online/" },
            { "@type": "ListItem", "position": 2, "name": "All Tools", "item": "https://freetoolshub.online/tools.html" },
            { "@type": "ListItem", "position": 3, "name": "PDF to Word Converter", "item": "https://freetoolshub.online/tools/utility/pdf-to-word.html" }
        ]
    }
    </script>

    <!-- ✅ SCHEMA 3: FAQPage — Google se FAQ rich results milenge -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "Is this PDF to Word converter really free?",
                "acceptedAnswer": { "@type": "Answer", "text": "Yes! Our PDF to Word converter is 100% free with no hidden costs. You can convert unlimited files without any signup or subscription required." }
            },
            {
                "@type": "Question",
                "name": "What is the maximum file size I can convert?",
                "acceptedAnswer": { "@type": "Answer", "text": "You can convert PDF files up to 50MB in size. This is sufficient for most documents including those with images and complex formatting." }
            },
            {
                "@type": "Question",
                "name": "Are my uploaded files secure and private?",
                "acceptedAnswer": { "@type": "Answer", "text": "Absolutely! All conversion happens directly in your browser — your files are never uploaded to any server. We don't store or share your documents." }
            },
            {
                "@type": "Question",
                "name": "Will the PDF formatting be preserved in Word?",
                "acceptedAnswer": { "@type": "Answer", "text": "Our converter preserves the original line-by-line and page-by-page layout including fonts and text structure. Complex PDFs with heavy graphics may require minor touch-ups in Word." }
            },
            {
                "@type": "Question",
                "name": "Can I convert scanned PDFs to Word?",
                "acceptedAnswer": { "@type": "Answer", "text": "Yes! Our converter can extract text from scanned PDFs and image files (JPG, PNG). You can also copy an image directly from your PDF and paste it into the tool using Ctrl+V." }
            },
            {
                "@type": "Question",
                "name": "Do I need to install software to convert PDF to Word?",
                "acceptedAnswer": { "@type": "Answer", "text": "No installation required. Our PDF to Word converter works entirely in your web browser. Just upload, convert, and download — no app needed." }
            }
        ]
    }
    </script>

    <!-- ✅ SCHEMA 4: HowTo — Google "How it Works" featured snippet -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "HowTo",
        "name": "How to Convert PDF to Word Online",
        "description": "Convert any PDF file to an editable Word document in 3 simple steps using FreeToolsHub — free, no signup needed.",
        "totalTime": "PT30S",
        "estimatedCost": { "@type": "MonetaryAmount", "currency": "USD", "value": "0" },
        "tool": [{ "@type": "HowToTool", "name": "FreeToolsHub PDF to Word Converter" }],
        "step": [
            {
                "@type": "HowToStep",
                "position": 1,
                "name": "Upload your PDF",
                "text": "Click 'Choose File' or drag and drop your PDF onto the converter. You can also paste a copied image with Ctrl+V.",
                "url": "https://freetoolshub.online/tools/utility/pdf-to-word.html#upload"
            },
            {
                "@type": "HowToStep",
                "position": 2,
                "name": "Click Convert",
                "text": "Press the 'Convert to Word' button. The tool extracts text page by page and builds your Word file in seconds.",
                "url": "https://freetoolshub.online/tools/utility/pdf-to-word.html#convert"
            },
            {
                "@type": "HowToStep",
                "position": 3,
                "name": "Download DOCX",
                "text": "Click 'Download Word File' to save your editable .docx document. Open it in Microsoft Word, Google Docs, or LibreOffice.",
                "url": "https://freetoolshub.online/tools/utility/pdf-to-word.html#download"
            }
        ]
    }
    </script>

    <!-- ✅ Preconnect for speed -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../../style.css">
    <style>
        .tool-container { max-width: 900px; margin: 0 auto; padding: 40px 24px 80px; }
        .preview-section { display: none; background: white; border-radius: var(--radius-lg); padding: 32px; margin-top: 24px; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); }
        .preview-section.active { display: block; }
        .preview-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 2px solid var(--gray-200); }
        .preview-header h3 { color: var(--gray-900); font-size: 1.2rem; display: flex; align-items: center; gap: 10px; }
        .preview-controls { display: flex; gap: 8px; align-items: center; }
        .page-info { color: var(--gray-600); font-size: 14px; padding: 6px 12px; background: var(--gray-100); border-radius: var(--radius-sm); }
        .preview-nav-btn { background: var(--purple-600); color: white; border: none; width: 36px; height: 36px; border-radius: var(--radius-sm); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: var(--transition); }
        .preview-nav-btn:hover:not(:disabled) { background: var(--purple-700); }
        .preview-nav-btn:disabled { opacity: 0.4; cursor: not-allowed; }
        .preview-canvas-container { background: var(--gray-100); border-radius: var(--radius-md); padding: 20px; display: flex; justify-content: center; align-items: center; min-height: 400px; overflow: auto; }
        #previewCanvas { max-width: 100%; height: auto; box-shadow: 0 4px 12px rgba(0,0,0,0.15); border-radius: 4px; }
        .preview-actions { margin-top: 20px; display: flex; gap: 12px; flex-wrap: wrap; }
        .btn-preview-action { display: inline-flex; align-items: center; gap: 8px; background: var(--gray-200); color: var(--gray-800); padding: 10px 20px; border-radius: var(--radius-md); border: none; cursor: pointer; font-weight: 500; transition: var(--transition); }
        .btn-preview-action:hover { background: var(--gray-300); transform: translateY(-2px); }
        .btn-preview-action.primary { background: var(--purple-600); color: white; }
        .btn-preview-action.primary:hover { background: var(--purple-700); }
        .breadcrumb { background: white; border-bottom: 1px solid var(--gray-200); padding: 12px 0; font-size: 13px; margin-bottom: 32px; }
        .breadcrumb-inner { display: flex; align-items: center; gap: 8px; color: var(--gray-500); flex-wrap: wrap; }
        .breadcrumb a { color: var(--gray-600); transition: var(--transition); }
        .breadcrumb a:hover { color: var(--purple-600); }
        .tool-header { text-align: center; margin-bottom: 48px; }
        .tool-badge { display: inline-flex; align-items: center; gap: 6px; background: linear-gradient(135deg, var(--purple-600), var(--fuchsia-500)); color: white; padding: 6px 14px; border-radius: var(--radius-full); font-size: 13px; font-weight: 600; margin-bottom: 16px; }
        .tool-header h1 { font-size: 2.5rem; color: var(--gray-900); margin-bottom: 12px; line-height: 1.2; }
        .tool-header p { font-size: 1.1rem; color: var(--gray-600); max-width: 600px; margin: 0 auto; }
        .converter-card { background: white; border-radius: var(--radius-xl); padding: 48px; box-shadow: var(--shadow-lg); border: 1px solid var(--gray-200); margin-bottom: 48px; }
        .upload-zone { border: 2px dashed var(--purple-300); border-radius: var(--radius-lg); padding: 48px 32px; text-align: center; background: var(--purple-50); transition: var(--transition); cursor: pointer; position: relative; }
        .upload-zone:hover { border-color: var(--purple-500); background: var(--purple-100); }
        .upload-zone.dragover { border-color: var(--purple-600); background: var(--purple-100); transform: scale(1.02); }
        .upload-zone.paste-active { border-color: #10b981; background: #ecfdf5; transform: scale(1.02); }
        .paste-hint { margin-top: 16px; display: flex; align-items: center; justify-content: center; gap: 8px; color: var(--gray-500); font-size: 13px; background: white; border: 1px dashed var(--gray-300); border-radius: var(--radius-md); padding: 10px 16px; }
        .paste-hint i { color: var(--purple-500); font-size: 16px; }
        .paste-hint kbd { background: var(--gray-100); border: 1px solid var(--gray-300); border-radius: 4px; padding: 1px 6px; font-size: 12px; font-family: monospace; color: var(--gray-700); }
        .paste-success { margin-top: 12px; color: #059669; font-weight: 600; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 6px; }
        .upload-icon { width: 64px; height: 64px; background: linear-gradient(135deg, var(--purple-600), var(--fuchsia-500)); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 28px; color: white; }
        .upload-zone h3 { color: var(--gray-900); margin-bottom: 8px; font-size: 1.3rem; }
        .upload-zone p { color: var(--gray-600); margin-bottom: 20px; }
        .file-input { display: none; }
        .btn-upload { display: inline-flex; align-items: center; gap: 8px; background: var(--purple-600); color: white; padding: 14px 28px; border-radius: var(--radius-md); font-weight: 600; border: none; cursor: pointer; transition: var(--transition); }
        .btn-upload:hover { background: var(--purple-700); transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .file-preview { display: none; background: var(--gray-100); border-radius: var(--radius-md); padding: 20px; margin-top: 24px; }
        .file-preview.active { display: block; }
        .file-info { display: flex; align-items: center; justify-content: space-between; gap: 16px; }
        .file-details { display: flex; align-items: center; gap: 12px; flex: 1; }
        .file-icon { width: 48px; height: 48px; background: var(--purple-600); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; color: white; font-size: 20px; }
        .file-meta h4 { color: var(--gray-900); font-size: 1rem; margin-bottom: 4px; }
        .file-meta p { color: var(--gray-500); font-size: 14px; }
        .btn-remove { background: var(--gray-200); color: var(--gray-700); border: none; padding: 8px 16px; border-radius: var(--radius-md); cursor: pointer; transition: var(--transition); }
        .btn-remove:hover { background: var(--gray-300); }
        .convert-section { display: none; text-align: center; margin-top: 32px; }
        .convert-section.active { display: block; }
        .btn-convert { display: inline-flex; align-items: center; gap: 10px; background: linear-gradient(135deg, var(--purple-600), var(--fuchsia-500)); color: white; padding: 16px 40px; border-radius: var(--radius-md); font-size: 1.1rem; font-weight: 600; border: none; cursor: pointer; transition: var(--transition); }
        .btn-convert:hover { transform: translateY(-3px); box-shadow: var(--shadow-xl); }
        .btn-convert:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .progress-section { display: none; margin-top: 32px; }
        .progress-section.active { display: block; }
        .progress-bar { height: 8px; background: var(--gray-200); border-radius: var(--radius-full); overflow: hidden; margin-bottom: 12px; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--purple-600), var(--fuchsia-500)); width: 0%; transition: width 0.3s ease; }
        .progress-text { text-align: center; color: var(--gray-600); font-size: 14px; }
        .download-section { display: none; text-align: center; margin-top: 32px; }
        .download-section.active { display: block; }
        .success-icon { width: 64px; height: 64px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 32px; color: white; animation: scaleIn 0.4s ease; }
        @keyframes scaleIn { from { transform: scale(0); } to { transform: scale(1); } }
        .download-section h3 { color: var(--gray-900); margin-bottom: 8px; }
        .download-section p { color: var(--gray-600); margin-bottom: 24px; }
        .download-btns { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; margin-bottom: 0; }
        .btn-download { display: inline-flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 14px 32px; border-radius: var(--radius-md); font-weight: 600; text-decoration: none; transition: var(--transition); border: none; cursor: pointer; font-size: 1rem; }
        .btn-download:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .btn-convert-another { display: inline-flex; align-items: center; gap: 8px; color: var(--purple-600); padding: 14px 24px; border-radius: var(--radius-md); font-weight: 600; transition: var(--transition); text-decoration: none; border: 2px solid var(--purple-200); background: white; cursor: pointer; font-size: 1rem; }
        .btn-convert-another:hover { background: var(--purple-50); border-color: var(--purple-400); }
        /* ── Extracted Text Preview Panel ── */
        .text-preview-panel { display: none; margin-top: 28px; background: var(--gray-50); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); overflow: hidden; }
        .text-preview-panel.active { display: block; }
        .text-preview-header { display: flex; align-items: center; justify-content: space-between; padding: 14px 20px; background: white; border-bottom: 1px solid var(--gray-200); flex-wrap: wrap; gap: 10px; }
        .text-preview-header-left { display: flex; align-items: center; gap: 10px; }
        .text-preview-header h4 { margin: 0; color: var(--gray-900); font-size: 1rem; font-weight: 600; }
        .text-preview-header-left span { font-size: 12px; color: var(--gray-500); background: var(--gray-100); padding: 2px 8px; border-radius: 20px; }
        .text-preview-actions { display: flex; gap: 8px; flex-wrap: wrap; }
        .btn-text-action { display: inline-flex; align-items: center; gap: 6px; padding: 7px 14px; border-radius: var(--radius-sm); border: 1px solid var(--gray-300); background: white; color: var(--gray-700); font-size: 13px; font-weight: 500; cursor: pointer; transition: var(--transition); }
        .btn-text-action:hover { background: var(--gray-100); border-color: var(--gray-400); }
        .btn-text-action.success { background: #d1fae5; border-color: #10b981; color: #065f46; }
        .btn-text-action.purple { background: var(--purple-600); border-color: var(--purple-600); color: white; }
        .btn-text-action.purple:hover { background: var(--purple-700); }
        .text-preview-body { position: relative; }
        .text-preview-pages { max-height: 480px; overflow-y: auto; padding: 0; }
        .text-page-block { padding: 20px 24px; border-bottom: 1px solid var(--gray-200); }
        .text-page-block:last-child { border-bottom: none; }
        .text-page-label { font-size: 11px; font-weight: 700; color: var(--purple-600); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 10px; display: flex; align-items: center; gap: 6px; }
        .text-page-label::after { content: ''; flex: 1; height: 1px; background: var(--purple-100); }
        .text-page-content { font-family: 'DM Sans', sans-serif; font-size: 14px; line-height: 1.75; color: var(--gray-800); white-space: pre-wrap; word-break: break-word; }
        .text-page-content.empty { color: var(--gray-400); font-style: italic; font-size: 13px; }
        .text-search-bar { padding: 10px 16px; background: white; border-bottom: 1px solid var(--gray-200); display: none; }
        .text-search-bar.active { display: block; }
        .text-search-bar input { width: 100%; padding: 8px 12px; border: 1px solid var(--gray-300); border-radius: var(--radius-sm); font-size: 14px; outline: none; }
        .text-search-bar input:focus { border-color: var(--purple-400); box-shadow: 0 0 0 3px rgba(124,58,237,0.1); }
        mark { background: #fef08a; padding: 0 2px; border-radius: 2px; }
        @media (max-width: 768px) {
            .text-preview-header { flex-direction: column; align-items: flex-start; }
            .text-preview-actions { width: 100%; }
            .btn-text-action { flex: 1; justify-content: center; }
        }
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px; margin-bottom: 64px; }
        .feature-card { background: white; padding: 32px; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); text-align: center; transition: var(--transition); }
        .feature-card:hover { box-shadow: var(--shadow-md); transform: translateY(-4px); }
        .feature-icon { width: 56px; height: 56px; background: var(--purple-100); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; font-size: 24px; color: var(--purple-600); }
        .feature-card h3 { color: var(--gray-900); margin-bottom: 8px; font-size: 1.1rem; }
        .feature-card p { color: var(--gray-600); font-size: 15px; line-height: 1.6; }
        .how-it-works { background: var(--gray-100); padding: 64px 24px; margin: 64px -24px; }
        .how-it-works-inner { max-width: 900px; margin: 0 auto; }
        .section-title { text-align: center; font-size: 2rem; color: var(--gray-900); margin-bottom: 48px; }
        .steps-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 32px; }
        .step-card { text-align: center; position: relative; }
        .step-number { width: 48px; height: 48px; background: linear-gradient(135deg, var(--purple-600), var(--fuchsia-500)); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3rem; font-weight: 700; margin: 0 auto 20px; }
        .step-card h3 { color: var(--gray-900); margin-bottom: 8px; font-size: 1.2rem; }
        .step-card p { color: var(--gray-600); line-height: 1.6; }
        .faq-section { margin-top: 64px; }
        .faq-item { background: white; border-radius: var(--radius-lg); padding: 24px 28px; margin-bottom: 16px; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); }
        .faq-question { display: flex; justify-content: space-between; align-items: center; cursor: pointer; gap: 16px; }
        .faq-question h3 { color: var(--gray-900); font-size: 1.1rem; font-weight: 600; }
        .faq-icon { color: var(--purple-600); font-size: 20px; transition: var(--transition); }
        .faq-item.active .faq-icon { transform: rotate(180deg); }
        .faq-answer { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; }
        .faq-item.active .faq-answer { max-height: 500px; margin-top: 16px; }
        .faq-answer p { color: var(--gray-600); line-height: 1.7; }
        .related-tools { margin-top: 64px; }
        .related-tools h2 { text-align: center; font-size: 2rem; color: var(--gray-900); margin-bottom: 40px; }
        .related-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; }
        .related-tool-card { background: white; border-radius: var(--radius-lg); padding: 28px; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); transition: var(--transition); display: flex; align-items: flex-start; gap: 16px; text-decoration: none; }
        .related-tool-card:hover { box-shadow: var(--shadow-md); transform: translateY(-4px); border-color: var(--purple-300); }
        .related-icon { width: 48px; height: 48px; background: var(--purple-100); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-size: 20px; color: var(--purple-600); flex-shrink: 0; }
        .related-content h3 { color: var(--gray-900); font-size: 1.05rem; margin-bottom: 6px; }
        .related-content p { color: var(--gray-600); font-size: 14px; line-height: 1.5; }
        .tool-badge-hot { display: inline-block; background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 2px 8px; border-radius: var(--radius-sm); font-size: 10px; font-weight: 700; margin-left: 8px; vertical-align: middle; }
        /* SEO Content Article */
        .seo-article { background: white; border-radius: var(--radius-lg); padding: 40px 44px; margin-top: 64px; box-shadow: var(--shadow-sm); border: 1px solid var(--gray-200); line-height: 1.8; }
        .seo-article h2 { color: var(--gray-900); font-size: 1.6rem; margin: 0 0 16px; }
        .seo-article h3 { color: var(--gray-900); font-size: 1.2rem; margin: 28px 0 10px; }
        .seo-article p { color: var(--gray-600); margin-bottom: 14px; font-size: 15.5px; }
        .seo-article ul { color: var(--gray-600); padding-left: 20px; margin-bottom: 14px; }
        .seo-article ul li { margin-bottom: 6px; font-size: 15.5px; }
        .seo-article strong { color: var(--gray-800); }
        @media (max-width: 768px) {
            .tool-header h1 { font-size: 1.8rem; }
            .converter-card { padding: 32px 24px; }
            .upload-zone { padding: 32px 20px; }
            .section-title { font-size: 1.6rem; }
            .how-it-works { padding: 48px 24px; margin: 48px -24px; }
            .file-info { flex-direction: column; align-items: flex-start; }
            .seo-article { padding: 28px 20px; }
        }
        @media (max-width: 480px) {
            .tool-container { padding: 24px 16px 60px; }
            .btn-download, .btn-convert-another { display: block; width: 100%; margin: 8px 0; }
        }
    </style>
</head>
<body>

    <header class="site-header" id="siteHeader">
        <div class="container">
            <div class="header-inner">
                <a href="../../index.html" class="site-logo" aria-label="Free Tools Hub Home">
                    <div class="logo-icon"><i class="fas fa-bolt" aria-hidden="true"></i></div>
                    <div class="logo-text">
                        <span class="logo-name">Free Tools Hub</span>
                        <span class="logo-tagline">Tools · Blogs · Resources</span>
                    </div>
                </a>
                <nav class="main-nav" aria-label="Main navigation">
                    <a href="../../index.html"><i class="fas fa-home" aria-hidden="true"></i>Home</a>
                    <a href="../../tools.html" class="active"><i class="fas fa-tools" aria-hidden="true"></i>All Tools</a>
                    <a href="../../blog.html"><i class="fas fa-pen-nib" aria-hidden="true"></i>Blog</a>
                    <a href="../../news.html"><i class="fas fa-newspaper" aria-hidden="true"></i>News</a>
                    <a href="../../resources.html"><i class="fas fa-layer-group" aria-hidden="true"></i>Resources</a>
                    <a href="../../tutorials.html"><i class="fas fa-play-circle" aria-hidden="true"></i>Tutorials</a>
                    <a href="../../contact.html" class="nav-cta"><i class="fas fa-paper-plane" aria-hidden="true"></i>Contact</a>
                </nav>
                <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle navigation" aria-expanded="false">
                    <i class="fas fa-bars" aria-hidden="true"></i>
                </button>
            </div>
        </div>
        <nav class="mobile-nav" id="mobileMenu" aria-label="Mobile navigation">
            <a href="../../index.html"><i class="fas fa-home" aria-hidden="true"></i>Home</a>
            <a href="../../tools.html" class="active"><i class="fas fa-tools" aria-hidden="true"></i>All Tools</a>
            <a href="../../blog.html"><i class="fas fa-pen-nib" aria-hidden="true"></i>Blog</a>
            <a href="../../news.html"><i class="fas fa-newspaper" aria-hidden="true"></i>News</a>
            <a href="../../resources.html"><i class="fas fa-layer-group" aria-hidden="true"></i>Resources</a>
            <a href="../../tutorials.html"><i class="fas fa-play-circle" aria-hidden="true"></i>Tutorials</a>
            <a href="../../contact.html" class="nav-cta"><i class="fas fa-paper-plane" aria-hidden="true"></i>Contact</a>
        </nav>
    </header>

    <div class="breadcrumb">
        <div class="container">
            <div class="breadcrumb-inner">
                <a href="../../index.html"><i class="fas fa-home"></i> Home</a>
                <span>/</span>
                <a href="../../tools.html">All Tools</a>
                <span>/</span>
                <span>PDF to Word Converter</span>
            </div>
        </div>
    </div>

    <main class="tool-container">
        <div class="tool-header">
            <div class="tool-badge"><i class="fas fa-fire"></i> HOT TOOL</div>
            <h1>PDF to Word Converter</h1>
            <p>Convert PDF files and images to editable Word documents instantly. Free, secure, and no signup required.</p>
        </div>

        <div class="converter-card">
            <div class="upload-zone" id="uploadZone">
                <div class="upload-icon"><i class="fas fa-file-pdf"></i></div>
                <h3>Drop your PDF or Image here or click to browse</h3>
                <p>Supports PDF files and images (JPG, PNG) up to 50MB</p>
                <button class="btn-upload" id="browseBtn">
                    <i class="fas fa-folder-open"></i> Choose PDF or Image File
                </button>
                <input type="file" id="fileInput" class="file-input" accept=".pdf,image/*">
                <div class="paste-hint" id="pasteHint">
                    <i class="fas fa-paste"></i>
                    <span>Ya <kbd>Ctrl+V</kbd> / <kbd>Cmd+V</kbd> dabayein — PDF se copy ki gai image seedha paste karein</span>
                </div>
                <div class="paste-success" id="pasteSuccess" style="display:none;">
                    <i class="fas fa-check-circle"></i> Image paste ho gayi! Convert button dabayein.
                </div>
            </div>

            <div class="file-preview" id="filePreview">
                <div class="file-info">
                    <div class="file-details">
                        <div class="file-icon"><i class="fas fa-file-pdf" id="fileIconElement"></i></div>
                        <div class="file-meta">
                            <h4 id="fileName">document.pdf</h4>
                            <p id="fileSize">0 KB</p>
                        </div>
                    </div>
                    <button class="btn-remove" id="removeBtn"><i class="fas fa-times"></i> Remove</button>
                </div>
            </div>

            <div class="preview-section" id="previewSection">
                <div class="preview-header">
                    <h3><i class="fas fa-eye"></i> Document Preview</h3>
                    <div class="preview-controls">
                        <button class="preview-nav-btn" id="prevPageBtn" title="Previous page"><i class="fas fa-chevron-left"></i></button>
                        <span class="page-info" id="pageInfo">Page 1 of 1</span>
                        <button class="preview-nav-btn" id="nextPageBtn" title="Next page"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
                <div class="preview-canvas-container">
                    <canvas id="previewCanvas"></canvas>
                </div>
                <div class="preview-actions">
                    <button class="btn-preview-action" id="zoomInBtn"><i class="fas fa-search-plus"></i> Zoom In</button>
                    <button class="btn-preview-action" id="zoomOutBtn"><i class="fas fa-search-minus"></i> Zoom Out</button>
                    <button class="btn-preview-action" id="resetZoomBtn"><i class="fas fa-compress"></i> Reset Zoom</button>
                    <button class="btn-preview-action primary" id="copyImageBtn"><i class="fas fa-copy"></i> Copy Image to Word</button>
                </div>
            </div>

            <div class="convert-section" id="convertSection">
                <button class="btn-convert" id="convertBtn">
                    <i class="fas fa-sync-alt"></i> Convert to Word
                </button>
            </div>

            <div class="progress-section" id="progressSection">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-text" id="progressText">Converting... 0%</p>
            </div>

            <div class="download-section" id="downloadSection">
                <div class="success-icon"><i class="fas fa-check"></i></div>
                <h3>Conversion Complete!</h3>
                <p>Your Word document is ready — download it or copy text below</p>
                <div class="download-btns">
                    <button class="btn-download" id="downloadBtn">
                        <i class="fas fa-download"></i> Download Word (.docx)
                    </button>
                    <a href="#" class="btn-convert-another" id="convertAnotherBtn">
                        <i class="fas fa-redo"></i> Convert Another
                    </a>
                </div>

                <!-- ── Extracted Text Preview Panel ── -->
                <div class="text-preview-panel" id="textPreviewPanel">
                    <div class="text-preview-header">
                        <div class="text-preview-header-left">
                            <h4><i class="fas fa-align-left" style="color:var(--purple-500)"></i> Extracted Text</h4>
                            <span id="pageCountBadge">0 pages</span>
                        </div>
                        <div class="text-preview-actions">
                            <button class="btn-text-action" id="searchToggleBtn" title="Find in text">
                                <i class="fas fa-search"></i> Find
                            </button>
                            <button class="btn-text-action" id="copyAllBtn" title="Copy all text">
                                <i class="fas fa-copy"></i> Copy All
                            </button>
                            <button class="btn-text-action" id="copyPageBtn" title="Copy current page text">
                                <i class="fas fa-file-alt"></i> Copy Page
                            </button>
                            <button class="btn-text-action purple" id="selectAllBtn" title="Select all text for manual copy">
                                <i class="fas fa-mouse-pointer"></i> Select All
                            </button>
                        </div>
                    </div>
                    <!-- Search bar (hidden until Find clicked) -->
                    <div class="text-search-bar" id="textSearchBar">
                        <input type="text" id="searchInput" placeholder="Type to search in text..." autocomplete="off">
                    </div>
                    <!-- Text content pages -->
                    <div class="text-preview-body">
                        <div class="text-preview-pages" id="textPreviewPages"></div>
                    </div>
                </div>
            </div>
        </div>

        <section class="features-grid" aria-label="PDF to Word converter features">
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-bolt"></i></div>
                <h3>Lightning Fast</h3>
                <p>Convert PDF to Word in seconds with our optimized in-browser conversion engine — no waiting for server uploads.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
                <h3>100% Private & Secure</h3>
                <p>Your files never leave your device. All conversion happens locally in your browser — no cloud, no data risk.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-infinity"></i></div>
                <h3>Unlimited & Free</h3>
                <p>No limits, no signup, no subscription. Convert as many PDF files as you need — completely free, forever.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-paste"></i></div>
                <h3>Paste Images (Ctrl+V)</h3>
                <p>Copy an image from any PDF reader and paste it directly into this tool with Ctrl+V — instant conversion.</p>
            </div>
        </section>

        <section class="how-it-works" aria-label="How to convert PDF to Word" id="how-to-use">
            <div class="how-it-works-inner">
                <h2 class="section-title">How to Convert PDF to Word — 3 Easy Steps</h2>
                <div class="steps-grid">
                    <div class="step-card" id="upload">
                        <div class="step-number">1</div>
                        <h3>Upload your PDF</h3>
                        <p>Select or drag & drop your PDF. You can also paste a copied image with <strong>Ctrl+V</strong>.</p>
                    </div>
                    <div class="step-card" id="convert">
                        <div class="step-number">2</div>
                        <h3>Click Convert</h3>
                        <p>Press "Convert to Word" — the tool extracts text page by page in seconds.</p>
                    </div>
                    <div class="step-card" id="download">
                        <div class="step-number">3</div>
                        <h3>Download DOCX</h3>
                        <p>Download your editable .docx file and open it in Word, Google Docs, or LibreOffice.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="faq-section">
            <h2 class="section-title">Frequently Asked Questions</h2>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <h3>Is this PDF to Word converter really free?</h3>
                    <i class="fas fa-chevron-down faq-icon"></i>
                </div>
                <div class="faq-answer">
                    <p>Yes! Our PDF to Word converter is 100% free with no hidden costs. You can convert unlimited files without any signup or subscription required.</p>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <h3>What file size can I convert?</h3>
                    <i class="fas fa-chevron-down faq-icon"></i>
                </div>
                <div class="faq-answer">
                    <p>You can convert PDF files up to 50MB in size. This is sufficient for most documents including those with images and complex formatting.</p>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <h3>Are my files secure and private?</h3>
                    <i class="fas fa-chevron-down faq-icon"></i>
                </div>
                <div class="faq-answer">
                    <p>Absolutely! All files are processed securely and automatically deleted from our servers immediately after conversion. We don't store or share your documents.</p>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <h3>Will the formatting be preserved?</h3>
                    <i class="fas fa-chevron-down faq-icon"></i>
                </div>
                <div class="faq-answer">
                    <p>Our converter maintains the original formatting, fonts, images, and layout as much as possible. Complex PDFs may require minor adjustments in Word.</p>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <h3>Can I convert scanned PDFs?</h3>
                    <i class="fas fa-chevron-down faq-icon"></i>
                </div>
                <div class="faq-answer">
                    <p>Yes! Our converter uses OCR (Optical Character Recognition) technology to extract text from scanned PDFs and convert them to editable Word documents.</p>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <h3>Do I need to install any software?</h3>
                    <i class="fas fa-chevron-down faq-icon"></i>
                </div>
                <div class="faq-answer">
                    <p>No installation required! Our online converter works entirely in your browser. Just upload your PDF and download the converted Word document.</p>
                </div>
            </div>
        </section>

        <section class="related-tools">
            <h2>Related PDF Tools</h2>
            <div class="related-grid">
                <a href="word-to-pdf-converter.html" class="related-tool-card">
                    <div class="related-icon"><i class="fas fa-file-pdf"></i></div>
                    <div class="related-content">
                        <h3>Word to PDF <span class="tool-badge-hot">HOT</span></h3>
                        <p>Convert Word documents to PDF format instantly</p>
                    </div>
                </a>
                <a href="pdf-to-jpg.html" class="related-tool-card">
                    <div class="related-icon"><i class="fas fa-file-image"></i></div>
                    <div class="related-content">
                        <h3>PDF to JPG <span class="tool-badge-hot">HOT</span></h3>
                        <p>Convert PDF pages to high-quality JPG images</p>
                    </div>
                </a>
                <a href="jpg-to-pdf.html" class="related-tool-card">
                    <div class="related-icon"><i class="fas fa-images"></i></div>
                    <div class="related-content">
                        <h3>JPG to PDF <span class="tool-badge-hot">HOT</span></h3>
                        <p>Convert images to PDF documents quickly</p>
                    </div>
                </a>
                <a href="rotate-pdf-pages.html" class="related-tool-card">
                    <div class="related-icon"><i class="fas fa-sync-alt"></i></div>
                    <div class="related-content">
                        <h3>Rotate PDF Pages</h3>
                        <p>Rotate pages in your PDF documents</p>
                    </div>
                </a>
                <a href="reorder-pdf-pages.html" class="related-tool-card">
                    <div class="related-icon"><i class="fas fa-sort"></i></div>
                    <div class="related-content">
                        <h3>Re-arrange PDF Pages</h3>
                        <p>Reorder pages in your PDF files easily</p>
                    </div>
                </a>
                <a href="pdf-pages-delete.html" class="related-tool-card">
                    <div class="related-icon"><i class="fas fa-trash-alt"></i></div>
                    <div class="related-content">
                        <h3>Delete PDF Pages</h3>
                        <p>Remove unwanted pages from your PDFs</p>
                    </div>
                </a>
            </div>
        </section>

        <!-- ✅ SEO CONTENT ARTICLE — Google ranking ke liye rich content -->
        <article class="seo-article" aria-label="About PDF to Word Converter">
            <h2>PDF to Word Converter — Complete Guide</h2>
            <p>
                Our <strong>free PDF to Word converter</strong> lets you transform any PDF document into a fully editable <strong>Microsoft Word (.docx) file</strong> — directly in your browser, with no signup, no installation, and no file size tricks. Whether you have a simple text PDF, a scanned document, or an image you've copied from a PDF, this tool handles it all in seconds.
            </p>

            <h3>Why Convert PDF to Word?</h3>
            <p>
                PDF files are great for sharing, but they're locked — you can't easily edit text, update a table, or change formatting. Converting your PDF to Word gives you full editing power. You can update contracts, edit reports, reformat resumes, translate content, or repurpose any PDF document into a live, editable Word file compatible with Microsoft Word, Google Docs, and LibreOffice.
            </p>

            <h3>What Makes This Tool Different?</h3>
            <ul>
                <li><strong>Page-by-page layout preservation</strong> — Each PDF page becomes a separate Word page with correct page breaks, keeping your document structure intact.</li>
                <li><strong>Clipboard paste (Ctrl+V)</strong> — Open any PDF in your browser or PDF reader, select and copy an image or screenshot, and paste it directly into this tool. No need to save a file first.</li>
                <li><strong>100% browser-based</strong> — Your files never leave your device. No server upload, no privacy risk. Conversion happens entirely in your browser using JavaScript.</li>
                <li><strong>No watermarks</strong> — The converted Word file is clean, with only a tiny unobtrusive branding line. Your content is yours.</li>
                <li><strong>Image support</strong> — Upload JPG or PNG images directly and convert them into embedded Word documents.</li>
            </ul>

            <h3>How to Convert PDF to Word — Step by Step</h3>
            <p>
                <strong>Option 1 — File upload:</strong> Click "Choose PDF or Image File" or drag your PDF onto the upload area. The tool previews your document with page navigation, zoom in/out controls, and then converts it when you click "Convert to Word."
            </p>
            <p>
                <strong>Option 2 — Clipboard paste:</strong> Open your PDF in any reader, right-click an image and choose Copy (or use your screenshot tool), then come back to this page and press <strong>Ctrl+V</strong> (Windows) or <strong>Cmd+V</strong> (Mac). The pasted image loads instantly and can be converted to a Word file.
            </p>
            <p>
                <strong>Option 3 — Drag & drop:</strong> Simply drag your PDF or image file from your desktop or file manager and drop it onto the upload zone. No clicking required.
            </p>

            <h3>Supported File Formats</h3>
            <p>
                This tool supports <strong>PDF files</strong> (text-based and image PDFs) and <strong>image files</strong> including JPG, JPEG, PNG, GIF, WebP, and BMP. The output is always a standard <strong>.docx</strong> file compatible with all versions of Microsoft Word (2010 and later), Google Docs, LibreOffice Writer, and WPS Office.
            </p>

            <h3>Is It Safe to Convert PDF to Word Online?</h3>
            <p>
                Yes — because this tool converts your files <strong>entirely inside your own browser</strong>. Unlike most online converters that upload your file to a cloud server, this tool uses PDF.js and docx.js libraries that run locally in your browser tab. Your document content is never transmitted, stored, or seen by anyone else.
            </p>

            <h3>Tips for Best Conversion Results</h3>
            <ul>
                <li>For <strong>text-heavy PDFs</strong>: conversion preserves line-by-line structure. Complex multi-column layouts may need minor adjustment in Word.</li>
                <li>For <strong>image-only or scanned PDFs</strong>: use the clipboard paste feature — copy the scan as an image and paste it for best fidelity.</li>
                <li>For <strong>large PDFs</strong> (50+ pages): conversion may take 10–20 seconds. The progress bar shows page-by-page extraction status.</li>
                <li>After download, open the .docx in Word and use <em>Format → Paragraph</em> to fine-tune spacing if needed.</li>
            </ul>
        </article>

    </main>

    <footer class="site-footer" aria-label="Site footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <div class="site-logo">
                        <div class="logo-icon"><i class="fas fa-bolt" aria-hidden="true"></i></div>
                        <div class="logo-text"><span class="logo-name">Free Tools Hub</span></div>
                    </div>
                    <p>Your complete hub for free tools, expert blogs, tech news, curated resources, and tutorials — all in one place.</p>
                    <div class="footer-social" style="margin-top: 20px;">
                        <a href="#" class="social-icon" aria-label="Twitter"><i class="fab fa-twitter" aria-hidden="true"></i></a>
                        <a href="https://github.com/freetoolsapp" class="social-icon" aria-label="GitHub" target="_blank" rel="noopener noreferrer"><i class="fab fa-github" aria-hidden="true"></i></a>
                        <a href="#" class="social-icon" aria-label="LinkedIn"><i class="fab fa-linkedin-in" aria-hidden="true"></i></a>
                        <a href="#" class="social-icon" aria-label="YouTube"><i class="fab fa-youtube" aria-hidden="true"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="../../index.html"><i class="fas fa-home" aria-hidden="true"></i>Home</a></li>
                        <li><a href="../../tools.html"><i class="fas fa-tools" aria-hidden="true"></i>All Tools</a></li>
                        <li><a href="../../blog.html"><i class="fas fa-pen-nib" aria-hidden="true"></i>Blog</a></li>
                        <li><a href="../../news.html"><i class="fas fa-newspaper" aria-hidden="true"></i>News</a></li>
                        <li><a href="../../contact.html"><i class="fas fa-envelope" aria-hidden="true"></i>Contact</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Categories</h4>
                    <ul>
                        <li><a href="../../resources.html"><i class="fas fa-layer-group" aria-hidden="true"></i>Resources</a></li>
                        <li><a href="../../tutorials.html"><i class="fas fa-play-circle" aria-hidden="true"></i>Tutorials</a></li>
                        <li><a href="../../comparisons.html"><i class="fas fa-balance-scale" aria-hidden="true"></i>Comparisons</a></li>
                        <li><a href="../../about.html"><i class="fas fa-info-circle" aria-hidden="true"></i>About Us</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="../../privacy.html"><i class="fas fa-shield-alt" aria-hidden="true"></i>Privacy Policy</a></li>
                        <li><a href="../../terms.html"><i class="fas fa-file-contract" aria-hidden="true"></i>Terms of Service</a></li>
                        <li><a href="../../disclaimer.html"><i class="fas fa-exclamation-circle" aria-hidden="true"></i>Disclaimer</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 <a href="../../index.html">Free Tools Hub</a>. All rights reserved. Made with <span class="heart">♥</span> for developers &amp; creators.</p>
                <div class="footer-legal">
                    <a href="../../privacy.html">Privacy</a>
                    <a href="../../terms.html">Terms</a>
                    <a href="../../disclaimer.html">Disclaimer</a>
                </div>
            </div>
        </div>
    </footer>


    <!-- PDF.js for preview and text extraction -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <!-- JSZip for building .docx (ZIP format) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- FileSaver for download -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        // Header scroll
        const header = document.getElementById('siteHeader');
        window.addEventListener('scroll', () => { header.classList.toggle('scrolled', window.scrollY > 20); }, { passive: true });

        // Mobile menu
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenu    = document.getElementById('mobileMenu');
        mobileMenuBtn.addEventListener('click', () => {
            const isOpen = mobileMenu.classList.toggle('open');
            mobileMenuBtn.setAttribute('aria-expanded', isOpen);
            mobileMenuBtn.innerHTML = isOpen
                ? '<i class="fas fa-times" aria-hidden="true"></i>'
                : '<i class="fas fa-bars" aria-hidden="true"></i>';
        });
        mobileMenu.querySelectorAll('a').forEach(l => l.addEventListener('click', () => {
            mobileMenu.classList.remove('open');
            mobileMenuBtn.setAttribute('aria-expanded', 'false');
            mobileMenuBtn.innerHTML = '<i class="fas fa-bars" aria-hidden="true"></i>';
        }));

        function toggleFaq(el) {
            const item = el.parentElement;
            const wasActive = item.classList.contains('active');
            document.querySelectorAll('.faq-item').forEach(i => i.classList.remove('active'));
            if (!wasActive) item.classList.add('active');
        }

        // ── DOM refs ──────────────────────────────────────────────────
        const uploadZone      = document.getElementById('uploadZone');
        const fileInput       = document.getElementById('fileInput');
        const browseBtn       = document.getElementById('browseBtn');
        const filePreview     = document.getElementById('filePreview');
        const previewSection  = document.getElementById('previewSection');
        const convertSection  = document.getElementById('convertSection');
        const progressSection = document.getElementById('progressSection');
        const downloadSection = document.getElementById('downloadSection');
        const convertBtn      = document.getElementById('convertBtn');
        const removeBtn       = document.getElementById('removeBtn');
        const downloadBtn     = document.getElementById('downloadBtn');
        const convertAnotherBtn = document.getElementById('convertAnotherBtn');
        const fileNameEl      = document.getElementById('fileName');
        const fileSizeEl      = document.getElementById('fileSize');
        const fileIconEl      = document.getElementById('fileIconElement');
        const progressFill    = document.getElementById('progressFill');
        const progressText    = document.getElementById('progressText');
        const previewCanvas   = document.getElementById('previewCanvas');
        const ctx             = previewCanvas.getContext('2d');
        const prevPageBtn     = document.getElementById('prevPageBtn');
        const nextPageBtn     = document.getElementById('nextPageBtn');
        const pageInfo        = document.getElementById('pageInfo');
        const zoomInBtn       = document.getElementById('zoomInBtn');
        const zoomOutBtn      = document.getElementById('zoomOutBtn');
        const resetZoomBtn    = document.getElementById('resetZoomBtn');
        const copyImageBtn    = document.getElementById('copyImageBtn');
        const pasteHint       = document.getElementById('pasteHint');
        const pasteSuccess    = document.getElementById('pasteSuccess');
        const textPreviewPanel= document.getElementById('textPreviewPanel');
        const textPreviewPages= document.getElementById('textPreviewPages');
        const pageCountBadge  = document.getElementById('pageCountBadge');
        const copyAllBtn      = document.getElementById('copyAllBtn');
        const copyPageBtn     = document.getElementById('copyPageBtn');
        const selectAllBtn    = document.getElementById('selectAllBtn');
        const searchToggleBtn = document.getElementById('searchToggleBtn');
        const textSearchBar   = document.getElementById('textSearchBar');
        const searchInput     = document.getElementById('searchInput');

        // ── State ─────────────────────────────────────────────────────
        let selectedFile = null, pdfDocument = null;
        let currentPage = 1, totalPages = 1, currentScale = 1.5;
        let currentImage = null, isImageFile = false;
        let extractedPages = []; // stored after conversion for text preview

        // ── Upload / Drag / Paste ─────────────────────────────────────
        browseBtn.addEventListener('click', e => { e.stopPropagation(); fileInput.click(); });
        uploadZone.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', e => {
            const f = e.target.files[0];
            if (f) pickFile(f);
        });
        uploadZone.addEventListener('dragover',  e => { e.preventDefault(); uploadZone.classList.add('dragover'); });
        uploadZone.addEventListener('dragleave', () => uploadZone.classList.remove('dragover'));
        uploadZone.addEventListener('drop', e => {
            e.preventDefault(); uploadZone.classList.remove('dragover');
            if (e.dataTransfer.files[0]) pickFile(e.dataTransfer.files[0]);
        });

        // Ctrl+V paste support
        document.addEventListener('paste', async e => {
            if (uploadZone.style.display === 'none') return;
            const items = [...(e.clipboardData || window.clipboardData).items];
            const imgItem = items.find(i => i.type.startsWith('image/'));
            if (!imgItem) return;
            e.preventDefault();
            uploadZone.classList.add('paste-active');
            pasteSuccess.style.display = 'flex';
            pasteHint.style.display    = 'none';
            const blob = imgItem.getAsFile();
            const f = new File([blob], 'pasted-image.png', { type: blob.type || 'image/png' });
            setTimeout(async () => { uploadZone.classList.remove('paste-active'); await pickFile(f); }, 350);
        });

        function pickFile(f) {
            if (f.type === 'application/pdf' || f.type.startsWith('image/')) {
                handleFile(f);
            } else {
                alert('Please select a PDF or image file (JPG, PNG)');
            }
        }

        async function handleFile(file) {
            selectedFile = file;
            isImageFile  = file.type.startsWith('image/');
            fileNameEl.textContent = file.name;
            fileSizeEl.textContent = fmtSize(file.size);
            fileIconEl.className   = isImageFile ? 'fas fa-file-image' : 'fas fa-file-pdf';
            filePreview.classList.add('active');
            convertSection.classList.add('active');
            previewSection.classList.add('active');
            uploadZone.style.display = 'none';
            if (isImageFile) await previewImage(file);
            else             await previewPdf(file);
        }

        // ── Preview ───────────────────────────────────────────────────
        async function previewPdf(file) {
            try {
                pdfDocument = await pdfjsLib.getDocument({ data: await file.arrayBuffer() }).promise;
                totalPages = pdfDocument.numPages; currentPage = 1;
                await renderPdfPage(currentPage);
                refreshNav();
            } catch(e) { console.error(e); alert('Error loading PDF preview'); }
        }

        async function previewImage(file) {
            return new Promise((res, rej) => {
                const r = new FileReader();
                r.onload = ev => {
                    const img = new Image();
                    img.onload = () => { currentImage = img; totalPages = 1; currentPage = 1; renderImg(); refreshNav(); res(); };
                    img.onerror = rej;
                    img.src = ev.target.result;
                };
                r.onerror = rej;
                r.readAsDataURL(file);
            });
        }

        async function renderPdfPage(n) {
            const page = await pdfDocument.getPage(n);
            const vp = page.getViewport({ scale: currentScale });
            previewCanvas.width = vp.width; previewCanvas.height = vp.height;
            await page.render({ canvasContext: ctx, viewport: vp }).promise;
        }

        function renderImg() {
            if (!currentImage) return;
            const maxW = 800;
            let w = currentImage.width * currentScale, h = currentImage.height * currentScale;
            if (w > maxW) { h *= maxW / w; w = maxW; }
            previewCanvas.width = w; previewCanvas.height = h;
            ctx.clearRect(0, 0, w, h);
            ctx.drawImage(currentImage, 0, 0, w, h);
        }

        function refreshNav() {
            pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;
            prevPageBtn.disabled = currentPage <= 1;
            nextPageBtn.disabled = currentPage >= totalPages;
            const show = !isImageFile;
            prevPageBtn.style.display = show ? 'flex'  : 'none';
            nextPageBtn.style.display = show ? 'flex'  : 'none';
            pageInfo.style.display    = show ? 'block' : 'none';
        }

        prevPageBtn.addEventListener('click', async () => { if (currentPage > 1) { currentPage--; await renderPdfPage(currentPage); refreshNav(); } });
        nextPageBtn.addEventListener('click', async () => { if (currentPage < totalPages) { currentPage++; await renderPdfPage(currentPage); refreshNav(); } });

        zoomInBtn.addEventListener('click',   async () => { currentScale = Math.min(3, currentScale+.25); isImageFile ? renderImg() : await renderPdfPage(currentPage); });
        zoomOutBtn.addEventListener('click',  async () => { currentScale = Math.max(.5, currentScale-.25); isImageFile ? renderImg() : await renderPdfPage(currentPage); });
        resetZoomBtn.addEventListener('click',async () => { currentScale = 1.5; isImageFile ? renderImg() : await renderPdfPage(currentPage); });

        copyImageBtn.addEventListener('click', async () => {
            try {
                const blob = await new Promise(r => previewCanvas.toBlob(r, 'image/png'));
                await navigator.clipboard.write([new ClipboardItem({'image/png': blob})]);
                const orig = copyImageBtn.innerHTML;
                copyImageBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                copyImageBtn.style.background = '#10b981';
                setTimeout(() => { copyImageBtn.innerHTML = orig; copyImageBtn.style.background = ''; }, 2000);
                alert('Image copied! Paste into Word with Ctrl+V / Cmd+V');
            } catch(e) { alert('Failed to copy. Use the Download button instead.'); }
        });

        removeBtn.addEventListener('click', resetAll);
        convertAnotherBtn.addEventListener('click', e => { e.preventDefault(); resetAll(); });

        // ── Convert ───────────────────────────────────────────────────
        convertBtn.addEventListener('click', async () => {
            if (!selectedFile) return;
            convertBtn.disabled = true;
            convertSection.style.display = 'none';
            progressSection.classList.add('active');
            try {
                await doConvert(selectedFile);
            } catch(err) {
                console.error('Conversion error:', err);
                alert('Conversion failed: ' + (err.message || err));
                resetAll();
            }
        });

        // ── Core conversion ───────────────────────────────────────────
        async function doConvert(file) {
            setProgress(5, 'Starting...');

            // 1. Collect pages data
            let pages = []; // [{lines:string[], imgB64:string|null}]

            if (isImageFile) {
                setProgress(20, 'Reading image...');
                const b64 = await fileToBase64(file);
                pages.push({ lines: [], imgB64: b64 });
            } else {
                setProgress(15, 'Loading PDF...');
                const pdf = await pdfjsLib.getDocument({ data: await file.arrayBuffer() }).promise;
                for (let p = 1; p <= pdf.numPages; p++) {
                    const page  = await pdf.getPage(p);
                    const vp    = page.getViewport({ scale: 1 });
                    const pgH   = vp.height;
                    const tc    = await page.getTextContent({ includeMarkedContent: false });

                    // sort items top→bottom, left→right
                    const items = tc.items
                        .filter(it => it.str)
                        .map(it => ({ str: it.str, x: it.transform[4], y: pgH - it.transform[5] }))
                        .sort((a, b) => a.y - b.y || a.x - b.x);

                    // group into lines (±6pt tolerance)
                    const groups = [];
                    let cur = null;
                    for (const it of items) {
                        if (!cur || Math.abs(it.y - cur.y) > 6) { cur = { y: it.y, parts: [] }; groups.push(cur); }
                        cur.parts.push(it);
                    }

                    const lines = groups
                        .map(g => g.parts.sort((a,b)=>a.x-b.x).map(i=>i.str).join(' ').trimEnd())
                        .filter(l => l.trim());

                    pages.push({ lines, imgB64: null });

                    const pct = 15 + Math.round((p / pdf.numPages) * 65);
                    setProgress(pct, `Extracting page ${p} of ${pdf.numPages}...`);
                }
            }

            setProgress(82, 'Building Word document...');
            const blob = await buildDocx(pages);

            setProgress(100, 'Done!');
            await new Promise(r => setTimeout(r, 300));

            // Store pages globally for text preview
            extractedPages = pages;

            progressSection.classList.remove('active');
            downloadSection.classList.add('active');

            const outName = file.name.replace(/\.[^/.]+$/, '') + '.docx';
            downloadBtn.onclick = () => saveAs(blob, outName);

            // Render text preview panel
            renderTextPreview(pages);
        }

        // ── DOCX builder using JSZip + raw OOXML ─────────────────────
        async function buildDocx(pages) {
            // Build the body XML
            let bodyXml = '';

            for (let pi = 0; pi < pages.length; pi++) {
                const page = pages[pi];

                // Page break before every page except first
                if (pi > 0) {
                    bodyXml += `<w:p><w:r><w:br w:type="page"/></w:r></w:p>`;
                }

                // Image
                if (page.imgB64) {
                    // We'll embed the image as a relationship
                    // Add a placeholder — actual image embedding handled below
                    bodyXml += `<!-- IMG_${pi} -->`;
                }

                // Text lines
                for (const line of page.lines) {
                    const escaped = escXml(line);
                    bodyXml += `<w:p><w:pPr><w:spacing w:line="276" w:lineRule="auto" w:before="0" w:after="0"/></w:pPr><w:r><w:rPr><w:rFonts w:ascii="Calibri" w:hAnsi="Calibri"/><w:sz w:val="24"/><w:szCs w:val="24"/></w:rPr><w:t xml:space="preserve">${escaped}</w:t></w:r></w:p>`;
                }

                // Empty page fallback
                if (!page.imgB64 && page.lines.length === 0) {
                    bodyXml += `<w:p><w:pPr><w:spacing w:before="0" w:after="0"/></w:pPr></w:p>`;
                }
            }

            // Branding footer
            bodyXml += `<w:p><w:pPr><w:spacing w:before="240" w:after="0"/><w:jc w:val="center"/></w:pPr><w:r><w:rPr><w:rFonts w:ascii="Calibri" w:hAnsi="Calibri"/><w:sz w:val="14"/><w:szCs w:val="14"/><w:color w:val="CCCCCC"/><w:i/></w:rPr><w:t>freetoolshub.online</w:t></w:r></w:p>`;

            // ── Now handle images ──────────────────────────────────────
            const imageFiles  = []; // {rId, filename, mime, bytes}
            const relationships = []; // extra rels for images

            for (let pi = 0; pi < pages.length; pi++) {
                const page = pages[pi];
                if (!page.imgB64) continue;

                const b64    = page.imgB64.split(',')[1];
                const mime   = page.imgB64.split(';')[0].split(':')[1];
                const ext    = mime.includes('png') ? 'png' : 'jpeg';
                const bytes  = b64ToBytes(b64);
                const rId    = `rId${pi + 10}`;
                const fname  = `image${pi}.${ext}`;

                imageFiles.push({ rId, filename: fname, mime, bytes });
                relationships.push(
                    `<Relationship Id="${rId}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="media/${fname}"/>`
                );

                // Build inline image XML (6858000 EMU ≈ 19cm wide, auto height)
                const imgW = 5486400; // ~15.24cm in EMU
                const imgH = 7315200; // ~20.32cm in EMU
                const imgXml = `<w:p><w:r><w:rPr/><w:drawing><wp:inline distT="0" distB="0" distL="0" distR="0" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"><wp:extent cx="${imgW}" cy="${imgH}"/><wp:effectExtent l="0" t="0" r="0" b="0"/><wp:docPr id="${pi+1}" name="Image${pi+1}"/><wp:cNvGraphicFramePr><a:graphicFrameLocks xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" noChangeAspect="1"/></wp:cNvGraphicFramePr><a:graphic xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"><a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:pic xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture"><pic:nvPicPr><pic:cNvPr id="${pi+1}" name="Image${pi+1}"/><pic:cNvPicPr><a:picLocks noChangeAspect="1" noChangeArrowheads="1"/></pic:cNvPicPr></pic:nvPicPr><pic:blipFill><a:blip r:embed="${rId}" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/><a:stretch><a:fillRect/></a:stretch></pic:blipFill><pic:spPr bwMode="auto"><a:xfrm><a:off x="0" y="0"/><a:ext cx="${imgW}" cy="${imgH}"/></a:xfrm><a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r></w:p>`;

                bodyXml = bodyXml.replace(`<!-- IMG_${pi} -->`, imgXml);
            }

            // ── Assemble OOXML files ───────────────────────────────────
            const docXml = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:document xmlns:wpc="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas"
    xmlns:mo="http://schemas.microsoft.com/office/mac/office/2008/main"
    xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"
    xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math"
    xmlns:o="urn:schemas-microsoft-com:office:office"
    xmlns:v="urn:schemas-microsoft-com:vml"
    xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main"
    xmlns:w14="http://schemas.microsoft.com/office/word/2010/wordml"
    xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"
    xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"
    mc:Ignorable="w14" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006">
  <w:body>
    ${bodyXml}
    <w:sectPr>
      <w:pgSz w:w="12240" w:h="15840"/>
      <w:pgMar w:top="1440" w:right="1440" w:bottom="1440" w:left="1440"
               w:header="720" w:footer="720" w:gutter="0"/>
    </w:sectPr>
  </w:body>
</w:document>`;

            const relsXml = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
  <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>
  ${relationships.join('\n  ')}
</Relationships>`;

            const stylesXml = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:styles xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main"
          xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">
  <w:docDefaults>
    <w:rPrDefault>
      <w:rPr>
        <w:rFonts w:ascii="Calibri" w:eastAsia="Calibri" w:hAnsi="Calibri" w:cs="Calibri"/>
        <w:sz w:val="24"/>
        <w:szCs w:val="24"/>
      </w:rPr>
    </w:rPrDefault>
  </w:docDefaults>
  <w:style w:type="paragraph" w:default="1" w:styleId="Normal">
    <w:name w:val="Normal"/>
    <w:pPr><w:spacing w:after="0" w:line="276" w:lineRule="auto"/></w:pPr>
  </w:style>
</w:styles>`;

            const appXml = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties">
  <Application>FreeToolsHub PDF to Word Converter</Application>
</Properties>`;

            const contentTypes = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
  <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>
  <Default Extension="xml"  ContentType="application/xml"/>
  <Default Extension="png"  ContentType="image/png"/>
  <Default Extension="jpeg" ContentType="image/jpeg"/>
  <Default Extension="jpg"  ContentType="image/jpeg"/>
  <Override PartName="/word/document.xml"
    ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/>
  <Override PartName="/word/styles.xml"
    ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"/>
  <Override PartName="/docProps/app.xml"
    ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/>
</Types>`;

            const rootRels = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
  <Relationship Id="rId1"
    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"
    Target="word/document.xml"/>
  <Relationship Id="rId2"
    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"
    Target="docProps/app.xml"/>
</Relationships>`;

            // ── Build ZIP ─────────────────────────────────────────────
            const zip = new JSZip();
            zip.file('[Content_Types].xml', contentTypes);
            zip.file('_rels/.rels',         rootRels);
            zip.file('word/document.xml',   docXml);
            zip.file('word/styles.xml',     stylesXml);
            zip.file('word/_rels/document.xml.rels', relsXml);
            zip.file('docProps/app.xml',    appXml);

            for (const img of imageFiles) {
                zip.file(`word/media/${img.filename}`, img.bytes, { binary: true });
            }

            const blob = await zip.generateAsync({
                type            : 'blob',
                mimeType        : 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                compression     : 'DEFLATE',
                compressionOptions: { level: 6 },
            });

            return blob;
        }

        // ── Helpers ───────────────────────────────────────────────────
        function escXml(str) {
            return str
                .replace(/&/g,  '&amp;')
                .replace(/</g,  '&lt;')
                .replace(/>/g,  '&gt;')
                .replace(/"/g,  '&quot;')
                .replace(/'/g,  '&apos;');
        }

        function b64ToBytes(b64) {
            const bin = atob(b64);
            const buf = new Uint8Array(bin.length);
            for (let i = 0; i < bin.length; i++) buf[i] = bin.charCodeAt(i);
            return buf;
        }

        function fileToBase64(file) {
            return new Promise((res, rej) => {
                const r = new FileReader();
                r.onload  = e => res(e.target.result);
                r.onerror = rej;
                r.readAsDataURL(file);
            });
        }

        function fmtSize(b) {
            if (!b) return '0 Bytes';
            const k = 1024, s = ['Bytes','KB','MB','GB'];
            const i = Math.floor(Math.log(b) / Math.log(k));
            return Math.round(b / Math.pow(k, i) * 100) / 100 + ' ' + s[i];
        }

        function setProgress(pct, msg) {
            progressFill.style.width = pct + '%';
            progressText.textContent = msg;
        }

        // ── Text Preview Panel ────────────────────────────────────────
        function renderTextPreview(pages) {
            const textPages = pages.filter(p => p.lines && p.lines.length > 0);

            if (textPages.length === 0) {
                // Image-only file — hide panel
                textPreviewPanel.classList.remove('active');
                return;
            }

            textPreviewPanel.classList.add('active');
            pageCountBadge.textContent = `${textPages.length} page${textPages.length !== 1 ? 's' : ''}`;

            // Build page blocks HTML
            textPreviewPages.innerHTML = '';
            textPages.forEach((page, idx) => {
                const block = document.createElement('div');
                block.className = 'text-page-block';
                block.dataset.pageIndex = idx;

                const label = document.createElement('div');
                label.className = 'text-page-label';
                label.textContent = `Page ${idx + 1}`;

                const content = document.createElement('div');
                content.className = 'text-page-content';
                content.textContent = page.lines.join('\n');

                block.appendChild(label);
                block.appendChild(content);
                textPreviewPages.appendChild(block);
            });
        }

        // ── Get all extracted text as single string ───────────────────
        function getAllText() {
            return extractedPages
                .filter(p => p.lines && p.lines.length > 0)
                .map((p, i) => `--- Page ${i + 1} ---\n${p.lines.join('\n')}`)
                .join('\n\n');
        }

        // ── Copy All button ───────────────────────────────────────────
        copyAllBtn.addEventListener('click', async () => {
            const text = getAllText();
            if (!text.trim()) { alert('No text to copy.'); return; }
            try {
                await navigator.clipboard.writeText(text);
                flashBtn(copyAllBtn, '<i class="fas fa-check"></i> Copied!');
            } catch(e) {
                // fallback: select all and prompt
                selectAllText();
                alert('Could not auto-copy. Text has been selected — press Ctrl+C to copy.');
            }
        });

        // ── Copy Page button (copies text of visible/first page) ──────
        copyPageBtn.addEventListener('click', async () => {
            // Find which page is visible in the scroll viewport
            const blocks = textPreviewPages.querySelectorAll('.text-page-block');
            let targetBlock = blocks[0];
            const containerRect = textPreviewPages.getBoundingClientRect();
            for (const b of blocks) {
                const r = b.getBoundingClientRect();
                if (r.top >= containerRect.top - 10) { targetBlock = b; break; }
            }
            const content = targetBlock ? targetBlock.querySelector('.text-page-content') : null;
            const text = content ? content.textContent : '';
            if (!text.trim()) { alert('No text on this page.'); return; }
            try {
                await navigator.clipboard.writeText(text);
                flashBtn(copyPageBtn, '<i class="fas fa-check"></i> Copied!');
            } catch(e) {
                alert('Copy failed. Please select text manually.');
            }
        });

        // ── Select All button ─────────────────────────────────────────
        selectAllBtn.addEventListener('click', () => {
            selectAllText();
            flashBtn(selectAllBtn, '<i class="fas fa-check"></i> Selected!', true);
        });

        function selectAllText() {
            const range = document.createRange();
            range.selectNodeContents(textPreviewPages);
            const sel = window.getSelection();
            sel.removeAllRanges();
            sel.addRange(range);
            textPreviewPages.focus();
        }

        // ── Search/Find button ────────────────────────────────────────
        searchToggleBtn.addEventListener('click', () => {
            const isOpen = textSearchBar.classList.toggle('active');
            searchToggleBtn.innerHTML = isOpen
                ? '<i class="fas fa-times"></i> Close'
                : '<i class="fas fa-search"></i> Find';
            if (isOpen) {
                searchInput.focus();
                searchInput.value = '';
            } else {
                clearHighlights();
                searchInput.value = '';
            }
        });

        searchInput.addEventListener('input', () => {
            const query = searchInput.value.trim();
            clearHighlights();
            if (query.length < 2) return;
            highlightText(query);
        });

        function highlightText(query) {
            const blocks = textPreviewPages.querySelectorAll('.text-page-content');
            let firstMatch = null;
            blocks.forEach(block => {
                const original = block.textContent;
                const escaped  = query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                const regex    = new RegExp(`(${escaped})`, 'gi');
                if (regex.test(original)) {
                    block.innerHTML = original.replace(regex, '<mark>$1</mark>');
                    if (!firstMatch) firstMatch = block.querySelector('mark');
                }
            });
            if (firstMatch) firstMatch.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function clearHighlights() {
            textPreviewPages.querySelectorAll('.text-page-content').forEach(block => {
                if (block.querySelector('mark')) {
                    block.textContent = block.textContent; // strips HTML including marks
                }
            });
            // Re-render cleanly from extractedPages
            const textPages = extractedPages.filter(p => p.lines && p.lines.length > 0);
            textPreviewPages.querySelectorAll('.text-page-content').forEach((el, i) => {
                if (textPages[i]) el.textContent = textPages[i].lines.join('\n');
            });
        }

        function flashBtn(btn, html, isSelect = false) {
            const orig = btn.innerHTML;
            const origClass = btn.className;
            btn.innerHTML = html;
            if (!isSelect) btn.classList.add('success');
            setTimeout(() => {
                btn.innerHTML = orig;
                btn.className = origClass;
            }, 2000);
        }

        // ── Reset ─────────────────────────────────────────────────────
        function resetAll() {
            selectedFile = null; pdfDocument = null; currentImage = null;
            isImageFile = false; currentPage = 1; totalPages = 1; currentScale = 1.5;
            extractedPages = [];
            fileInput.value = '';
            filePreview.classList.remove('active');
            previewSection.classList.remove('active');
            convertSection.classList.remove('active');
            progressSection.classList.remove('active');
            downloadSection.classList.remove('active');
            textPreviewPanel.classList.remove('active');
            uploadZone.style.display = 'block';
            uploadZone.classList.remove('paste-active');
            pasteHint.style.display    = 'flex';
            pasteSuccess.style.display = 'none';
            textPreviewPages.innerHTML = '';
            textSearchBar.classList.remove('active');
            searchInput.value = '';
            setProgress(0, 'Converting... 0%');
            convertBtn.disabled = false;
            ctx.clearRect(0, 0, previewCanvas.width, previewCanvas.height);
        }
    </script>
</body>
</html>
