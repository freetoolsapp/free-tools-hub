<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5GGQGP06F0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-5GGQGP06F0');
</script>
    <!-- Meta Tags for SEO -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- Primary Meta Tags -->
    <title>PDF to Word Converter - Free Tools Hub</title>
    <meta name="title" content="PDF to Word Converter - Free Tools Hub">
    <meta name="description" content="Convert PDF files and images to editable Word documents with OCR. Free, fast, and no signup required!">
    <meta name="keywords" content="PDF to Word, PDF converter, OCR, image to text, free converter">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="author" content="freetoolsapp">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://freetoolsapp.github.io/free-tools-hub/tools/utility/pdf-to-word.html">
    <meta property="og:title" content="PDF to Word Converter - Free Tools Hub">
    <meta property="og:description" content="Convert PDF files and images to editable Word documents with OCR. Free, fast, and no signup required!">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://freetoolshub.online/tools/utility/pdf-to-word.html">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- Stylesheets -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- PDF.js and Tesseract.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
    
    <style>
        .drop-zone {
            border: 3px dashed #667eea;
            transition: all 0.3s;
        }
        
        .drop-zone.dragover {
            border-color: #4caf50;
            background: #e8f5e9 !important;
            transform: scale(1.02);
        }
        
        .upload-section.dragover {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%) !important;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        .method-card {
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .method-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }
    </style>
    <link rel="stylesheet" href="../../header-new.css">
    <!-- PWA -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#5b21b6">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Free Tools Hub">
    <link rel="apple-touch-icon" href="/icon-192.png">
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <div id="site-header"></div>
<script src="../../header.js"></script>

    <!-- Breadcrumb -->
    <div class="bg-white border-b">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center text-sm text-gray-600">
                <a href="../../index.html" class="hover:text-blue-600"><i class="fas fa-home mr-1"></i>Home</a>
                <i class="fas fa-chevron-right mx-2 text-gray-400"></i>
                <a href="../../index.html#tools" class="hover:text-blue-600">Tools</a>
                <i class="fas fa-chevron-right mx-2 text-gray-400"></i>
                <span class="text-gray-800 font-medium">PDF to Word Converter</span>
            </div>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white py-12">
        <div class="container mx-auto px-4 text-center">
            <div class="w-20 h-20 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur">
                <i class="fas fa-file-word text-5xl"></i>
            </div>
            <h2 class="text-4xl md:text-5xl font-bold mb-4">PDF/Image to Word Converter</h2>
            <p class="text-xl mb-2">Convert PDFs and images to editable Word documents with OCR</p>
            <p class="text-sm opacity-90"><i class="fas fa-check-circle mr-1"></i>Free ‚Ä¢ No Signup ‚Ä¢ Instant Results ‚Ä¢ Preserves Formatting</p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="py-12">
        <div class="container mx-auto px-4 max-w-6xl">
            
            <!-- Upload Section -->
            <div id="uploadSection" class="bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg shadow-lg p-8 mb-8 transition-all duration-300">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">
                    <i class="fas fa-upload text-blue-600 mr-2"></i>Upload Your File
                </h3>
                
                <div id="dropZone" class="drop-zone bg-white rounded-xl p-12 text-center" style="position:relative; overflow:hidden;">
                    <i class="fas fa-cloud-upload-alt text-6xl text-blue-600 mb-4" style="pointer-events:none;"></i>
                    <h4 class="text-xl font-bold text-gray-800 mb-2" style="pointer-events:none;">Tap or Click to Upload</h4>
                    <p class="text-gray-600 mb-4" style="pointer-events:none;">Supports: PDF, JPG, PNG, JPEG ‚Ä¢ Max 100MB</p>
                    <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-lg font-semibold inline-block" style="pointer-events:none;">
                        <i class="fas fa-folder-open mr-2"></i>Browse Files
                    </div>
                    <!-- Input covers entire drop zone - works on all mobile browsers -->
                    <input type="file" id="fileInput" accept=".pdf,.png,.jpg,.jpeg,image/*"
                        style="position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer;font-size:16px;">
                </div>

            </div>

            <!-- File Info -->
            <div id="fileInfo" class="hidden bg-blue-50 border-2 border-blue-300 rounded-lg p-4 mb-6">
                <strong class="text-blue-800"><i class="fas fa-file text-blue-600 mr-2"></i>File:</strong> 
                <span id="fileName" class="text-blue-900"></span>
            </div>

            <!-- Processing Section -->
            <div id="processing" class="hidden bg-white rounded-lg shadow-lg p-8 mb-8">
                <div class="text-center">
                    <div class="spinner mb-4"></div>
                    <h3 id="processingMsg" class="text-xl font-bold text-gray-800 mb-2">‚ö° Processing your file...</h3>
                    <p class="text-gray-600 mb-4">This may take a few moments depending on file size</p>
                    <div class="bg-gray-200 h-8 rounded-full overflow-hidden max-w-md mx-auto">
                        <div id="progressFill" class="bg-gradient-to-r from-blue-600 to-purple-600 h-full flex items-center justify-center text-white font-bold transition-all duration-300" style="width: 0%">
                            0%
                        </div>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="results" class="hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Preview Box -->
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-eye text-blue-600 mr-2"></i>
                            Preview
                        </h3>
                        <div class="bg-gray-50 rounded-lg p-4 border-2 border-gray-200 max-h-96 overflow-auto" id="previewContainer">
                            <!-- preview inserted here dynamically -->
                        </div>
                    </div>

                    <!-- Extracted Text -->
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-file-alt text-green-600 mr-2"></i>
                            Extracted Text
                        </h3>
                        <textarea id="extractedText" class="w-full h-64 p-4 border-2 border-gray-200 rounded-lg font-mono text-sm resize-vertical focus:border-blue-500 focus:outline-none" placeholder="Extracted text will appear here..."></textarea>
                        
                        <div class="flex flex-col gap-3 mt-4">
                            <button onclick="downloadWordDoc()" class="bg-gradient-to-r from-green-600 to-green-700 text-white px-6 py-3 rounded-lg font-semibold hover:shadow-lg transition flex items-center justify-center">
                                <i class="fas fa-file-word mr-2 text-xl"></i>Download as Word (.doc)
                            </button>
                            <button onclick="copyText()" class="bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-lg font-semibold hover:shadow-lg transition flex items-center justify-center">
                                <i class="fas fa-copy mr-2"></i>Copy Text to Clipboard
                            </button>
                            <button onclick="location.reload()" class="bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-700 transition flex items-center justify-center">
                                <i class="fas fa-redo mr-2"></i>Convert Another File
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Features & Tips ‚Äî moved below preview window -->
            <div class="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-6 mt-8">
                    <h4 class="font-bold text-yellow-800 mb-3 flex items-center">
                        <i class="fas fa-lightbulb text-yellow-600 mr-2 text-xl"></i>
                        Features & Tips
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-yellow-800">
                        <div><i class="fas fa-check-circle text-green-600 mr-2"></i>Preserves paragraphs & line breaks</div>
                        <div><i class="fas fa-check-circle text-green-600 mr-2"></i>Maintains numbers & formatting</div>
                        <div><i class="fas fa-check-circle text-green-600 mr-2"></i>PDF text extraction with structure</div>
                        <div><i class="fas fa-check-circle text-green-600 mr-2"></i>Image OCR for English text</div>
                        <div><i class="fas fa-check-circle text-green-600 mr-2"></i>Download as proper .doc file</div>
                        <div><i class="fas fa-check-circle text-green-600 mr-2"></i>Copy formatted text to clipboard</div>
                    </div>
                </div>

            <!-- Features Section -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-12">
                <div class="bg-white rounded-lg shadow p-6 text-center hover:shadow-xl transition">
                    <i class="fas fa-shield-alt text-4xl text-green-600 mb-3"></i>
                    <h4 class="font-bold text-gray-800 mb-2">100% Secure</h4>
                    <p class="text-sm text-gray-600">Your files are processed locally in your browser</p>
                </div>
                <div class="bg-white rounded-lg shadow p-6 text-center hover:shadow-xl transition">
                    <i class="fas fa-bolt text-4xl text-yellow-600 mb-3"></i>
                    <h4 class="font-bold text-gray-800 mb-2">Lightning Fast</h4>
                    <p class="text-sm text-gray-600">Get results in seconds with our optimized engine</p>
                </div>
                <div class="bg-white rounded-lg shadow p-6 text-center hover:shadow-xl transition">
                    <i class="fas fa-user-slash text-4xl text-blue-600 mb-3"></i>
                    <h4 class="font-bold text-gray-800 mb-2">No Signup</h4>
                    <p class="text-sm text-gray-600">Use instantly without registration or downloads</p>
                </div>
                <div class="bg-white rounded-lg shadow p-6 text-center hover:shadow-xl transition">
                    <i class="fas fa-magic text-4xl text-purple-600 mb-3"></i>
                    <h4 class="font-bold text-gray-800 mb-2">Smart OCR</h4>
                    <p class="text-sm text-gray-600">Advanced text recognition with structure preservation</p>
                </div>
            </div>

        </div>
    </main>

    <!-- Related Tools Section -->
    <section class="bg-white py-12 border-t">
        <div class="container mx-auto px-4">
            <h3 class="text-2xl font-bold text-gray-800 mb-8 text-center">
                <i class="fas fa-tools text-blue-600 mr-2"></i>Related Tools You Might Like
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-6xl mx-auto">
                <a href="../utility/word-counter.html" class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg shadow hover:shadow-xl transition p-6 border-2 border-blue-200 block">
                    <i class="fas fa-hashtag text-3xl text-blue-600 mb-3"></i>
                    <h4 class="font-bold text-gray-800 mb-2">Word Counter</h4>
                    <p class="text-sm text-gray-600">Count words, characters, and reading time</p>
                </a>
                <a href="../utility/password-generator.html" class="bg-gradient-to-br from-red-50 to-red-100 rounded-lg shadow hover:shadow-xl transition p-6 border-2 border-red-200 block">
                    <i class="fas fa-key text-3xl text-red-600 mb-3"></i>
                    <h4 class="font-bold text-gray-800 mb-2">Password Generator</h4>
                    <p class="text-sm text-gray-600">Generate strong secure passwords</p>
                </a>
                <a href="../student/gpa-calculator.html" class="bg-gradient-to-br from-teal-50 to-teal-100 rounded-lg shadow hover:shadow-xl transition p-6 border-2 border-teal-200 block">
                    <i class="fas fa-calculator text-3xl text-teal-600 mb-3"></i>
                    <h4 class="font-bold text-gray-800 mb-2">GPA Calculator</h4>
                    <p class="text-sm text-gray-600">Calculate your GPA instantly</p>
                </a>
                <a href="../utility/age-calculator.html" class="bg-gradient-to-br from-pink-50 to-pink-100 rounded-lg shadow hover:shadow-xl transition p-6 border-2 border-pink-200 block">
                    <i class="fas fa-birthday-cake text-3xl text-pink-600 mb-3"></i>
                    <h4 class="font-bold text-gray-800 mb-2">Age Calculator</h4>
                    <p class="text-sm text-gray-600">Calculate your exact age</p>
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-5 gap-8">
                <div>
                    <h3 class="font-bold text-lg mb-4">
                        <i class="fas fa-tools mr-2"></i>Free Tools Hub
                    </h3>
                    <p class="text-gray-400 text-sm">Your complete hub for free online tools, expert blogs, and curated resources. Fast, simple, and secure.</p>
                </div>
                <div>
                    <h4 class="font-bold mb-4">Categories</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="../../index.html#tools" class="hover:text-white transition"><i class="fas fa-wrench mr-2"></i>Utility Tools</a></li>
                        <li><a href="../../index.html#tools" class="hover:text-white transition"><i class="fas fa-graduation-cap mr-2"></i>Student Tools</a></li>
                        <li><a href="../../index.html#tools" class="hover:text-white transition"><i class="fas fa-palette mr-2"></i>Design Tools</a></li>
                        <li><a href="../../index.html#tools" class="hover:text-white transition"><i class="fas fa-chart-line mr-2"></i>SEO Tools</a></li>
                        <li><a href="../../index.html#tools" class="hover:text-white transition"><i class="fas fa-code mr-2"></i>Web Dev Tools</a></li>
                        <li><a href="../../index.html#tools" class="hover:text-white transition"><i class="fab fa-instagram mr-2"></i>Social Media</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-4">Resources</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="../../blog.html" class="hover:text-white transition"><i class="fas fa-blog mr-2"></i>Blog</a></li>
                        <li><a href="../../tutorials.html" class="hover:text-white transition"><i class="fas fa-chalkboard-teacher mr-2"></i>Tutorials</a></li>
                        <li><a href="../../resources.html" class="hover:text-white transition"><i class="fas fa-book mr-2"></i>Resources</a></li>
                        <li><a href="../../comparisons.html" class="hover:text-white transition"><i class="fas fa-balance-scale mr-2"></i>Compare Tools</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-4">Company</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="../../about.html" class="hover:text-white transition"><i class="fas fa-info-circle mr-2"></i>About Us</a></li>
                        <li><a href="../../contact.html" class="hover:text-white transition"><i class="fas fa-envelope mr-2"></i>Contact</a></li>
                        <li><a href="../../privacy.html" class="hover:text-white transition"><i class="fas fa-shield-alt mr-2"></i>Privacy Policy</a></li>
                        <li><a href="../../terms.html" class="hover:text-white transition"><i class="fas fa-file-contract mr-2"></i>Terms of Service</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-4">Connect</h4>
                    <div class="flex space-x-4 text-2xl mb-4">
                        <a href="#" class="hover:text-blue-400 transition" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="hover:text-blue-600 transition" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="hover:text-red-500 transition" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="#" class="hover:text-pink-500 transition" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    </div>
                    <p class="text-gray-400 text-xs">by freetoolsapp</p>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-sm text-gray-400">
                <p>&copy; 2025 Free Tools Hub. All rights reserved. Made with <i class="fas fa-heart text-red-500"></i> for creators and learners.</p>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <button id="backToTop" class="fixed bottom-8 right-8 bg-gradient-to-r from-blue-600 to-purple-600 text-white w-12 h-12 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 hidden z-50" aria-label="Back to top">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Scripts -->
    <script>
        // PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        
        let currentText = '';

        // ‚îÄ‚îÄ Safe mobile menu (header.js loads async, elements may not exist yet) ‚îÄ‚îÄ
        function initMobileMenu() {
            var btn  = document.getElementById('mobileMenuBtn');
            var menu = document.getElementById('mobileMenu');
            if (!btn || !menu || btn._ready) return;
            btn._ready = true;
            btn.addEventListener('click', function() {
                menu.classList.toggle('hidden');
                var ic = btn.querySelector('i');
                if (ic) { ic.classList.toggle('fa-bars'); ic.classList.toggle('fa-times'); }
            });
            document.addEventListener('click', function(e) {
                if (!btn.contains(e.target) && !menu.contains(e.target)) {
                    menu.classList.add('hidden');
                    var ic = btn.querySelector('i');
                    if (ic) { ic.classList.remove('fa-times'); ic.classList.add('fa-bars'); }
                }
            });
        }
        initMobileMenu();
        setTimeout(initMobileMenu, 300);
        setTimeout(initMobileMenu, 1000);
        setTimeout(initMobileMenu, 2500);

        // ‚îÄ‚îÄ Back to top ‚îÄ‚îÄ
        var backToTop = document.getElementById('backToTop');
        window.addEventListener('scroll', function() {
            if (window.scrollY > 300) backToTop.classList.remove('hidden');
            else backToTop.classList.add('hidden');
        });
        backToTop.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // ‚îÄ‚îÄ File upload ‚îÄ‚îÄ
        var dropZone      = document.getElementById('dropZone');
        var uploadSection = document.getElementById('uploadSection');
        var fileInput     = document.getElementById('fileInput');

        // Prevent default drag behaviors
        ['dragenter','dragover','dragleave','drop'].forEach(function(ev) {
            dropZone.addEventListener(ev, preventDefaults, false);
            document.body.addEventListener(ev, preventDefaults, false);
        });
        function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }

        // Drag highlight
        ['dragenter','dragover'].forEach(function(ev) {
            dropZone.addEventListener(ev, function() {
                dropZone.classList.add('dragover');
                uploadSection.classList.add('dragover');
            });
        });
        ['dragleave','drop'].forEach(function(ev) {
            dropZone.addEventListener(ev, function() {
                dropZone.classList.remove('dragover');
                uploadSection.classList.remove('dragover');
            });
        });

        // Drop
        dropZone.addEventListener('drop', function(e) {
            var files = e.dataTransfer && e.dataTransfer.files;
            if (files && files.length > 0) processFile(files[0]);
        });

        // ‚îÄ‚îÄ FILE INPUT CHANGE ‚Äî main trigger ‚îÄ‚îÄ
        fileInput.addEventListener('change', function(e) {
            var file = e.target.files && e.target.files[0];
            if (file) {
                processFile(file);
                try { fileInput.value = ''; } catch(ex) {}
            }
        });

        // Paste (Ctrl+V images)
        window.addEventListener('paste', function(e) {
            var items = e.clipboardData && e.clipboardData.items;
            if (!items) return;
            for (var i = 0; i < items.length; i++) {
                if (items[i].type.indexOf('image') !== -1) {
                    e.preventDefault();
                    var blob = items[i].getAsFile();
                    processFile(blob);
                    return;
                }
            }
        });

        // ‚îÄ‚îÄ Detect file type robustly (name extension fallback) ‚îÄ‚îÄ
        function getFileType(file) {
            if (file.type === 'application/pdf') return 'pdf';
            if (file.type && file.type.startsWith('image/')) return 'image';
            // Fallback to extension
            var name = (file.name || '').toLowerCase();
            if (name.endsWith('.pdf')) return 'pdf';
            if (name.endsWith('.jpg') || name.endsWith('.jpeg') ||
                name.endsWith('.png') || name.endsWith('.gif') ||
                name.endsWith('.bmp') || name.endsWith('.webp')) return 'image';
            return null;
        }

        async function processFile(file) {
            var fileType = getFileType(file);

            if (!fileType) {
                alert('‚ùå Please upload a PDF or image file (JPG, PNG, JPEG)');
                return;
            }

            if (file.size > 100 * 1024 * 1024) {
                alert('‚ùå File too large! Please upload a file smaller than 100MB');
                return;
            }

            // Show file name
            document.getElementById('fileName').textContent = file.name || 'Uploaded File';
            document.getElementById('fileInfo').classList.remove('hidden');

            // Show processing, hide results
            document.getElementById('processing').classList.remove('hidden');
            document.getElementById('results').classList.add('hidden');
            updateProgress(0);

            // ‚îÄ‚îÄ Show preview ‚îÄ‚îÄ
            var previewContainer = document.getElementById('previewContainer');
            previewContainer.innerHTML = ''; // clear old preview

            try {
                let text = '';

                if (fileType === 'pdf') {
                    document.getElementById('processingMsg').textContent = 'üìÑ Extracting PDF with formatting...';

                    // For PDF preview: render page 1 to canvas ‚Üí image
                    var arrayBuffer = await file.arrayBuffer();
                    var pdf = await pdfjsLib.getDocument({data: arrayBuffer}).promise;

                    // Render page 1 preview
                    var page1 = await pdf.getPage(1);
                    var viewport = page1.getViewport({scale: 1.0});
                    var canvas = document.createElement('canvas');
                    canvas.width  = viewport.width;
                    canvas.height = viewport.height;
                    canvas.style.maxWidth = '100%';
                    canvas.style.borderRadius = '8px';
                    await page1.render({canvasContext: canvas.getContext('2d'), viewport: viewport}).promise;
                    previewContainer.appendChild(canvas);

                    // Extract text from all pages
                    text = await extractTextFromPDF(pdf);

                } else {
                    document.getElementById('processingMsg').textContent = 'üîç Performing OCR with structure detection...';

                    // Show image preview
                    var img = document.createElement('img');
                    img.style.maxWidth = '100%';
                    img.style.borderRadius = '8px';
                    img.style.display = 'block';
                    img.style.margin = '0 auto';
                    var imgURL = URL.createObjectURL(file);
                    img.src = imgURL;
                    previewContainer.appendChild(img);

                    text = await extractFromImage(file);
                    URL.revokeObjectURL(imgURL);
                }

                currentText = text;
                document.getElementById('extractedText').value = text;
                document.getElementById('processing').classList.add('hidden');
                document.getElementById('results').classList.remove('hidden');
                updateProgress(100);

                document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });

            } catch (error) {
                alert('‚ùå Error: ' + error.message + '\n\nPlease try again with a different file.');
                document.getElementById('processing').classList.add('hidden');
                console.error('Processing error:', error);
            }
        }

        // ‚îÄ‚îÄ Extract text from already-loaded PDF object ‚îÄ‚îÄ
        async function extractTextFromPDF(pdf) {
            let fullText = '';

            for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
                const page = await pdf.getPage(pageNum);
                const textContent = await page.getTextContent();
                const lines = {};

                textContent.items.forEach(function(item) {
                    var y = Math.round(item.transform[5]);
                    if (!lines[y]) lines[y] = [];
                    lines[y].push({ text: item.str, x: item.transform[4] });
                });

                var sortedY = Object.keys(lines).sort(function(a, b) { return b - a; });
                var lastY = null;
                var pageText = '';

                sortedY.forEach(function(y) {
                    lines[y].sort(function(a, b) { return a.x - b.x; });
                    var lineText = lines[y].map(function(i) { return i.text; }).join(' ').trim();
                    if (lineText) {
                        if (lastY !== null && (lastY - y) > 20) {
                            pageText += '\n\n';
                        }
                        pageText += lineText + '\n';
                        lastY = parseInt(y);
                    }
                });

                fullText += pageText;
                if (pageNum < pdf.numPages) {
                    fullText += '\n\n--- Page ' + (pageNum + 1) + ' ---\n\n';
                }

                updateProgress(Math.round((pageNum / pdf.numPages) * 100));
            }

            return fullText;
        }

        // ‚îÄ‚îÄ Image OCR ‚îÄ‚îÄ
        async function extractFromImage(file) {
            return new Promise(function(resolve, reject) {
                var img = new Image();
                var reader = new FileReader();

                reader.onload = function(e) {
                    img.src = e.target.result;
                    img.onload = async function() {
                        try {
                            var canvas = document.createElement('canvas');
                            var ctx = canvas.getContext('2d');
                            var width = img.width;
                            var height = img.height;
                            var maxWidth = 2400;

                            if (width > maxWidth) {
                                height = Math.round((height * maxWidth) / width);
                                width = maxWidth;
                            }

                            canvas.width  = width;
                            canvas.height = height;
                            ctx.filter = 'contrast(1.3) brightness(1.1)';
                            ctx.drawImage(img, 0, 0, width, height);

                            updateProgress(10);

                            var result = await Tesseract.recognize(
                                canvas,
                                'eng',
                                {
                                    logger: function(m) {
                                        if (m.status === 'recognizing text') {
                                            updateProgress(10 + Math.round(m.progress * 85));
                                        }
                                    }
                                }
                            );

                            var lines = result.data.lines;
                            var formattedText = '';
                            var lastY = 0;

                            lines.forEach(function(line, index) {
                                var lineText = line.text.trim();
                                if (lineText) {
                                    var currentY = line.bbox.y0;
                                    if (index > 0 && (currentY - lastY) > 50) {
                                        formattedText += '\n\n';
                                    }
                                    formattedText += lineText + '\n';
                                    lastY = line.bbox.y1;
                                }
                            });

                            resolve(formattedText);
                        } catch (err) {
                            reject(err);
                        }
                    };
                    img.onerror = function() { reject(new Error('Image load failed')); };
                };
                reader.onerror = function() { reject(new Error('File read failed')); };
                reader.readAsDataURL(file);
            });
        }

        function updateProgress(percent) {
            var fill = document.getElementById('progressFill');
            fill.style.width = percent + '%';
            fill.textContent = percent + '%';
        }

        function copyText() {
            var text = document.getElementById('extractedText').value;
            if (!text.trim()) { alert('‚ùå No text to copy!'); return; }
            navigator.clipboard.writeText(text).then(function() {
                alert('‚úÖ Text copied successfully!\n\nüìã Paste in Word with Ctrl+V');
            }).catch(function() {
                // Fallback for older browsers
                var ta = document.getElementById('extractedText');
                ta.select();
                document.execCommand('copy');
                alert('‚úÖ Text copied!');
            });
        }

        function downloadWordDoc() {
            var text = document.getElementById('extractedText').value;
            if (!text.trim()) { alert('‚ùå No text to download!'); return; }

            var paragraphs = text.split('\n\n').map(function(para) {
                var lines = para.split('\n').filter(function(l) { return l.trim(); });
                return lines.map(function(line) {
                    return '<p>' + escapeHtml(line.trim()) + '</p>';
                }).join('\n');
            }).join('\n');

            var htmlContent = "<!DOCTYPE html>\n" +
"<html xmlns:o='urn:schemas-microsoft-com:office:office'\n" +
"      xmlns:w='urn:schemas-microsoft-com:office:word'\n" +
"      xmlns='http://www.w3.org/TR/REC-html40'>\n" +
"<head><meta charset='utf-8'><title>Extracted Text</title>\n" +
"<!--[if gte mso 9]><xml><w:WordDocument><w:View>Print</w:View>" +
"<w:Zoom>100</w:Zoom><w:DoNotOptimizeForBrowser/></w:WordDocument></xml><![endif]-->\n" +
"<style>body{font-family:'Calibri','Arial',sans-serif;font-size:11pt;line-height:1.5;margin:1in;}" +
"p{margin:0 0 10pt 0;text-align:justify;}</style></head>\n" +
"<body>\n" + paragraphs + "\n</body></html>";

            var blob = new Blob(['\ufeff', htmlContent], { type: 'application/msword' });
            var url  = URL.createObjectURL(blob);
            var link = document.createElement('a');
            link.href = url;
            link.download = 'extracted_' + Date.now() + '.doc';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);

            setTimeout(function() {
                alert('‚úÖ Word Document downloaded!\n\nüí° Open with Microsoft Word for best results');
            }, 500);
        }

        function escapeHtml(text) {
            var div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function() { console.log('SW registered'); })
                    .catch(function(err) { console.log('SW error:', err); });
            });
        }
    </script>
</body>
</html>
