<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5GGQGP06F0"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-5GGQGP06F0');</script>
    
    <!-- Primary SEO Meta Tags -->
    <title>Crop PDF Pages Online Free — Visual PDF Cropping Tool 2026 | Free Tools Hub</title>
    <meta name="title" content="Crop PDF Pages Online Free — Interactive PDF Cropper with Visual Selection">
    <meta name="description" content="Crop PDF pages with visual selection tool 2026. Drag and resize crop box to select exact area. Free online PDF cropper — no signup, no watermarks. Trim margins, remove white space. 100% browser-based & secure.">
    <meta name="keywords" content="crop PDF, crop PDF pages, PDF cropper, trim PDF margins, remove PDF margins, crop PDF online free, visual PDF crop, interactive PDF cropper, resize PDF pages 2026">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="author" content="Free Tools Hub">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://freetoolshub.online/tools/pdf/crop-pdf-pages.html">
    <meta property="og:site_name" content="Free Tools Hub">
    <meta property="og:title" content="Crop PDF Pages Online Free — Visual Selection Tool">
    <meta property="og:description" content="Crop PDF pages with drag-and-drop selector. Free, no signup, visual preview. Trim margins instantly.">
    <meta property="og:image" content="https://freetoolshub.online/images/crop-pdf-og.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@freetoolshub">
    <meta name="twitter:title" content="Crop PDF Pages — Visual Tool">
    <meta name="twitter:description" content="Crop PDF pages with visual selector. 100% free.">
    <meta name="twitter:image" content="https://freetoolshub.online/images/crop-pdf-twitter.jpg">
    
    <!-- Canonical -->
    <link rel="canonical" href="https://freetoolshub.online/tools/pdf/crop-pdf-pages.html">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- Schema Markup -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Crop PDF Pages",
        "alternateName": "PDF Cropper Tool",
        "url": "https://freetoolshub.online/tools/pdf/crop-pdf-pages.html",
        "description": "Free visual PDF cropping tool. Drag and resize crop box to select exact area. Trim margins, remove white space from PDF pages.",
        "applicationCategory": "UtilityApplication",
        "operatingSystem": "Any",
        "browserRequirements": "Requires JavaScript",
        "offers": {"@type": "Offer", "price": "0", "priceCurrency": "USD", "availability": "https://schema.org/InStock"},
        "featureList": ["Visual crop selector", "Drag and resize", "Live preview", "All pages at once", "Browser-based", "No upload to server"],
        "aggregateRating": {"@type": "AggregateRating", "ratingValue": "4.8", "ratingCount": "2340", "bestRating": "5"},
        "creator": {"@type": "Organization", "name": "Free Tools Hub", "url": "https://freetoolshub.online"},
        "datePublished": "2026-01-20",
        "dateModified": "2026-02-21"
    }
    </script>
    
    <!-- FAQ Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {"@type":"Question","name":"How do I crop PDF pages?","acceptedAnswer":{"@type":"Answer","text":"Upload your PDF, preview the pages, drag the crop box to select the area you want to keep, resize by dragging corners, then click Crop PDF to apply and download."}},
            {"@type":"Question","name":"Is this PDF cropper free?","acceptedAnswer":{"@type":"Answer","text":"Yes, 100% free. No registration, no watermarks, no hidden costs. Unlimited use."}},
            {"@type":"Question","name":"Can I crop all pages at once?","acceptedAnswer":{"@type":"Answer","text":"Yes, the crop selection applies to all pages in your PDF document. All pages will be cropped with the same dimensions."}},
            {"@type":"Question","name":"Are my files safe?","acceptedAnswer":{"@type":"Answer","text":"Absolutely. All processing happens in your browser. Files are never uploaded to any server."}}
        ]
    }
    </script>
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../../style.css">
    
    <!-- PDF.js & PDF-lib -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    
    <style>
        .tool-hero{background:linear-gradient(135deg,#7c3aed,#6d28d9);color:white;padding:64px 0 48px;position:relative;overflow:hidden;}
        .tool-hero::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse 60% 70% at 70% 30%,rgba(236,72,153,.18) 0%,transparent 60%);}
        .tool-hero-inner{position:relative;z-index:1;text-align:center;}
        .tool-icon-lg{width:80px;height:80px;background:rgba(255,255,255,.12);backdrop-filter:blur(8px);border-radius:var(--radius-xl);display:flex;align-items:center;justify-content:center;margin:0 auto 24px;font-size:36px;}
        
        .upload-card{background:white;border:1.5px solid var(--gray-200);border-radius:var(--radius-xl);padding:40px;margin-bottom:32px;}
        .upload-zone{border:2px dashed var(--gray-300);border-radius:var(--radius-lg);padding:56px 24px;text-align:center;cursor:pointer;transition:var(--transition);position:relative;}
        .upload-zone:hover,.upload-zone.drag-over{border-color:var(--purple-500);background:rgba(124,58,237,.05);}
        .upload-zone input{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;}
        .upload-icon{width:80px;height:80px;border-radius:var(--radius-xl);background:rgba(124,58,237,.1);color:var(--purple-600);display:flex;align-items:center;justify-content:center;font-size:36px;margin:0 auto 20px;}
        
        .crop-container{background:white;border:1.5px solid var(--gray-200);border-radius:var(--radius-xl);padding:32px;margin-bottom:32px;display:none;}
        .crop-container.active{display:block;}
        
        .preview-canvas-wrap{position:relative;display:inline-block;border:2px solid var(--gray-300);border-radius:var(--radius-md);overflow:hidden;background:var(--gray-50);max-width:100%;}
        .preview-canvas{display:block;max-width:100%;height:auto;}
        
        .crop-box{position:absolute;border:3px solid var(--purple-600);box-shadow:0 0 0 9999px rgba(0,0,0,.4);cursor:move;background:transparent;}
        .crop-box::before{content:'';position:absolute;inset:-3px;border:3px dashed rgba(255,255,255,.5);pointer-events:none;}
        
        .crop-handle{position:absolute;width:12px;height:12px;background:white;border:2px solid var(--purple-600);border-radius:50%;cursor:pointer;}
        .crop-handle.tl{top:-6px;left:-6px;cursor:nwse-resize;}
        .crop-handle.tr{top:-6px;right:-6px;cursor:nesw-resize;}
        .crop-handle.bl{bottom:-6px;left:-6px;cursor:nesw-resize;}
        .crop-handle.br{bottom:-6px;right:-6px;cursor:nwse-resize;}
        
        .info-banner{background:var(--purple-50);border-left:4px solid var(--purple-600);padding:16px 20px;border-radius:var(--radius-md);margin-bottom:24px;}
        .info-banner-text{font-size:14px;color:var(--purple-900);line-height:1.6;}
        
        .processing-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);display:none;align-items:center;justify-content:center;z-index:1000;}
        .processing-overlay.active{display:flex;}
        .processing-card{background:white;border-radius:var(--radius-xl);padding:48px;text-align:center;max-width:420px;box-shadow:var(--shadow-xl);}
        .spinner{width:64px;height:64px;border:4px solid var(--gray-200);border-top-color:var(--purple-600);border-radius:50%;animation:spin .8s linear infinite;margin:0 auto 24px;}
        
        .related-tools{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-top:32px;}
        .related-tool{background:var(--gray-50);border:1.5px solid var(--gray-200);border-radius:var(--radius-lg);padding:20px;text-align:center;text-decoration:none;transition:var(--transition);display:block;}
        .related-tool:hover{border-color:var(--purple-500);transform:translateY(-2px);box-shadow:var(--shadow);}
        .related-tool-icon{width:48px;height:48px;border-radius:var(--radius-md);display:flex;align-items:center;justify-content:center;font-size:22px;margin:0 auto 12px;}
        .related-tool-title{font-weight:700;font-size:14px;color:var(--gray-800);margin-bottom:6px;font-family:var(--font-display);}
        .related-tool-desc{font-size:12px;color:var(--gray-500);}
        
        @media(max-width:768px){.related-tools{grid-template-columns:1fr;}}
        @keyframes spin{to{transform:rotate(360deg);}}
    </style>
</head>
<body>

    <header class="site-header" id="siteHeader">
        <div class="container">
            <div class="header-inner">
                <a href="../../index.html" class="site-logo">
                    <div class="logo-icon"><i class="fas fa-bolt"></i></div>
                    <div class="logo-text"><span class="logo-name">Free Tools Hub</span><span class="logo-tagline">Tools · Blogs · Resources</span></div>
                </a>
                <nav class="main-nav">
                    <a href="../../index.html"><i class="fas fa-home"></i>Home</a>
                    <a href="../../tools.html" class="active"><i class="fas fa-tools"></i>All Tools</a>
                    <a href="../../blog.html"><i class="fas fa-pen-nib"></i>Blog</a>
                    <a href="../../education.html"><i class="fas fa-graduation-cap"></i>Education</a>
                    <a href="../../resources.html"><i class="fas fa-layer-group"></i>Resources</a>
                    <a href="../../tutorials.html"><i class="fas fa-play-circle"></i>Tutorials</a>
                    <a href="../../contact.html" class="nav-cta"><i class="fas fa-paper-plane"></i>Contact</a>
                </nav>
                <button class="mobile-menu-btn" id="mobileMenuBtn" aria-expanded="false"><i class="fas fa-bars"></i></button>
            </div>
        </div>
        <nav class="mobile-nav" id="mobileMenu">
            <a href="../../index.html"><i class="fas fa-home"></i>Home</a>
            <a href="../../tools.html" class="active"><i class="fas fa-tools"></i>All Tools</a>
            <a href="../../blog.html"><i class="fas fa-pen-nib"></i>Blog</a>
            <a href="../../education.html"><i class="fas fa-graduation-cap"></i>Education</a>
            <a href="../../resources.html"><i class="fas fa-layer-group"></i>Resources</a>
            <a href="../../tutorials.html"><i class="fas fa-play-circle"></i>Tutorials</a>
            <a href="../../contact.html" class="nav-cta"><i class="fas fa-paper-plane"></i>Contact</a>
        </nav>
    </header>

    <div class="breadcrumb" style="background:white;border-bottom:1px solid var(--gray-200);padding:12px 0;"><div class="container"><div style="display:flex;align-items:center;gap:8px;font-size:13px;color:var(--gray-500);">
        <a href="../../index.html" style="color:var(--gray-500);"><i class="fas fa-home"></i> Home</a>
        <span style="color:var(--gray-300);"><i class="fas fa-chevron-right"></i></span>
        <a href="../../tools.html" style="color:var(--gray-500);">Tools</a>
        <span style="color:var(--gray-300);"><i class="fas fa-chevron-right"></i></span>
        <span style="color:var(--gray-800);font-weight:500;">Crop PDF Pages</span>
    </div></div></div>

    <section class="tool-hero">
        <div class="container tool-hero-inner">
            <div class="tool-icon-lg"><i class="fas fa-crop-alt"></i></div>
            <div class="hero-badge" style="margin-bottom:16px;"><i class="fas fa-star"></i><span>Visual Selection Tool</span></div>
            <h1 style="font-size:clamp(2.2rem,4vw,3.2rem);font-weight:800;letter-spacing:-.03em;margin-bottom:12px;">Crop PDF Pages</h1>
            <p style="font-size:1.05rem;opacity:.85;font-weight:300;max-width:560px;margin:0 auto 16px;">Trim PDF margins with visual crop selector — drag, resize & crop instantly</p>
            <div style="display:flex;justify-content:center;gap:16px;flex-wrap:wrap;font-size:13px;opacity:.80;">
                <span><i class="fas fa-check-circle"></i> Visual Selector</span>
                <span><i class="fas fa-check-circle"></i> Drag & Resize</span>
                <span><i class="fas fa-check-circle"></i> Live Preview</span>
                <span><i class="fas fa-check-circle"></i> 100% Free</span>
            </div>
        </div>
    </section>

    <main style="background:var(--gray-50);padding:56px 0;">
        <div class="container" style="max-width:1000px;">

            <!-- Upload Card -->
            <div class="upload-card" id="uploadCard">
                <h2 style="font-family:var(--font-display);font-size:1.6rem;font-weight:800;color:var(--gray-900);margin-bottom:28px;text-align:center;display:flex;align-items:center;justify-content:center;gap:12px;">
                    <i class="fas fa-file-pdf" style="color:var(--purple-600);"></i> Upload Your PDF File
                </h2>
                
                <div class="upload-zone" id="uploadZone">
                    <input type="file" id="fileInput" accept=".pdf">
                    <div class="upload-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                    <p style="font-size:19px;font-weight:700;color:var(--gray-800);margin-bottom:8px;">Drop your PDF here</p>
                    <p style="font-size:14px;color:var(--gray-500);">or click to browse • PDF files only • Max 50MB</p>
                </div>
            </div>

            <!-- Crop Selection Card -->
            <div class="crop-container" id="cropCard">
                
                <div class="info-banner">
                    <div class="info-banner-text"><i class="fas fa-info-circle"></i> <strong>How to crop:</strong> Drag the purple box to select the area you want to keep. Resize by dragging the corner handles. Click "Crop PDF" when ready.</div>
                </div>

                <h3 style="font-family:var(--font-display);font-size:1.4rem;font-weight:800;color:var(--gray-900);margin-bottom:8px;text-align:center;">
                    <i class="fas fa-crop-alt" style="color:var(--purple-600);"></i> Select Crop Area
                </h3>
                <p style="font-size:14px;color:var(--gray-500);text-align:center;margin-bottom:32px;">Drag and resize the purple box to select the area to keep</p>

                <div style="text-align:center;margin-bottom:32px;">
                    <div class="preview-canvas-wrap" id="canvasWrap">
                        <canvas id="pdfCanvas" class="preview-canvas"></canvas>
                        <div class="crop-box" id="cropBox">
                            <div class="crop-handle tl"></div>
                            <div class="crop-handle tr"></div>
                            <div class="crop-handle bl"></div>
                            <div class="crop-handle br"></div>
                        </div>
                    </div>
                </div>

                <div style="background:var(--gray-50);border:1.5px solid var(--gray-200);border-radius:var(--radius-md);padding:16px;margin-bottom:24px;">
                    <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:16px;font-size:13px;">
                        <div><span style="color:var(--gray-600);font-weight:500;">Document:</span> <strong id="docName">—</strong></div>
                        <div><span style="color:var(--gray-600);font-weight:500;">Total Pages:</span> <strong id="totalPages">0</strong></div>
                        <div><span style="color:var(--gray-600);font-weight:500;">Crop Width:</span> <strong id="cropWidth">0</strong> px</div>
                        <div><span style="color:var(--gray-600);font-weight:500;">Crop Height:</span> <strong id="cropHeight">0</strong> px</div>
                    </div>
                </div>

                <div style="text-align:center;display:flex;gap:16px;justify-content:center;flex-wrap:wrap;">
                    <button id="cropBtn" style="display:inline-flex;align-items:center;gap:10px;padding:16px 40px;background:linear-gradient(135deg,var(--purple-600),var(--fuchsia-500));color:white;border:none;border-radius:var(--radius-full);font-size:17px;font-weight:700;cursor:pointer;box-shadow:0 4px 16px rgba(124,58,237,.3);transition:var(--transition);font-family:var(--font-display);" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 24px rgba(124,58,237,.4)'" onmouseout="this.style.transform='';this.style.boxShadow='0 4px 16px rgba(124,58,237,.3)'">
                        <i class="fas fa-crop-alt"></i> Crop PDF
                    </button>
                    <button id="resetCropBtn" style="display:inline-flex;align-items:center;gap:8px;padding:14px 32px;background:var(--gray-100);color:var(--gray-700);border:none;border-radius:var(--radius-full);font-size:15px;font-weight:600;cursor:pointer;transition:var(--transition);" onmouseover="this.style.background='var(--gray-200)'" onmouseout="this.style.background='var(--gray-100)'">
                        <i class="fas fa-redo"></i> Reset Selection
                    </button>
                </div>
            </div>

            <!-- Processing Overlay -->
            <div class="processing-overlay" id="processingOverlay">
                <div class="processing-card">
                    <div class="spinner"></div>
                    <h3 style="font-family:var(--font-display);font-size:1.3rem;font-weight:700;color:var(--gray-900);margin-bottom:8px;">Cropping PDF...</h3>
                    <p style="font-size:14px;color:var(--gray-500);">Please wait while we process your PDF</p>
                </div>
            </div>

            <!-- Related PDF Tools -->
            <div style="background:white;border:1.5px solid var(--gray-200);border-radius:var(--radius-xl);padding:32px;margin-top:40px;">
                <h3 style="font-family:var(--font-display);font-size:1.4rem;font-weight:800;color:var(--gray-900);margin-bottom:24px;text-align:center;">
                    <i class="fas fa-tools" style="color:var(--purple-600);"></i> Related PDF Tools
                </h3>
                
                <div class="related-tools">
                    <a href="merge-pdf.html" class="related-tool">
                        <div class="related-tool-icon" style="background:#dbeafe;color:#2563eb;"><i class="fas fa-object-group"></i></div>
                        <div class="related-tool-title">Merge PDF</div>
                        <div class="related-tool-desc">Combine multiple PDFs</div>
                    </a>
                    <a href="split-pdf.html" class="related-tool">
                        <div class="related-tool-icon" style="background:#fee2e2;color:#dc2626;"><i class="fas fa-cut"></i></div>
                        <div class="related-tool-title">Split PDF</div>
                        <div class="related-tool-desc">Extract pages from PDF</div>
                    </a>
                    <a href="rotate-pdf.html" class="related-tool">
                        <div class="related-tool-icon" style="background:#ede9fe;color:#7c3aed;"><i class="fas fa-sync-alt"></i></div>
                        <div class="related-tool-title">Rotate PDF</div>
                        <div class="related-tool-desc">Change page orientation</div>
                    </a>
                    <a href="compress-pdf.html" class="related-tool">
                        <div class="related-tool-icon" style="background:#dcfce7;color:#16a34a;"><i class="fas fa-compress-alt"></i></div>
                        <div class="related-tool-title">Compress PDF</div>
                        <div class="related-tool-desc">Reduce PDF file size</div>
                    </a>
                    <a href="delete-pdf-pages.html" class="related-tool">
                        <div class="related-tool-icon" style="background:#fed7aa;color:#ea580c;"><i class="fas fa-trash-alt"></i></div>
                        <div class="related-tool-title">Delete Pages</div>
                        <div class="related-tool-desc">Remove unwanted pages</div>
                    </a>
                    <a href="duplicate-pdf-pages.html" class="related-tool">
                        <div class="related-tool-icon" style="background:#fce7f3;color:#ec4899;"><i class="fas fa-copy"></i></div>
                        <div class="related-tool-title">Duplicate Pages</div>
                        <div class="related-tool-desc">Copy and repeat pages</div>
                    </a>
                </div>
            </div>

        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <div class="site-logo"><div class="logo-icon"><i class="fas fa-bolt"></i></div><div class="logo-text"><span class="logo-name">Free Tools Hub</span></div></div>
                    <p>Your complete hub for 100+ free tools, expert blogs, educational materials & curated resources.</p>
                    <div class="footer-social" style="margin-top:20px;">
                        <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
                        <a href="https://github.com/freetoolsapp" class="social-icon" target="_blank" rel="noopener"><i class="fab fa-github"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-col"><h4>Quick Links</h4><ul>
                    <li><a href="../../index.html"><i class="fas fa-home"></i>Home</a></li>
                    <li><a href="../../tools.html"><i class="fas fa-tools"></i>All Tools</a></li>
                    <li><a href="../../blog.html"><i class="fas fa-pen-nib"></i>Blog</a></li>
                    <li><a href="../../education.html"><i class="fas fa-graduation-cap"></i>Education</a></li>
                    <li><a href="../../contact.html"><i class="fas fa-envelope"></i>Contact</a></li>
                </ul></div>
                <div class="footer-col"><h4>PDF Tools</h4><ul>
                    <li><a href="crop-pdf-pages.html"><i class="fas fa-crop-alt"></i>Crop PDF</a></li>
                    <li><a href="merge-pdf.html"><i class="fas fa-object-group"></i>Merge PDF</a></li>
                    <li><a href="split-pdf.html"><i class="fas fa-cut"></i>Split PDF</a></li>
                    <li><a href="compress-pdf.html"><i class="fas fa-compress-alt"></i>Compress PDF</a></li>
                </ul></div>
                <div class="footer-col"><h4>Legal</h4><ul>
                    <li><a href="../../privacy.html"><i class="fas fa-shield-alt"></i>Privacy Policy</a></li>
                    <li><a href="../../terms.html"><i class="fas fa-file-contract"></i>Terms of Service</a></li>
                    <li><a href="../../disclaimer.html"><i class="fas fa-exclamation-circle"></i>Disclaimer</a></li>
                </ul></div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 <a href="../../index.html">Free Tools Hub</a>. All rights reserved. Made with <span class="heart">♥</span> for creators.</p>
                <div class="footer-legal"><a href="../../privacy.html">Privacy</a><a href="../../terms.html">Terms</a><a href="../../disclaimer.html">Disclaimer</a></div>
            </div>
        </div>
    </footer>

    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        const header=document.getElementById('siteHeader');
        window.addEventListener('scroll',()=>header.classList.toggle('scrolled',window.scrollY>20),{passive:true});
        const btn=document.getElementById('mobileMenuBtn'),menu=document.getElementById('mobileMenu');
        btn.addEventListener('click',()=>{const o=menu.classList.toggle('open');btn.setAttribute('aria-expanded',o);btn.innerHTML=o?'<i class="fas fa-times"></i>':'<i class="fas fa-bars"></i>';});
        menu.querySelectorAll('a').forEach(l=>l.addEventListener('click',()=>{menu.classList.remove('open');btn.setAttribute('aria-expanded','false');btn.innerHTML='<i class="fas fa-bars"></i>';}));

        let pdfDoc = null, pdfBytes = null, currentPage = null;
        let cropData = {x:0, y:0, width:0, height:0};
        let isDragging = false, isResizing = false, dragStart = {x:0,y:0}, resizeHandle = null;

        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('fileInput');
        const canvas = document.getElementById('pdfCanvas');
        const ctx = canvas.getContext('2d');
        const cropBox = document.getElementById('cropBox');

        uploadZone.addEventListener('dragover', e => {e.preventDefault(); uploadZone.classList.add('drag-over');});
        uploadZone.addEventListener('dragleave', () => uploadZone.classList.remove('drag-over'));
        uploadZone.addEventListener('drop', e => {
            e.preventDefault();
            uploadZone.classList.remove('drag-over');
            const f = e.dataTransfer.files[0];
            if (f && f.name.endsWith('.pdf')) handleFile(f);
            else alert('⚠️ Please drop a PDF file');
        });

        fileInput.addEventListener('change', e => {
            if (e.target.files[0]) handleFile(e.target.files[0]);
        });

        async function handleFile(file) {
            if (file.size > 50 * 1024 * 1024) {
                alert('⚠️ File too large. Maximum 50MB');
                return;
            }

            try {
                pdfBytes = await file.arrayBuffer();
                pdfDoc = await PDFLib.PDFDocument.load(pdfBytes);
                
                document.getElementById('docName').textContent = file.name;
                document.getElementById('totalPages').textContent = pdfDoc.getPageCount();

                await renderFirstPage();
                initCropBox();

                document.getElementById('uploadCard').style.display = 'none';
                document.getElementById('cropCard').classList.add('active');
            } catch(e) {
                alert('❌ Error loading PDF: ' + e.message);
            }
        }

        async function renderFirstPage() {
            const loadingTask = pdfjsLib.getDocument({data: pdfBytes});
            const pdf = await loadingTask.promise;
            currentPage = await pdf.getPage(1);
            
            const viewport = currentPage.getViewport({scale: 1.5});
            canvas.width = viewport.width;
            canvas.height = viewport.height;

            await currentPage.render({
                canvasContext: ctx,
                viewport: viewport
            }).promise;
        }

        function initCropBox() {
            const margin = 40;
            cropData = {
                x: margin,
                y: margin,
                width: canvas.width - (margin * 2),
                height: canvas.height - (margin * 2)
            };
            updateCropBox();
            updateCropInfo();
        }

        function updateCropBox() {
            cropBox.style.left = cropData.x + 'px';
            cropBox.style.top = cropData.y + 'px';
            cropBox.style.width = cropData.width + 'px';
            cropBox.style.height = cropData.height + 'px';
        }

        function updateCropInfo() {
            document.getElementById('cropWidth').textContent = Math.round(cropData.width);
            document.getElementById('cropHeight').textContent = Math.round(cropData.height);
        }

        // Drag crop box
        cropBox.addEventListener('mousedown', e => {
            if (e.target.classList.contains('crop-handle')) return;
            isDragging = true;
            dragStart = {x: e.clientX - cropData.x, y: e.clientY - cropData.y};
            e.preventDefault();
        });

        // Resize handles
        document.querySelectorAll('.crop-handle').forEach(handle => {
            handle.addEventListener('mousedown', e => {
                isResizing = true;
                resizeHandle = handle.classList[1];
                e.stopPropagation();
                e.preventDefault();
            });
        });

        document.addEventListener('mousemove', e => {
            if (isDragging) {
                let newX = e.clientX - dragStart.x;
                let newY = e.clientY - dragStart.y;
                
                newX = Math.max(0, Math.min(newX, canvas.width - cropData.width));
                newY = Math.max(0, Math.min(newY, canvas.height - cropData.height));
                
                cropData.x = newX;
                cropData.y = newY;
                updateCropBox();
                updateCropInfo();
            } else if (isResizing) {
                const rect = canvas.getBoundingClientRect();
                const mouseX = e.clientX - rect.left;
                const mouseY = e.clientY - rect.top;

                if (resizeHandle === 'br') {
                    cropData.width = Math.max(50, Math.min(mouseX - cropData.x, canvas.width - cropData.x));
                    cropData.height = Math.max(50, Math.min(mouseY - cropData.y, canvas.height - cropData.y));
                } else if (resizeHandle === 'tr') {
                    const newY = Math.max(0, Math.min(mouseY, cropData.y + cropData.height - 50));
                    const newHeight = cropData.y + cropData.height - newY;
                    cropData.y = newY;
                    cropData.height = newHeight;
                    cropData.width = Math.max(50, Math.min(mouseX - cropData.x, canvas.width - cropData.x));
                } else if (resizeHandle === 'bl') {
                    const newX = Math.max(0, Math.min(mouseX, cropData.x + cropData.width - 50));
                    const newWidth = cropData.x + cropData.width - newX;
                    cropData.x = newX;
                    cropData.width = newWidth;
                    cropData.height = Math.max(50, Math.min(mouseY - cropData.y, canvas.height - cropData.y));
                } else if (resizeHandle === 'tl') {
                    const newX = Math.max(0, Math.min(mouseX, cropData.x + cropData.width - 50));
                    const newY = Math.max(0, Math.min(mouseY, cropData.y + cropData.height - 50));
                    cropData.width = cropData.x + cropData.width - newX;
                    cropData.height = cropData.y + cropData.height - newY;
                    cropData.x = newX;
                    cropData.y = newY;
                }
                updateCropBox();
                updateCropInfo();
            }
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            isResizing = false;
            resizeHandle = null;
        });

        document.getElementById('resetCropBtn').addEventListener('click', initCropBox);

        document.getElementById('cropBtn').addEventListener('click', async () => {
            if (!pdfDoc) return;

            document.getElementById('processingOverlay').classList.add('active');

            try {
                const scale = currentPage.getViewport({scale: 1}).width / canvas.width;
                const cropBox = {
                    x: cropData.x * scale,
                    y: (canvas.height - cropData.y - cropData.height) * scale,
                    width: cropData.width * scale,
                    height: cropData.height * scale
                };

                const pages = pdfDoc.getPages();
                pages.forEach(page => {
                    page.setCropBox(cropBox.x, cropBox.y, cropBox.width, cropBox.height);
                });

                const croppedPdfBytes = await pdfDoc.save();
                
                const blob = new Blob([croppedPdfBytes], { type: 'application/pdf' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'cropped-pdf.pdf';
                a.click();
                URL.revokeObjectURL(url);

                setTimeout(() => {
                    document.getElementById('processingOverlay').classList.remove('active');
                    alert('✅ PDF cropped successfully! Download started.');
                }, 500);

            } catch(e) {
                alert('❌ Error cropping PDF: ' + e.message);
                document.getElementById('processingOverlay').classList.remove('active');
            }
        });
    </script>
</body>
</html>
